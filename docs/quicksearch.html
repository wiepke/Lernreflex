<html>
<head>
</head>
<body style="background: transparent;">
    <script src="scripts/docstrap.lib.js"></script>
    <script src="scripts/lunr.min.js"></script>
    <script src="scripts/fulltext-search.js"></script>

    <script type="text/x-docstrap-searchdb">
    {"models_Activity.js.html":{"id":"models_Activity.js.html","title":"Source: models/Activity.js","body":" Lernreflex Namespaces styles~_styles~compstyles~user Modules styles Classes ActivityActivityViewAdminBadgeBadgeListCompetenceCompetenceCreateCompetenceListCompetenceViewCourseInputScrollViewLearningTemplateLernreflexlibListEntryCompetenceLoaderMenuModelQuestionsRouterSelectListSuperComponentUserUserListUserLogin Source: models/Activity.js 'use strict' import Model from 'Lernreflex/models/Model'; import {User} from 'Lernreflex/imports' /** * Represents an activity (Model). * @extends Model * @constructor * @param {bool} caching - If data can be fetched from cache. */ class Activity extends Model{ constructor(caching = true){ super('Activity', caching); this.urls = { activities: '' }; this.evidenceParamName = 'user'; //Is added to an activity-URL to get user specific evidence this.definition = { name: '*', url: '*', icon: '*', qtip: '*' } this.setApi(1); } /** * Save an activity object to the API * @param obj {object} An activity object that has everything defined in the definition * @return {Promise} */ save(obj){ obj.icon = '-'; obj.qtip = '-'; obj = this.checkDefinition(obj); if(obj){ return this.put('activities', obj); } } /** * Get the comments of an activity from the progress object of a competence * @param competenceProgress {object} A progress object of a competence * @param activity {object} An activity object * @return {array} Comments for the given activity */ commentsToView(competenceProgress, activity){ //console.log(competenceProgress, activity); let comments = []; if(competenceProgress &amp;&amp; Array.isArray(competenceProgress.evidences)) { for(var i in competenceProgress.evidences){ let l = competenceProgress.evidences[i]; if(l.evidenceUrl.indexOf(activity.url) &gt; -1) { comments = l.comments.sort((a, b) =&gt; a.created &gt; b.created); break; } } } return comments; } /** * Save a comment for an activity to the API * @param obj {object} A comment object * @return {Promise} */ comment(obj){ if(!obj.user){ let user = new User(); return user.isLoggedIn().then(u =&gt; { if(u &amp;&amp; u.username) { obj.user = u; return this.comment(obj); } return false; }) } if(!obj.comment || !obj.comment.trim()) return; let o = { competence: obj.competence.name, competenceLinksView: [{ evidenceTitel: obj.activity.name, evidenceUrl: this.addUsernameToUrl(obj.activity.url, obj.user.username), comments: [{ user: obj.author.username, text: obj.comment, courseContext: obj.competence.courseId }], validated: false } ], abstractAssessment: [ ] } //console.log(o); return this.put('progress/'+obj.user.username+'/competences/'+obj.competence.name, o); } /** * Check if an activity was done by a user * @param evidence {object} An evidence object of a progress object of a competence object * @param username {string} Username * @return {bool} */ isDone(evidence, username){ console.log(evidence, username); return evidence.comments &amp;&amp; evidence.comments.filter((c) =&gt; c.user != username).length &gt; 0; } /** * Store to every activity in a list of activities if they were done by a user * @param activities {array} A list of activities * @param competenceData {object} A competence object containing progress.evidence * @param username {strting} Username * @return {array} */ areDone(activities, competenceData, username){ if(!competenceData.progress.evidences) return activities; return activities.map((a) =&gt; { a.done = competenceData.progress.evidences.filter((e) =&gt; { return e.evidenceUrl.indexOf(a.url) &gt; -1 &amp;&amp; this.isDone(e, username) }).length &gt; 0; console.log(a.done); return a; }); } /** * Add the username to an evidence url to make it unique to the user. This is necessary * because the activity urls in Moodle are not unique to a user. * @param url {string} Evidence url * @param username {string} Username * @return {string} */ addUsernameToUrl(url, username){ let symbol = url.indexOf('?') &gt; -1 ? '&amp;' : '?'; return url+symbol+this.evidenceParamName+'='+username; } /** * Get the activities for a competence from the API * @param competence {string} The competence ID * @return {Promise} */ getActivities(competence){ let user = new User(); let _this = this; return user.isLoggedIn().then((u) =&gt; { return _this.get('activities/competences/'+competence).then((activities) =&gt; { console.log('Activities:', activities, competence); activities = activities.map((a) =&gt; {a.type = 'activity'; a.activityData = {...a}; return a;}); return activities; }); }); } /** * Get all the activities from a course. This is only used for the admin. * @param courseId {string} course ID * @return {Promise} */ getCourseActivities(courseId){ let user = new User(); let _this = this; return user.isLoggedIn().then((u) =&gt; { return _this.get('courses/'+courseId+'/activities', {userId:u.username, password:u.password}).then((d) =&gt; { let activities = []; let already = {}; //console.log(d); if(d &amp;&amp; d.length) { for(var i in d) { if(d[i] &amp;&amp; d[i].activityTypes &amp;&amp; d[i].activityTypes.length) { d[i].activityTypes.map((at) =&gt; { let acts = at.activities.map((a) =&gt; { a.activityType = at.name; a.type = 'activity'; if(!already[a.activityType + a.name]) { activities.push(a); activities[activities.length - 1].activityData = {...a}; already[a.activityType+a.name] = true; } }); return acts; }); } } } //console.log('Activities:', activities); return activities; }); }); } /** * Return the ID of an activity object * @param obj {object} An activity object * @return {string} ID */ generateID(obj){ return obj.url; } } module.exports = Activity; Ã— Search results Close "},"models_Model.js.html":{"id":"models_Model.js.html","title":"Source: models/Model.js","body":" Lernreflex Namespaces styles~_styles~compstyles~user Modules styles Classes ActivityActivityViewAdminBadgeBadgeListCompetenceCompetenceCreateCompetenceListCompetenceViewCourseInputScrollViewLearningTemplateLernreflexlibListEntryCompetenceLoaderMenuModelQuestionsRouterSelectListSuperComponentUserUserListUserLogin Source: models/Model.js 'use strict' import { Platform, AsyncStorage } from 'react-native'; import ip from 'Lernreflex/localip'; import lib from 'Lernreflex/lib'; //Default API-URL: fleckenroller.cs.uni-potsdam.de/app/competence-base /** * Represents a model. All models inherit from this class. It handles the communication * to the server and the caching and storing of the data locally. * The handling of local storage and global state should be implemented in the future with the REDUX Framework. * Local storage and AsyncStorage are used here as a synonym. * @constructor * @param {string} className - The name of the object class. * @param {bool} caching - If data can be fetched from cache. */ class Model { constructor(className, caching = true){ this.protocol = 'http://'; if(Platform.OS === 'ios') { this.ip = ip.ip ? ip.ip : 'localhost' } else { this.ip = ip.ip ? ip.ip : 'localhost'; } if(this.ip.indexOf('fleckenroller') &gt; -1) { this.host = this.protocol + this.ip + '/'; } else if(this.ip.indexOf('erdmaennchen') &gt; -1) { this.protocol = 'https://'; this.host = this.protocol + this.ip + '/'; } else if(this.ip.indexOf('competence-base') &gt; -1) { this.host = this.protocol + this.ip + '/'; } else { this.host = this.protocol + this.ip+':8084/'; } this.api1 = this.host+'api1/'; this.api0 = this.host+'competences/'; this.api = this.api1; this.headers = { 'Accept' : 'application/json', //'Content-Type' : 'application/json', //'Host' : this.host }; this.putHeaders = { //'Accept' : 'text/plain', 'Content-Type' : 'application/json', //Muss gesetzt sein! //'Host' : this.host }; this.className = className; //Dont use this.constructor.name because it will be something else when building this.definition = false; this.caching = caching; this.prefix = 'lernreflex_'; //Prefix for AsyncStorage this.cache_time = 3600; //In seconds } /** * Set the API version for this model. * @param num {int} 0 or 1 * @return {Promise} */ setApi(num){ if(num == 0){ this.api = this.api0; } if(num == 1){ this.api = this.api1; } } /** * Send a HTTP PUT request to the API * @param url {string} Url * @param body {object} Message body * @return {Promise} */ put(url, body){ let req = { method: 'PUT', headers: this.putHeaders, body: JSON.stringify(body)//.replace(/\\\\/,'') } return this.fetch(url, req); } /** * Send a HTTP GET request to the API * @param url {string} Url * @param params {object} Query parameters * @return {Promise} */ get(url, params){ let req = { method: 'GET', headers: this.headers } var lim = '?'; var nocache; if(params){ if(params.nocache){ nocache = true; delete params.nocache; } Object.keys(params).forEach(key =&gt; { url += lim+key +'=' + encodeURIComponent(params[key]); lim = '&amp;'; }); } //alert(url); //return Promise.resolve(); return this.fetch(url, req, nocache); } /** * Send a HTTP POST request to the API * @param url {string} Url * @param body {object} Request body * @return {Promise} */ post(url, body){ let req = { method: 'POST', headers: this.putHeaders, body: JSON.stringify(body) } return this.fetch(url, req); } /** * Send a request to the API * @param url {string} Url * @param req {object} Contains the request method, headers and body * @param nocache {bool} If nothing should be fetched from cache * @return {Promise} */ fetch(url, req, nocache){ //console.log('Fecthing:', url); url = this.api + url; const delay = this.cache_time * 1000; //Abstand zwischen 2 gleichen GET-Requests (Sonst aus Cache) var request = this.lastRequest = {url: url, req: req}; var isGET = req.method.toUpperCase() === 'GET'; var caching = this.caching &amp;&amp; isGET &amp;&amp; !nocache; var fromCache = false; var errorCallback = (d) =&gt; { console.log('errorCallback:', d); }; var callback = (response) =&gt; { var contentType = response.headers ? response.headers.get('content-type') : ''; //console.log(contentType); if(fromCache) { //console.log(fromCache); return response; } var processResponse = (d) =&gt; { console.log('Response:', d); if(typeof(d) === 'string' &amp;&amp; d.indexOf('Request failed') &gt; -1) throw 'Grizzly request failed.'; if(isGET){ // if(Array.isArray(d)) { d = d.map((e) =&gt; {e.requestSourceUrl = url; return e}); } else if(typeof(d) == 'object') { d.requestSourceUrl = url; } return this.setItem(request.url, d, true).then(() =&gt; d); } return d; }; if(contentType &amp;&amp; contentType.indexOf('application/json') !== -1) { return response.text().then((d) =&gt; { try { //console.log('parsed JSON'); return processResponse(JSON.parse(d)); } catch (e) { console.log('parsed Error' + d); return processResponse(d); } }, errorCallback); } else { return response.text().then(processResponse, errorCallback); } } //caching = false; console.log('Fetching:', url); if(caching){ return this.getItem(request.url, false, false, true) .then((d) =&gt; { //console.log(d, Date.now(), delay, Date.now() - d); fromCache = d &amp;&amp; Date.now() - d &lt; delay; return fromCache ? this.getItem(request.url, false): fetch(url, req) }) .then(callback, errorCallback); } //console.log(req); var requestObject = new Request(url, req); console.log(requestObject); return fetch(requestObject).then(callback, errorCallback); } delete(url){ /*not implemented*/ } /** * CHeck if a data object fits to its definition * @param obj {object} Data object * @return {object} */ checkDefinition(obj){ if(!this.definition) return obj; var error = []; Object.keys(this.definition).map((def) =&gt; { if(this.definition[def] == '*' &amp;&amp; !obj[def]){ error.push(def); } }); Object.keys(obj).map((def) =&gt; { if(!this.definition[def]){ delete obj[def]; } }); if(error.length &gt; 0) throw 'Properties missing in ' + this.className + ': ' + error.join(', '); return obj; } /** * Store a value locally * @param key {string} Key * @param value {mixed} Value to store for the key */ save(key, value){ this.setItem(key, value); } /** * Get the key in the local storage for given key and classname * @param key {string} Key * @param name {string} A class name (Optional) * @return {Promise} */ getName(key, name){ name = name ? name : this.className; return this.prefix + name + '_' + key; } /** * Set an item in the AsyncStorage * @param key {string} Key * @param value {mixed} Value to store for the key * @param time {bool} If the string &quot;_time&quot; should be added at the end of the key name. This is for storing storing times for certain values. * @return {Promise} */ setItem(key, value, time){ //console.log('KEYNAME:', this.getName(key)); return AsyncStorage.setItem(this.getName(key), JSON.stringify(value)).then((d) =&gt; { if(time) return AsyncStorage.setItem(this.getName(key)+'_time', Date.now().toString()); return d; }) } /** * Get an item from the AsyncStorage * @param key {string} Key * @param defaultValue {mixed} The default value to return, if nothing is stored under the given key. (Optional) * @param name {string} A class name (Optional) * @param time {bool} If the string &quot;_time&quot; is added to the end of the key (Optional) * @return {Promise} */ getItem(key, defaultValue, name, time){ time = time ? '_time' : ''; return AsyncStorage.getItem(this.getName(key, name)+time).then((value) =&gt; { return value ? JSON.parse(value) : defaultValue; }); //item ? JSON.parse(item) : defaultValue; } /** * Get all the keys in the AsynStorage starting with the prefix of this app defined in the constructor. * @return {Promise} */ getAllKeys(){ return AsyncStorage.getAllKeys().then((keys) =&gt; keys.filter((k) =&gt; k.startsWith(this.prefix))); } /** * Remove all keys and values from AsynStorage. * @return {Promise} */ clearStorage(){ return this.getAllKeys().then((keys) =&gt; keys &amp;&amp; keys.length ? AsyncStorage.multiRemove(keys) : Promise.resolve(false)); } /** * Map an object with non numerical keys to an array * @param obj {object} Object representing a list * @return {array} */ mapToNumericalKeys(obj){ return Object.keys(obj).map(key =&gt; obj[key]); } /** * Remove key and value from local AsyncStorage * @param key {string} Key to remove * @return {Promise} */ removeLocal(key){ return AsyncStorage.removeItem(this.getName(key)); } /** * Log data to the console * @param d {mixed} data to log * @return {mixed} */ log(d){ console.log(d); return d; } /** * Check if the current user is logged in. * @return {Promise} */ isLoggedIn(){ return this.getItem('auth', false, 'User'); } /** * Set the &quot;state&quot; of the model, and store that something has changed. * @param key {string} Key * @param value {mixed} Value for the key * @return {Promise} */ setState(key, value){ let _this = this; return this.getItem('changes', {}).then((changes) =&gt; { if(!changes) changes = {}; return _this.setItem(key, value).then(() =&gt; { //changes = {}; changes[key] = key; console.log('SettingChanges:', changes); return _this.setItem('changes', changes);//.then(() =&gt; this.getItem('changes')).then((value) =&gt; console.log('Saved?', value)); }); }); } /** * Check if the value of some variables in the local storage have changed * @param list {object|array} Of objects * @param searchPath {string} Path inside the object E.g.: '{}.{}.name' to get the name of an object inside an object in the list. * @param setPath {string} The path inside the object from searchPath, that should be changed. E.g. '-' In the current Object, '--' in the parent object. * @param valueCallback {function} To be executed for every element found in setPath * @return {Promise} */ mayApplyLocalChanges(list, searchPath, setPath, valueCallback){ let count = 0; return this.getItem('changes', false).then((changes) =&gt; { if(!changes || !list || !Object.keys(changes).length) return false; let promises = []; let keys = []; for(var i in changes){ keys.push(i); promises.push(this.getItem(changes[i])); } return Promise.all(promises).then((values) =&gt; { console.log(values, list); for(var i in values) { if(values[i]) { let v = valueCallback ? valueCallback(values[i]) : values[i]; list = lib.functions.setObjectValues(list, searchPath, changes[keys[i]], setPath, v); } } console.log(list); return list; }).then((list) =&gt; { return this.setItem('changes', false).then(() =&gt; list); }); }); } } module.exports = Model; Ã— Search results Close "},"components_ActivityView.js.html":{"id":"components_ActivityView.js.html","title":"Source: components/ActivityView.js","body":" Lernreflex Namespaces styles~_styles~compstyles~user Modules styles Classes ActivityActivityViewAdminBadgeBadgeListCompetenceCompetenceCreateCompetenceListCompetenceViewCourseInputScrollViewLearningTemplateLernreflexlibListEntryCompetenceLoaderMenuModelQuestionsRouterSelectListSuperComponentUserUserListUserLogin Source: components/ActivityView.js import React, { Component, } from 'react'; import ReactNative, { TouchableHighlight, ListView, ScrollView, Text, View, NavigatorIOS, Platform, TextInput, Slider, Image } from 'react-native'; import { styles, Router, Competence, Activity, ListEntryCompetence, Icon, Loader, User, InputScrollView } from 'Lernreflex/imports'; import Dimensions from 'Dimensions'; import KeyboardSpacer from 'react-native-keyboard-spacer'; import dismissKeyboard from 'dismissKeyboard' /** * Represents the view for an activity. * @extends React.Component * @constructor */ class ActivityView extends Component{ constructor(){ super(); this.activity = new Activity(); var ds = new ListView.DataSource({rowHasChanged: (r1, r2) =&gt; r1 !== r2}); this.state = { currentTab: 'comments', comment:'', comments: ds.cloneWithRows([ //{id:2, percent:15, type:'comment', user:'Klaus R.', comment:'Deine LÃ¶sung war sehr elegant. Der Gradient Descent kÃ¶nnte allerdings noch etwas schneller ablaufen, wenn die du Step Size grÃ¶ÃŸer machst.'}, //{id:1, percent:75, type:'comment', user:'Martin K.', comment:''}, /* {id:3, percent:20, type:'comment', user:'Martin K.', comment:'Comment 3'}, {id:4, percent:20, type:'comment', user:'Martin K.', comment:'Comment 4'}, {id:5, percent:20, type:'comment', user:'Martin K.', comment:'Comment 5'},*/ ]), }; this.render = this.render.bind(this); this.updateState = this.updateState.bind(this); } /** * Override setState from parent to avoid setting the state when the component is not mounted. * @param input {object} A state object */ setState(input){ if(!this.unmounting){ super.setState(input); } } /** * Store that the component will unmount, so that the component can't set its state anymore. */ componentWillUnmount(){ this.unmounting = true; } /** * Initialization */ componentDidMount(param = 'nothing'){ this.unmounting = false; this.updateState(); } /** * Executed when this component receives new props. E.g. when the user to view the activity for, changes. * @param nextProps {object} The properties which will change */ componentWillReceiveProps(nextProps){ let user = new User(); let comp = new Competence(false); let _this = this; if(!user.different(this.state.currentUser, nextProps.currentUser)) return; this.state.currentUser = nextProps.currentUser; user.getCurrentUser().then((cu) =&gt; { console.log('current', cu); user.isLoggedIn().then((u) =&gt; { if(user.different(u, cu) || !cu) { this.setState({ currentUser: cu, loading:true }); let username = cu ? cu.username : u.username; console.log('username', username); comp.getProgress(username).then((progress) =&gt; { let props = {...nextProps, competenceData:{...nextProps.competenceData, progress:progress[_this.props.competenceData.name]}, currentUser:cu, currentProgress: progress }; _this.updateState(props); }); } }); }); } /** * Update the state of this component from new props * @param nextProps {object} New props */ updateState(nextProps){ let props = !nextProps ? this.props : nextProps; let activity = new Activity(); let user = new User(); let comments = activity.commentsToView(props.competenceData.progress, props.activityData); this.setState({ height:40, commentsData: comments, currentUser: props.currentUser, comments: this.state.comments.cloneWithRows(comments), loading:false }); } /** * Render comment row from ListEntryCompetence component * @param rowData {object} An activity object * @return {ListEntryCompetence} */ renderRow(rowData){ return &lt;ListEntryCompetence type=&quot;comment&quot; rowData={rowData} /&gt; } /** * Render headline for comments * @return {ReactNative.Text} */ _renderHeadline(){ let headline = {key:'comments', name: 'Kommentare', value:''}; return &lt;Text style={{color:styles._.secondary, marginLeft:10}}&gt;{headline.name}&lt;/Text&gt; } /** * Render comments and feedback input or loading indicator * @return {array_of_React.Components|Loader} */ _renderTabContent(){ var content = this.state.comments; var input = null, spacer = null; if(this.state.loading) { return &lt;Loader /&gt; } input = &lt;View key=&quot;inputView&quot; style={{flexDirection:'row'}}&gt; &lt;View style={{flexDirection:'column', alignItems:'flex-start', flex:0.8}}&gt; &lt;TextInput key=&quot;input&quot; ref=&quot;newComment&quot; onChange={(event) =&gt; { this.setState({comment:event.nativeEvent.text, height: event.nativeEvent.contentSize.height}); this._scrollToBottom('newComment'); }} onFocus={() =&gt; this._scrollToBottom('newComment')} value={this.state.comment} numberOfLines={10} multiline={true} style={[styles.comp.input, styles.comp.commentInput, {height: Math.max(40, this.state.height)}]} maxLength={styles.max.comment} editable={!this.state.loading} enablesReturnKeyAutomatically={true} placeholder='Kommentieren ...'&gt; &lt;/TextInput&gt; &lt;/View&gt; &lt;View style={{flexDirection:'column', alignItems:'center', flex:0.2}}&gt; &lt;View style={{flexDirection:'row', alignItems:'flex-end', flex:1}}&gt; &lt;TouchableHighlight underlayColor='#FFF' onPress={() =&gt; this.addComment()} style={[styles.comp.addComment]}&gt; &lt;Text style={[styles._.highlight, {color: this.state.comment.trim() &amp;&amp; !this.state.sending ? styles._.secondary : '#EEE'}]}&gt; Senden &lt;/Text&gt; &lt;/TouchableHighlight&gt; &lt;/View&gt; &lt;/View&gt; &lt;/View&gt; var list = &lt;ListView key='list' style={styles._.list} dataSource={content} enableEmptySections={true} renderRow={(rowData) =&gt; this.renderRow(rowData)}&gt; &lt;/ListView&gt; return [list, input, spacer]; } /** * Add a comment from the input field to the comments */ addComment(){ let user = new User(); this.setState({sending:true}); user.isLoggedIn().then((u) =&gt; { var comment = { user: this.state.currentUser, author: u, competence: this.props.competenceData, activity: this.props, comment: this.state.comment } comment.comment = comment.comment.trim(); if(!comment.comment) { return; } let activity = new Activity(); activity.comment(comment).then((d) =&gt; { let created = Date.now(); this.state.commentsData.push({user:u.username, created:created, text:this.state.comment}); this.setState({comments: this.state.comments.cloneWithRows(this.state.commentsData), comment:'', sending: false }); }); }); dismissKeyboard(); } /** * Scroll to a component * @param refName {string} ref name of the component */ _scrollToBottom(refName) { var _this = this; if(Platform.OS != 'ios') return; setTimeout(() =&gt; { let scrollResponder = _this.refs.scroller.getScrollResponder(); scrollResponder.scrollResponderScrollNativeHandleToKeyboard( ReactNative.findNodeHandle(_this.refs[refName]), 10, //additionalOffset true ); }, 1); } /** * Render the username at the top, if it's different than the current user. * @return {ListEntryCompetence|null} */ renderUser(){ if(this.state.currentUser){ return &lt;ListEntryCompetence type=&quot;currentUser&quot; underlayColor={styles._.primary} onPress={() =&gt; {this.showUsers()}} rowData={this.state.currentUser} /&gt; } return null; } /** * Render the activity view * @return {ReactNative.View} */ render(){ var activity = this.props; var Comp = ScrollView; if(Platform.OS == 'ios') { Comp = InputScrollView; } let isDone; if(activity.done) isDone = &lt;View style={[styles._.col, {alignSelf:'center', flex:0.1}]}&gt; &lt;Image style={[{width: 20, height: 20}]} resizeMode='contain' source={require('Lernreflex/img/checked.png')}&gt;&lt;/Image&gt; &lt;/View&gt; return &lt;View style={{flex:1}}&gt; &lt;Comp keyboardShouldPersistTaps={true} style={[styles.wrapper, {overflow:'hidden'}]} ref=&quot;scroller&quot;&gt; {this.renderUser()} &lt;View style={styles._.row}&gt; &lt;View style={[styles._.col, {flex:activity.done ? 0.9 : 1}]}&gt; &lt;Text style={[styles.comp.title]}&gt;{activity.name}&lt;/Text&gt; &lt;/View&gt; {isDone} &lt;/View&gt; &lt;View style={styles._.row}&gt; {this._renderHeadline()} &lt;/View&gt; {this._renderTabContent()} &lt;/Comp&gt; &lt;/View&gt; } } module.exports = ActivityView; Ã— Search results Close "},"components_Admin.js.html":{"id":"components_Admin.js.html","title":"Source: components/Admin.js","body":" Lernreflex Namespaces styles~_styles~compstyles~user Modules styles Classes ActivityActivityViewAdminBadgeBadgeListCompetenceCompetenceCreateCompetenceListCompetenceViewCourseInputScrollViewLearningTemplateLernreflexlibListEntryCompetenceLoaderMenuModelQuestionsRouterSelectListSuperComponentUserUserListUserLogin Source: components/Admin.js import React, { Component, } from 'react'; import { TouchableHighlight, ListView, TextInput, ScrollView, Text, View, NavigatorIOS, Platform } from 'react-native'; import {styles, Router, User, lib, Activity, Competence, Course, Loader, SelectList} from 'Lernreflex/imports'; /** * Represents the view for an admin. This is a fallback view to create competences * and to link moodle activities and questions to them. * Please use moodle to create and link competences and activities. * @extends React.Component * @constructor */ class Admin extends Component{ constructor(){ super(); this.state = { loading:false, printableName:'', competences:'', competenceForQuestions:'', competenceForActivity: '', activityId: '', activityName: '', courseName: '', courseId: '', }; this.render = this.render.bind(this); } rowPressed(rowData) { } renderRow(rowData){ return &lt;TouchableHighlight underlayColor={styles.list.liHeadHover} onPress={() =&gt; this.rowPressed(rowData)} style={styles.list.liHead}&gt; &lt;View&gt; &lt;View style={styles.list.rowContainer}&gt; &lt;View style={styles.list.textContainer}&gt; &lt;Text style={styles.list.headText}&gt; {rowData.title} &lt;/Text&gt; &lt;/View&gt; &lt;/View&gt; &lt;View style={styles.list.separator} /&gt; &lt;/View&gt; &lt;/TouchableHighlight&gt; } _renderSaveCourseButton(){ if(!this.state.loading) { return &lt;TouchableHighlight underlayColor={styles._.hoverBtn} style={styles._.button} onPress={() =&gt; this.createCourse()}&gt; &lt;Text style={[styles._.buttonText, styles._.big]}&gt;Speichern&lt;/Text&gt; &lt;/TouchableHighlight&gt; } else { return &lt;Loader color={styles._.primary} /&gt; } } _renderSaveQuestionButton(){ if(!this.state.loading) { return &lt;TouchableHighlight underlayColor={styles._.hoverBtn} style={styles._.button} onPress={() =&gt; this.saveQuestions()}&gt; &lt;Text style={[styles._.buttonText, styles._.big]}&gt;Kompetenzfragen speichern&lt;/Text&gt; &lt;/TouchableHighlight&gt;} else { return &lt;Loader color={styles._.primary} /&gt; } } _renderSaveActivityButton(){ if(!this.state.loading) { return &lt;TouchableHighlight underlayColor={styles._.hoverBtn} style={styles._.button} onPress={() =&gt; this.saveActivity()}&gt; &lt;Text style={[styles._.buttonText, styles._.big]}&gt;AktivitÃ¤t Kompetenz zuordnen&lt;/Text&gt; &lt;/TouchableHighlight&gt;} else { return &lt;Loader color={styles._.primary} /&gt; } } createCourse(){ let competences = this.state.competences.split(';'); let course_obj = { courseId: this.state.courseId, printableName: this.state.courseName, competences: competences }; let course = new Course(); this.setState({loading:true}); let _this = this; course.save(course_obj).then((d) =&gt; { _this.setState({loading:false}); }); } saveQuestions(){ let u = new User(); let questions = lib.constants.generalCompetenceQuestions; this.setState({loading:true}); for(var i in questions){ let q = { question: questions[i].text, competenceId: this.state.competenceForQuestions }; u.post('competences/questions', q).then((d) =&gt; { console.log(d); this.setState({loading:false}); }); } } saveActivity(){ let user = new User(); let activity = new Activity(); let a = {url:this.state.activityId, name:this.state.activityName, icon:'-', qtip:'-'}; this.setState({loading:true}); activity.save(a).then(() =&gt; { user.post('activities/links/competences/'+this.state.competenceForActivity, a).then((d) =&gt; { this.setState({loading:false}) }) }); } selectPressed(name, name2){ let elements = []; let user = new User(); this.setState({loadingSelect: true}); let cb = (elements) =&gt; { this.setState({loadingSelect: false}); Router.route({ id:'select', component: SelectList, title: name+' auswÃ¤hlen', passProps:{ elements: elements, selected: ((el) =&gt; { let e = {}; e[name] = el.id; if(name2) e[name2] = el.value; this.setState(e); }) } }, this.props.navigator); } if(name == 'activityId'){ let course = new Course(false); let activity = new Activity(false); user.isLoggedIn().then((u) =&gt; { course.getCourses().then((courses) =&gt; { console.log(courses); if(courses &amp;&amp; courses.length) { let promises = []; for(var i in courses) { promises.push(activity.getCourseActivities(courses[i].courseid)); } Promise.all(promises).then((together) =&gt; { console.log(together); together = together.map((el) =&gt; { return el.map((e) =&gt; { return {id:e.url, value:e.name}})}).filter((e) =&gt; e.length &lt; 10); elements = []; together.map((t) =&gt; { elements = [...elements, ...t]; }) cb(elements); }) } else cb([]); }) }); } else if(name == 'competenceForActivity' || name == 'competenceForQuestions'){ let competence = new Competence(false); user.isLoggedIn().then((u) =&gt; { competence.getOverview().then((competences) =&gt; { console.log(competences); elements = []; let fun = (list) =&gt; { Object.keys(list).map((el) =&gt; { console.log(list, elements, el); list[el] = list[el].competences.map((e) =&gt; { return {id:e, value:e}}) list[el].map((t) =&gt; { console.log(t); elements.push(t); }) }); } if(competences &amp;&amp; competences.courses) { fun(competences.courses); } if(competences &amp;&amp; competences.learningTemplates) { fun(competences.learningTemplates); } console.log(elements); cb(elements); }) }); } else if(name == 'courseId'){ let competence = new Competence(false); user.isLoggedIn().then((u) =&gt; { competence.getOverview().then((competences) =&gt; { if(competences &amp;&amp; competences.courses) { competences.courses.map((c) =&gt; { elements.push({id: c.courseId, value: c.printableName}); }) } cb(elements); }) }); } } render(){ let courseId = ''; let printableName = ''; let competences = ''; return &lt;ScrollView style={styles.wrapper}&gt; &lt;Text&gt;Kompetenzen zu Kurs hinzufÃ¼gen&lt;/Text&gt; &lt;View style={styles._.row}&gt; &lt;TouchableHighlight underlayColor={styles._.secondary} style={[styles._.col, {flex:0.8, marginRight:10}]} onPress={() =&gt; this.selectPressed('courseId', 'courseName')}&gt; &lt;View style={{borderBottomWidth:1, padding:5, borderColor:'#000', flex:0}}&gt; &lt;Text style={{fontSize:18}}&gt; {this.state.loadingSelect ? 'LÃ¤dt...' : (this.state.courseId ? this.state.courseName : 'Kurs fÃ¼r Kompetenzen wÃ¤hlen &gt;')} &lt;/Text&gt; &lt;/View&gt; &lt;/TouchableHighlight&gt; &lt;/View&gt; &lt;TextInput ref=&quot;competences&quot; onChangeText={(competences) =&gt; this.setState({competences})} value={this.state.competences} multiline={true} editable={!this.state.loading} style={styles.comp.input} returnKeyType=&quot;next&quot; blurOnSubmit={false} placeholder=&quot;Kompetenzen (Mit ; getrennt eintragen)&quot;&gt; &lt;/TextInput&gt; {this._renderSaveCourseButton()} {/*&lt;TextInput ref=&quot;competenceForQuestion&quot; onChangeText={(competenceForQuestion) =&gt; this.setState({competenceForQuestion})} value={this.state.competenceForQuestion} multiline={true} editable={!this.state.loading} style={styles.comp.input} returnKeyType=&quot;next&quot; blurOnSubmit={false} placeholder=&quot;Kompetenz fÃ¼r Fragen&quot;&gt; &lt;/TextInput&gt;*/} &lt;View style={styles._.row}&gt; &lt;TouchableHighlight underlayColor={styles._.secondary} style={[styles._.col, {flex:0.8, marginRight:10}]} onPress={() =&gt; this.selectPressed('competenceForQuestions')}&gt; &lt;View style={{borderBottomWidth:1, padding:5, borderColor:'#000', flex:0}}&gt; &lt;Text style={{fontSize:18}}&gt; {this.state.loadingSelect ? 'LÃ¤dt...' : (this.state.competenceForQuestions ? this.state.competenceForQuestions : 'Kompetenz auswÃ¤hlen &gt;')} &lt;/Text&gt; &lt;/View&gt; &lt;/TouchableHighlight&gt; &lt;/View&gt; {this._renderSaveQuestionButton()} &lt;View style={styles._.row}&gt; &lt;TouchableHighlight underlayColor={styles._.secondary} style={[styles._.col, {flex:0.8, marginRight:10}]} onPress={() =&gt; this.selectPressed('activityId', 'activityName')}&gt; &lt;View style={{borderBottomWidth:1, padding:5, borderColor:'#000', flex:0}}&gt; &lt;Text style={{fontSize:18}}&gt; {this.state.loadingSelect ? 'LÃ¤dt...' : (this.state.activityId ? this.state.activityName : 'AktivitÃ¤ts-URL auswÃ¤hlen &gt;')} &lt;/Text&gt; &lt;/View&gt; &lt;/TouchableHighlight&gt; &lt;/View&gt; &lt;View style={styles._.row}&gt; &lt;TouchableHighlight underlayColor={styles._.secondary} style={[styles._.col, {flex:0.8, marginRight:10}]} onPress={() =&gt; this.selectPressed('competenceForActivity')}&gt; &lt;View style={{borderBottomWidth:1, padding:5, borderColor:'#000', flex:0}}&gt; &lt;Text style={{fontSize:18}}&gt; {this.state.loadingSelect ? 'LÃ¤dt...' : (this.state.competenceForActivity ? this.state.competenceForActivity : 'Kompetenz fÃ¼r AktivitÃ¤t wÃ¤hlen &gt;')} &lt;/Text&gt; &lt;/View&gt; &lt;/TouchableHighlight&gt; &lt;/View&gt; {this._renderSaveActivityButton()} &lt;/ScrollView&gt; } } /* &lt;TextInput ref=&quot;courseId&quot; onChangeText={(courseId) =&gt; this.setState({courseId})} value={this.state.courseId} multiline={false} editable={!this.state.loading} style={styles.comp.input} returnKeyType=&quot;next&quot; blurOnSubmit={false} placeholder=&quot;courseId&quot;&gt; &lt;/TextInput&gt; &lt;TextInput ref=&quot;printableName&quot; onChangeText={(printableName) =&gt; this.setState({printableName})} value={this.state.printableName} multiline={false} editable={!this.state.loading} style={styles.comp.input} returnKeyType=&quot;next&quot; blurOnSubmit={false} placeholder=&quot;printableName&quot;&gt; &lt;/TextInput&gt;*/ /*&lt;TextInput ref=&quot;activityId&quot; onChangeText={(activityId) =&gt; this.setState({activityId})} value={this.state.activityId} multiline={true} editable={!this.state.loading} style={styles.comp.input} returnKeyType=&quot;next&quot; blurOnSubmit={false} placeholder=&quot;AktivitÃ¤ts-URL&quot;&gt; &lt;/TextInput&gt;*/ module.exports = Admin; Ã— Search results Close "},"models_Badge.js.html":{"id":"models_Badge.js.html","title":"Source: models/Badge.js","body":" Lernreflex Namespaces styles~_styles~compstyles~user Modules styles Classes ActivityActivityViewAdminBadgeBadgeListCompetenceCompetenceCreateCompetenceListCompetenceViewCourseInputScrollViewLearningTemplateLernreflexlibListEntryCompetenceLoaderMenuModelQuestionsRouterSelectListSuperComponentUserUserListUserLogin Source: models/Badge.js 'use strict' import Model from 'Lernreflex/models/Model'; import {User} from 'Lernreflex/imports'; /** * Represents an activity. * @extends Model * @constructor * @param {bool} caching - If data can be fetched from cache. */ class Badge extends Model{ constructor(caching = true){ super('Badge', caching); } /** * Get the ID of a badge object * @param obj {object} a badge object * @return {string} */ generateID(obj){ return obj.title; } /** * Get dummy badges * @return {Promise} */ getBadges(){ return this.getItem('badges', {}).then(this.mapToNumericalKeys).then(this.dummyData); } /** * Get user badges from the API * @return {Promise} */ getUserBadges(){ let user = new User(); return user.isLoggedIn().then((u) =&gt; this.get('progress/badges', {userId:u.username, password:u.password})).then(this.hackToFilterBadgesWhichCouldntBeenDeleted); } /** * Hack to filter out badges that couldn't been deleted in Moodle, but shouldn't show in the app. * @param badges {array} Badges from the API */ hackToFilterBadgesWhichCouldntBeenDeleted(badges){ if(badges &amp;&amp; badges.length) { badges = badges.filter((b) =&gt; b.name != 'Hallo-Welt Coder'); } return badges; } /** * Get dummy data to show as badges */ dummyData(){ let objs = []; let num = 5; for(var i = 0; i &lt; num; i++){ objs.push({ id: i, title: 'Badge ' + i, done: true }); } let q = Promise.resolve(objs); return q; } } module.exports = Badge; Ã— Search results Close "},"components_BadgeList.js.html":{"id":"components_BadgeList.js.html","title":"Source: components/BadgeList.js","body":" Lernreflex Namespaces styles~_styles~compstyles~user Modules styles Classes ActivityActivityViewAdminBadgeBadgeListCompetenceCompetenceCreateCompetenceListCompetenceViewCourseInputScrollViewLearningTemplateLernreflexlibListEntryCompetenceLoaderMenuModelQuestionsRouterSelectListSuperComponentUserUserListUserLogin Source: components/BadgeList.js 'use strict' import React, {Component} from 'react'; import { TouchableHighlight, ListView, Platform, Text, View, NavigatorIOS, RefreshControl, ToolbarAndroid, Image } from 'react-native'; //import BadgeView from 'Lernreflex/components/BadgeView'; import {styles, Badge, ListEntryCompetence} from 'Lernreflex/imports'; import Router from 'Lernreflex/Router'; /** * Represents the view for the badges. * @extends React.Component * @constructor */ class BadgeList extends Component{ constructor(){ super(); this.unmounting = true; var ds = new ListView.DataSource({ rowHasChanged: (r1, r2) =&gt; r1 !== r2, sectionHeaderHasChanged : (s1, s2) =&gt; s1 !== s2 }); this.state = { refreshing: false, dataSource: ds, loaded: false }; this.renderRow = this.renderRow.bind(this); } componentWillUnmount(){ this.unmounting = true; } componentDidMount(){ this.unmounting = false; this.setState({dataSource:this.state.dataSource.cloneWithRows(['loader'])}); this.loadData(); } /** * Load Badges from API * @param caching {bool} If badges can be fetched from cache */ loadData(caching = false){ var _this = this; var badge = new Badge(caching); this.setState({refreshing:true}) var type = this.props.type; badge.getUserBadges().then((badges) =&gt; { if(badges &amp;&amp; badges.length) { _this.setState({ dataSource: _this.state.dataSource.cloneWithRows(badges), loaded: true, refreshing: false }); } else { this.emptyList(); } }); } /** * Rendered if there are no badges */ emptyList(){ let text = 'Du hast noch keine Abzeichen. Du kannst diese Ansicht aktualisieren, indem du die Liste nach unten ziehst.'; console.log('EMPTY'); this.setState({ dataSource:this.state.dataSource.cloneWithRows([{id:'empty', text:text}]), loaded: true, refreshing: false }); } /** * Executed on pull to refresh to load badges */ _onRefresh() { this.loadData(false); } rowPressed(rowData) { //console.warn(styles.route); /*if(rowData.type == 'badge'){ Router.route({ title: 'Badge', id: 'goal', component: BadgeView, passProps: {data: rowData} }, this.props.navigator); } */ } /** * Render list section header. Still not implemented. (see React Native ListView docs) * @param sectionData {object} * @param sectionID {string} */ renderSectionHeader(sectionData, sectionID){ return null; } /** * Render a badge in a row * @param rowData {object} a badge object * @return {ListEntryCompetence} */ renderRow(rowData){ if(rowData != 'loader') rowData.done = true; return &lt;ListEntryCompetence type='badge' underlayColor={styles.list.liHover} onPress={() =&gt; this.rowPressed(rowData)} rowData={rowData} style={styles.list.li} /&gt; } /** * Render the list with the badges */ render(){ return &lt;View style={styles.wrapper}&gt; &lt;ListView refreshControl={ &lt;RefreshControl refreshing={this.state.refreshing} onRefresh={this._onRefresh.bind(this)} /&gt; } style={styles._.list} dataSource={this.state.dataSource} renderSectionHeader={this.renderSectionHeader} renderRow={this.renderRow}&gt; &lt;/ListView&gt; &lt;/View&gt; } } module.exports = BadgeList; Ã— Search results Close "},"models_Competence.js.html":{"id":"models_Competence.js.html","title":"Source: models/Competence.js","body":" Lernreflex Namespaces styles~_styles~compstyles~user Modules styles Classes ActivityActivityViewAdminBadgeBadgeListCompetenceCompetenceCreateCompetenceListCompetenceViewCourseInputScrollViewLearningTemplateLernreflexlibListEntryCompetenceLoaderMenuModelQuestionsRouterSelectListSuperComponentUserUserListUserLogin Source: models/Competence.js 'use strict' import Model from 'Lernreflex/models/Model'; import {LearningTemplate, Course, Activity, User, lib} from 'Lernreflex/imports' /** * Represents a competence/goal. (Model) The difference between a competence and a goal is, that * a goal is a competence, that was not reached yet. * @extends Model * @constructor * @param {bool} caching - If data can be fetched from cache. */ class Competence extends Model{ constructor(caching = true){ super('Competence', caching); this.urls = { competences: '' } /** Scales for the self assessment */ this.scales = { progress: {unit:'%', values:['0', '10', '20','30','40','50','60','70','80','90','100']}, time: {unit:'Min', values:['0 - 10', '10 - 20', '20 - 30', '30 - 60', '60 - 120', '120 - 180', '&gt; 180']}, interest: {unit:'', values:['Sehr klein', 'Klein', 'Mittel', 'GroÃŸ', 'Sehr groÃŸ']} }; /** Stub for a competence */ this.definition = { operator: '*', forCompetence: '*', catchwords:['*'], subCompetences: ['*'], superCompetences: ['*'], learningProjectName: '*' }; this.setApi(1); } /** * Save a competence object to the API * @param obj {object} A competence object that has everything defined in the definition */ save(obj){ var key = obj.isGoal ? 'goals' : 'competences'; obj = this.checkDefinition(obj); if(obj){ let id = this.generateID(obj); console.log(this.lastRequest); this.getItem(key, {}) .then((comps) =&gt; {comps[id] = obj; return comps;}) .then((comps) =&gt; super.save(key, comps)); return this.put('competences/'+(id), obj); } } /** * Return the ID of a competence object * @param obj {object} competence * @return {string} */ generateID(obj){ return obj.forCompetence; } /** * Get the overview of competences and goals for a user from the API * @return {Promise} */ getOverview(type = 'competences'){ //faster to get learnigntemplates and courses and competences let user = new User(); return user.isLoggedIn().then((u) =&gt; { return this.get('users/'+u.username+'/overview'); }); } /** * Get the goals for a user from the API * @return {Promise} */ getGoals(){ return this.getCompetences('goals'); //return this.getItem('goals', {}).then(this.mapToNumericalKeys); } /** * Get the competences for a user from the API * @return {Promise} */ getCompetences(type = 'competences'){ let learningTemplate = new LearningTemplate(); let user = new User(); return user.isLoggedIn().then((user) =&gt; { return this.getOverview(type).then((ov) =&gt; { console.log(ov); if(!ov) return {}; let together = {}; if(ov.courses &amp;&amp; ov.courses.length &gt; 0){ //From courses ov.courses.map((course) =&gt; { if(course.courseId != learningTemplate.courseContext) { together[course.printableName] = course.competences.map((comp) =&gt; { return {name:comp, text:this.toIch(comp), inCourse:true, courseId: course.courseId} }); } }); } if(ov.learningTemplates &amp;&amp; ov.learningTemplates.length &gt; 0) { ov.learningTemplates.map((l) =&gt; { if(!l.competences) return null; together[l.selectedTemplate] = l.competences.map((comp) =&gt; { return {name:comp, text:this.toIch(comp)} }); }); } return this.getProgress().then((progress) =&gt; { together = this.joinProgressAndCompetences(together, progress); return this.checkHasNewGoalReached(together, user, type).then(() =&gt; this.filterType(together, type, user) ); }); }); }); } /** * Count competences * @param competences {object} Object containing lists of competences * @return {int} summed number of competences from all lists */ countCompetences(competences){ let count = 0; for(var category in competences) { count += competences[category].length; } return count; } /** * Check if the number of goals has changed after loading from the server, * to see if the user reached a new goal. * @param allCompetences {object} Object containing lists of competences retrieved from the API * @param user {object} Object containing username * @param type {string} goals or competences (not used yet) * @return {Promise} */ checkHasNewGoalReached(allCompetences, user, type){ let itemName = 'allCompetences'; console.log(allCompetences); if(!allCompetences || !Object.keys(allCompetences).length) return this.setItem(itemName, allCompetences); return this.getItem(itemName, false).then((allOldCompetences) =&gt; { if(!allOldCompetences || !Object.keys(allOldCompetences).length) return this.setItem(itemName, allCompetences); let oldGoals = this.filterType(allOldCompetences, 'goals', user); let oldCompetences = this.filterType(allOldCompetences, 'competences', user); let newGoals = this.filterType(allCompetences, 'goals', user); let newCompetences = this.filterType(allCompetences, 'competences', user); console.log(this.countCompetences(newGoals), this.countCompetences(oldGoals), this.countCompetences(oldCompetences), this.countCompetences(newCompetences)); let newGoalReached = false; if(this.countCompetences(newGoals) &lt; this.countCompetences(oldGoals) &amp;&amp; this.countCompetences(oldCompetences) &lt; this.countCompetences(newCompetences) ) { console.log('new GOAL Reached!'); newGoalReached = true; this.newGoalsReached = this.countCompetences(newCompetences) - this.countCompetences(oldCompetences); } return this.setItem(itemName, allCompetences); }); } /** * Joins the goals and competences from the API with the progress of the user * from the API * @param together {object} Competences from the API * @param progress {object} Progress from the API * @return {object} Competences with progress attached */ joinProgressAndCompetences(together, progress){ Object.keys(together).map((key) =&gt; { let comps = together[key]; //console.log(together, progress); if(typeof(comps) != 'object') return; together[key] = together[key].map((comp) =&gt; { if(progress &amp;&amp; progress[comp.name]){ comp.progress = progress[comp.name]; } else { comp.progress = this.progressToView({competence:comp.name}); } return this.toView(comp); }); }); return together; } /** * Filters goals OR competences from a list of both * @param competences {object} list of competences from the API * @param type {string} goals OR competences * @param user {object} Object containing the username */ filterType(competences, type = 'competences', user){ //Filter if learning goal is reached or not //console.log(competences); let filtered = {}; for(var category in competences) { if(competences[category] &amp;&amp; competences[category].length) filtered[category] = competences[category].filter((c) =&gt; { let done = (!c.inCourse &amp;&amp; c.progress &amp;&amp; c.progress.PROGRESS &amp;&amp; c.progress.PROGRESS.assessmentIndex == 10) || (c.inCourse &amp;&amp; this.hasCommentFromOtherUser(c, user.username)); return type == 'competences' &amp;&amp; done || type == 'goals' &amp;&amp; !done; }); if(!filtered[category] || !filtered[category].length) delete filtered[category]; } return filtered; } /** * Check if a user has a comment to an activity of a competence from another user, * to see if the competence is done. * @param competence {object} competence with progress * @param username {string} * @return {bool} */ hasCommentFromOtherUser(competence, username){ if(competence.progress &amp;&amp; competence.progress.evidences) { for(var i in competence.progress.evidences) { let e = competence.progress.evidences[i]; if(e.comments &amp;&amp; e.comments.filter((c) =&gt; c.user != username).length &gt; 0) { return true; } } } return false; } /** * Get the progress for all the competences of a user. * @param username {string} * @return {Promise} */ getProgress(username){ let user = new User(); let callback = (d) =&gt; { if(!d || !d.userCompetenceProgressList) return false; let progress = {}; d.userCompetenceProgressList.map(this.progressToView).map((p) =&gt; { progress[p.competence] = p; }); return progress; }; //console.log('USER-Progress:', username); if(username) { return this.get('progress/'+username).then(callback); } return user.isLoggedIn().then((u) =&gt; { return this.get('progress/'+u.username).then(callback); }) } /** * Converts a progress object from the API for the use in the app * @param p {object} progress from the API * @return {object} */ progressToView(p){ let pro = { name: p.competence, competence: p.competence, } if(!p.abstractAssessment || !Object.keys(p.abstractAssessment).length) { pro = {...pro, PROGRESS:{assessmentIndex:0}, TIME:{assessmentIndex:0}} } else p.abstractAssessment.map((a) =&gt; { pro[a.typeOfSelfAssessment] = a; }) //console.log('ProgressToView', pro); pro.evidences = p.competenceLinksView; pro.answers = p.reflectiveQuestionAnswerHolder ? p.reflectiveQuestionAnswerHolder.data : []; return pro; } /** * Get the questions for a competence * @param competenceId {string} Id of the competence * @return {Promise} */ getQuestions(competenceId){ let caching = this.caching; this.caching = false; return this.get('competences/'+competenceId+'/questions').then((d) =&gt; { let questions = d ? d.map((q) =&gt; q.question) : []; console.log(questions); this.caching = caching; return questions.map((q, i) =&gt; { return {text:q, index:i}; }); }) } /** * Saves changes made to the progress (Time or progress changed) of a competence * @param p {object} Progress to save to the API * @return {Promise} */ saveProgress(p){ let progress = { userCompetenceProgressList: [{ competence: p.competence, competenceLinksView: [], abstractAssessment: [{ typeOfSelfAssessment: p.identify.toUpperCase(), assessmentIndex: p.value, learningGoal: false, minValue: p.minValue, maxValue: p.maxValue } ]} ]} progress = progress.userCompetenceProgressList[0]; let user = new User(); return user.isLoggedIn().then((u) =&gt; { //console.log('USER-PROGRESS', JSON.stringify(progress)); return this.put('progress/'+u.username+'/competences/'+progress.competence, progress) .then(() =&gt; this.progressToView(progress)); }) } /** * Changes the format of the answers from the API for use in the app * @param competenceData {object} Competence object with progress with answers * @param questions {object} List of questions from the server * @return {object} */ answersToView(competenceData, questions){ let answersQ = {}; let answers = {}; let unordered = {}; answersQ = lib.functions.setKeys(competenceData.progress.answers, 'questionId'); console.log(answersQ); console.log(questions); for(let i in answersQ) { for(var j in questions){ //console.log(i, questions[j].text, i.indexOf(questions[j].text)); if(i.indexOf(questions[j].text) &gt; -1) { let t = questions[j].text; if(!unordered[t]) unordered[t] = []; unordered[t].push(answersQ[i]); } } } for(let i in unordered){ answers[i] = unordered[i].sort((a, b) =&gt; a.datecreated &lt; b.datecreated)[0].text; } console.log(answers); return answers; } /** * Saves answers to the API * @param competenceData {object} Competence data * @param answers {array} List of answers * @return {Promise} */ saveAnswers(competenceData, answers){ //console.log(competenceData, answers); let user = new User(); let promises = []; return user.isLoggedIn().then((u) =&gt; { /*let obj = { competence: competenceData.name, reflectiveQuestionAnswerHolder:{data:answers.map((a) =&gt; {a.userId = u.username; return a})}, competenceLinksView: [], abstractAssessment: [] };*/ answers = answers.map((a) =&gt; { a.userId = u.username; a.competenceId = competenceData.name; return a }); for(var i in answers) { promises.push(this.put('competences/questions/answers', answers[i])); } return Promise.all(promises); }); } /** * Parses competences from the server and checks if competences are subcompetences * of other competences * @param d {object} Data that should be parsed * @return {object} */ parseFromTree(d){ var _this = this; if(!d || !Object.keys(d).length ){ return []; } d = d[0].children; if(!d || !Object.keys(d).length){ return []; } var subs = {}; for(var i in d) { subs = {...subs, ...this.treeSubCompetences(d[i].children, {})}; } d = d.filter((e) =&gt; { return !subs[e.name]; }); return d; } /** * Get an array of all subCompetences as keys * @param d {array} * @param subs {object} * @return {object} */ treeSubCompetences(d, subs){ var _this = this; d.map((e) =&gt; { subs[e.name] = true; if(e.children.length){ subs = _this.treeSubCompetences(e.children, subs); } }); return subs; } /** * Returns a mapping or a list of mappings from a data competence object for use in the app * @param comp {object} competence object or list of competence objects from the API * @param type {string} goals OR competences * @return {object} */ toView(comp, type){ var f = (comp, type) =&gt; { return { name: comp.name, competence:comp.name, text: this.toIch(comp.name), courseId: comp.courseId, inCourse: comp.inCourse, progress: comp.progress, percent: comp.progress &amp;&amp; comp.progress.PROGRESS ? this.scales.progress.values[comp.progress.PROGRESS.assessmentIndex] : 0, //subCompetences: comp.competence, type:'competence', isGoal:type == 'goals', competenceData: comp, } } if(Array.isArray(comp)){ return comp.map((c) =&gt; f(c, type)); } return f(comp, type); } /** * Change competence string from moodle-plugin-plural-format to Ich-Format * @param name {string} Competence string * @return {string} */ toIch(name){ let die = name.startsWith('Die S.'); if(name.startsWith('S.') || die) { let s = name.split(' ') let verb = s[die ? 2 : 1]; let wholeVerb = verb; let last = s[s.length - 1].replace(/\\./, ''); //let index = lib.constants.verbs.indexOf(wholeVerb); let prefix = lib.constants.prefixes.indexOf(last) &gt; - 1; if(prefix) { wholeVerb = last+verb; //index = lib.constants.verbs.indexOf(wholeVerb); } name = name.replace(/^(Die )?S\\./, 'Ich'); let newVerb = lib.functions.ich(wholeVerb).split(' ... '); name = name.replace(new RegExp(verb), newVerb[0]); } return name; } /** * Get the sub competences of a competence from the API * @param rootCompetence {object} The competenceId * @param courseId {string} [university] * @return {Promise} */ getSubCompetences(rootCompetence, courseId = 'university'){ var _this = this; return this.get('competences/', {rootCompetence: rootCompetence, courseId:courseId, asTree: true}).then((d) =&gt; { return _this.parseFromTree(d); }); } } module.exports = Competence; Ã— Search results Close "},"components_CompetenceCreate.js.html":{"id":"components_CompetenceCreate.js.html","title":"Source: components/CompetenceCreate.js","body":" Lernreflex Namespaces styles~_styles~compstyles~user Modules styles Classes ActivityActivityViewAdminBadgeBadgeListCompetenceCompetenceCreateCompetenceListCompetenceViewCourseInputScrollViewLearningTemplateLernreflexlibListEntryCompetenceLoaderMenuModelQuestionsRouterSelectListSuperComponentUserUserListUserLogin Source: components/CompetenceCreate.js import React, {Component} from 'react'; import ReactNative, { TouchableHighlight, TouchableOpacity, ListView, ScrollView, Text, TextInput, Platform, View, Alert, NavigatorIOS, Picker } from 'react-native'; import KeyboardSpacer from 'react-native-keyboard-spacer'; import { styles, Router, lib, Competence, LearningTemplate, SelectList, User, Loader, InputScrollView } from 'Lernreflex/imports'; /** * Represents the view to create a competence. * @extends React.Component * @constructor */ class CompetenceCreate extends Component{ constructor(){ super(); this.state = { title:'', verb:'', catchwords:[], group:'', }; } /** * Create the competence with the input data and store it to the API. */ createCompetence(){ var competence = new Competence(); var user = new User(); var learningTemplate = new LearningTemplate(); var superCompetences = this.props.superCompetence ? [this.props.superCompetence] : []; //console.log(this.state.title); var _this = this; let verb2 = ''; let verb = this.state.verb.split(' ... '); if(verb[1]) { verb2 = verb[1]; } verb = verb[0]; let r = {'TÃ¤tigkeit': verb, 'Lernziel':this.state.title, 'Tags':this.state.catchwords.length &gt; 0, 'Kategorie':this.state.group}; let empty = Object.keys(r).filter((k) =&gt; !r[k]); if(empty.length) { Alert.alert('Fehlende Infos.', 'Folgende Felder mÃ¼ssen noch ausgefÃ¼llt werden: ' + empty.join(', '), [ {text: 'Ok, mach ich.'}, ]); return; } this.setState({loading:true}); let competenceTitle = ('Ich '+verb+' '+this.state.title+' '+verb2).trim(); user.isLoggedIn().done((u) =&gt; { learningTemplate.save({ userName: u.username, groupId: learningTemplate.courseContext, selectedTemplate: this.state.group }) .then(() =&gt; competence.save({ forCompetence: competenceTitle, operator: this.state.verb, catchwords: this.state.catchwords, isGoal: this.props.type === 'goals', subCompetences: [], superCompetences: superCompetences, learningProjectName: this.state.group })) .done(() =&gt; { this.saveQuestions(competenceTitle); let competence = new Competence(); competence.setItem('reloadGoals', true).then(() =&gt; { this.props.navigator.pop(); }) /*if(this.props.afterCompetenceCreate) { this.props.afterCompetenceCreate(); }*/ }, (error) =&gt; { //Errorhandler Alert.alert('Erstellen fehlgeschlagen', 'Das Lernziel konnte nicht gespeichert werden.', [ {text: 'Ok, schade'}, ]); _this.setState({loading:false}); }); }); } /** * Save the default reflection questions to the competence * @param competenceId {string} */ saveQuestions(competenceId){ let u = new User(); let questions = lib.constants.generalCompetenceQuestions; for(var i in questions){ let q = { question: questions[i].text, competenceId: competenceId }; u.post('competences/questions', q).then((d) =&gt; { console.log(d); }); } } componentDidMount(){ console.log(this.props.afterCompetenceCreate); this.unmounting = false; } componentWillUnmount(){ this.unmounting = true; } setState(obj){ if(this.unmounting) return; super.setState(obj); } /** * Remove a tag */ removeTag(i){ this.state.catchwords.splice(i, 1); //nicht mit delete entfernen, length wird sonst nicht verÃ¤ndert this.setState({catchwords:this.state.catchwords}); } /** * Add a tag to the list from the input */ addTag(blurred){ console.log('blurred'); var tag = this.state.tag; if(!tag || !tag.trim() || this.managedTag) return; this.managedTag = true; this.state.catchwords.push(tag.trim()); setTimeout(function(){ this.managedTag = false; this.setState({tag:'', catchwords: this.state.catchwords}); //if(!blurred) this.refs.tag.focus(); }.bind(this), 0); } /** * Render the tags * @param tags {array} list of the tags * @return {array_of_ReactNative.TouchableHighlight} */ _renderTags(tags){ var rows = []; if(!tags.length) return null; for (var i in tags) { rows.push(&lt;TouchableHighlight onPress={() =&gt; {this.removeTag(i)}} key={i} style={styles.comp.tagItem}&gt; &lt;Text style={styles.comp.tagItemText}&gt;{tags[i]}&lt;/Text&gt; &lt;/TouchableHighlight&gt;); } return &lt;View&gt; &lt;Text style={styles._.ml10}&gt;Tags: &lt;/Text&gt; &lt;ScrollView horizontal={false} styles={styles.comp.tagItemsWrapper} contentContainerStyle={[styles.comp.tagItems]}&gt; {rows} &lt;/ScrollView&gt; &lt;/View&gt; } /** * Render the Create button * @return {ReactNative.View|ReactNative.TouchableHighlight} */ _renderButton(){ if(!this.state.loading) { return &lt;TouchableHighlight underlayColor={styles._.hoverBtn} style={[styles._.button, styles._.col]} onPress={() =&gt; {this.createCompetence()}}&gt; &lt;Text style={[styles._.buttonText, styles._.big]}&gt;Erstellen&lt;/Text&gt; &lt;/TouchableHighlight&gt; } else { return &lt;View style={styles._.col}&gt;&lt;Loader color={styles._.primary} /&gt;&lt;/View&gt; } } /** * Render at the the title of the super competence, if the competence is created as a sub competence * @return {ReactNative.Text|null} */ _renderSuperCompetence(){ if(!this.props.superCompetence) return null; return &lt;Text style={styles.comp.superTitle}&gt;{'Als Teil von: ' + this.props.superCompetence}&lt;/Text&gt; } /** * Get the list of verbs * @return {array} */ getVerbs(){ let verbs = lib.constants.verbs.map(lib.functions.ich); verbs.sort(); return verbs; } /** * Scroll to a component * @param refName {string} ref name of the component */ _scrollToBottom(refName) { var _this = this; if(Platform.OS != 'ios') return; setTimeout(() =&gt; { let scrollResponder = _this.refs.scroller.getScrollResponder(); scrollResponder.scrollResponderScrollNativeHandleToKeyboard( ReactNative.findNodeHandle(_this.refs[refName]), 10, //additionalOffset true ); }, 1); } /** * Executed when the select an action button is pressed */ selectPressed(){ if(this.refs.title) this.refs.title.blur(); Router.route({ id:'select', component: SelectList, title: 'TÃ¤tigkeit auswÃ¤hlen', passProps:{ placeholder: 'Ich ...', elements: this.getVerbs(), selected: ((el) =&gt; { if(this.refs.title) this.refs.title.focus(); this.setState({verb:el}) }) } }, this.props.navigator) } /** * Render the competence create view * @return {ReactNative.View} */ render(){ var type = this.props.type; let group = this.state.group; let verb2 = ''; let verb = this.state.verb.split(' ... '); if(verb[1]) { verb2 = verb[1]; } let ThisScrollView = Platform.OS == 'ios' ? InputScrollView : ScrollView; verb = verb[0]; return &lt;View style={styles.wrapper}&gt; &lt;ThisScrollView keyboardDismissMode=&quot;interactive&quot; keyboardShouldPersistTaps={true} ref=&quot;scroller&quot;&gt; {this._renderSuperCompetence()} &lt;View style={[styles._.row, {marginTop:10}]}&gt; &lt;Text style={[styles._.col, {flex:0.1, fontSize:20, paddingLeft:10}]}&gt;Ich&lt;/Text&gt; &lt;TouchableHighlight underlayColor={styles._.secondary} style={[styles._.col, {flex:0.8, marginRight:10}]} onPress={() =&gt; {this.selectPressed()}} selectedValue={this.state.verb.split(' ... ')[0]}&gt; &lt;View style={{borderBottomWidth:1, padding:5, borderColor:'#000', flex:0}}&gt; &lt;Text style={{fontSize:18}}&gt; {verb ? verb : 'TÃ¤tigkeit auswÃ¤hlen &gt;'} &lt;/Text&gt; &lt;/View&gt; &lt;/TouchableHighlight&gt; &lt;/View&gt; {(() =&gt; { if(this.state.verb) return &lt;View&gt;&lt;View style={styles._.row}&gt; &lt;TextInput ref=&quot;title&quot; autoCapitalize='none' onChangeText={(title) =&gt; this.setState({title})} value={this.state.title} multiline={true} returnKeyType='next' numberOfLines={4} style={[styles.comp.titleInput, {borderWidth:0, borderTopLeftRadius:0,borderTopRightRadius:0}]} maxLength={styles.max.competenceTitle} editable={!this.state.loading} placeholder={this.props.inputTitle}&gt; &lt;/TextInput&gt; &lt;/View&gt; {(() =&gt; { if(verb2) return &lt;View style={styles._.row}&gt; &lt;Text style={[styles._.col, {flex:1, fontSize:20, paddingLeft:10}]}&gt;{verb2}.&lt;/Text&gt; &lt;/View&gt; })()} &lt;View style={styles._.row}&gt; {this._renderTags(this.state.catchwords)} &lt;/View&gt; &lt;View style={styles._.row}&gt; &lt;TextInput ref=&quot;tag&quot; onChangeText={(tag) =&gt; this.setState({tag})} onSubmitEditing={(event) =&gt; this.addTag()} onBlur={() =&gt; this.addTag(true)} value={this.state.tag} multiline={false} editable={!this.state.loading} style={styles.comp.input} maxLength={styles.max.competenceCatchwords} returnKeyType=&quot;next&quot; blurOnSubmit={false} placeholder=&quot;Tags hinzufÃ¼gen (Mit Weiter bestÃ¤tigen)&quot;&gt; &lt;/TextInput&gt; &lt;/View&gt; &lt;View style={styles._.row}&gt; &lt;TextInput ref=&quot;group&quot; onChangeText={(group) =&gt; this.setState({group})} onSubmitEditing={(event) =&gt; {}} value={this.state.group} multiline={false} onFocus={() =&gt; this._scrollToBottom('group')} editable={!this.state.loading} style={styles.comp.input} defaultValue={group} maxLength={styles.max.competenceGroup} renderItem={({title}) =&gt; ( &lt;TouchableOpacity onPress={() =&gt; {this.setState({group: title})}}&gt; &lt;Text style={styles.itemText}&gt; {title} &lt;/Text&gt; &lt;/TouchableOpacity&gt; )} placeholder=&quot;Einer Kategorie zuordnen&quot;&gt; &lt;/TextInput&gt; &lt;/View&gt; &lt;View style={styles._.row}&gt; {this._renderButton()} &lt;/View&gt; &lt;/View&gt; })()} &lt;/ThisScrollView&gt; {/* &lt;KeyboardSpacer onToggle={(state) =&gt; console.log('TOGGLED', state)} /&gt;*/} &lt;/View&gt; } } module.exports = CompetenceCreate; Ã— Search results Close "},"components_CompetenceList.js.html":{"id":"components_CompetenceList.js.html","title":"Source: components/CompetenceList.js","body":" Lernreflex Namespaces styles~_styles~compstyles~user Modules styles Classes ActivityActivityViewAdminBadgeBadgeListCompetenceCompetenceCreateCompetenceListCompetenceViewCourseInputScrollViewLearningTemplateLernreflexlibListEntryCompetenceLoaderMenuModelQuestionsRouterSelectListSuperComponentUserUserListUserLogin Source: components/CompetenceList.js 'use strict' import React, { Component, } from 'react'; import { TouchableHighlight, ListView, Platform, Text, View, NavigatorIOS, ScrollView, ToolbarAndroid, RefreshControl } from 'react-native'; import CompetenceView from 'Lernreflex/components/CompetenceView'; import CourseView from 'Lernreflex/components/CourseView'; import ListEntryCompetence from 'Lernreflex/components/ListEntryCompetence'; import {Router, styles, Competence, Loader, CompetenceCreate, UserList, Icon} from 'Lernreflex/imports'; /** * Represents the view for a list of competences. If the type = &quot;competences&quot; is passed * as a prop, the list contains users competences. If type = &quot;goals&quot; is passed as a prop, * the list contains users goals. * @extends React.Component * @constructor */ class CompetenceList extends Component{ constructor(){ super(); this.unmounting = true; this.Competence = new Competence(); var ds = new ListView.DataSource({ rowHasChanged: (r1, r2) =&gt; r1 !== r2, sectionHeaderHasChanged : (s1, s2) =&gt; s1 !== s2, getSectionData: this.getSectionData, getRowData: this.getRowData, }); this.state = { dataSource: ds, loaded: false, refreshing: false, iconsLoaded:0 }; this.renderRow = this.renderRow.bind(this); this.renderSectionHeader = this.renderSectionHeader.bind(this); this.loadData = this.loadData.bind(this); this.afterCompetenceCreate = this.afterCompetenceCreate.bind(this); } componentWillMount() { let icons = [ [Router.icons.community] ]; Icon.getImageSource(Router.icons.community, 30) .then((source) =&gt; this.setState({ communityIcon: source, iconsLoaded: this.state.iconsLoaded+1 })); } componentDidMount(){ this.unmounting = false; this.setState({dataSource:this.state.dataSource.cloneWithRowsAndSections({'loader:loader': 'loader'}, ['loader'], [['loader']])}); this.loadData(); } /** * Reaload competence after a new competence was created */ afterCompetenceCreate(){ this.loadData(false); } /** * Executed when the component receives new props */ componentWillReceiveProps(){ let competence = new Competence(); let type = this.props.type == 'competences' ? 'reloadCompetences' : 'reloadGoals'; setTimeout(() =&gt; { competence.getItem(type, false).then((value) =&gt; { if(value) { this.loadData(false, true); competence.setItem(type, false); } }) }, 10) //console.log('CompetenceList componentWillReceiveProps'); } /** * Updates the list if the progress of competence was changed */ updateChanges(){ let comp = new Competence(); let competences = this.state.competences; let _this = this; let promises = []; let counter = 0; comp.mayApplyLocalChanges(competences, '{}.{}.name', '-', comp.toView.bind(comp)).then((comps) =&gt; { if(comps){ this.loadData(false); } else return; _this.setState({competences:comps, dataSource: _this.getDatasource(comps)}); }); } componentWillUnmount(){ this.unmounting = true; } setState(input){ if(!this.unmounting){ super.setState(input); } } /** * Converts the returned data into displayable data */ competencesToView(comps, notAsTree){ var viewCompetence = { competence:'', percent: '' } var sectionIDs = []; var rowIDs = []; var dataBlob = {}; var _this = this; Object.keys(comps).map((k) =&gt; { if(!comps[k]) return; if(!dataBlob[k]){ sectionIDs.push(k); dataBlob[k] = {title:k, index:rowIDs.length, type:comps[k][0].inCourse ? 'course' : 'learningTemplate'}; //console.log(comps[k]); rowIDs[dataBlob[k].index] = comps[k].map((c) =&gt; c.name); } comps[k].map((comp) =&gt; { dataBlob[k + ':' + comp.name] = comp; }); }); //console.log(dataBlob, sectionIDs, rowIDs); return {dataBlob, sectionIDs, rowIDs}; } /** * Get the data formatted for the list view datasource */ getDatasource(competences){ let {dataBlob, sectionIDs, rowIDs} = this.competencesToView(competences); return this.state.dataSource.cloneWithRowsAndSections(dataBlob, sectionIDs, rowIDs); } /** * Display message if there are no competences/goals */ emptyList(){ let textCompetences = 'Erledige ein paar Lernziele, indem du in einem eigenen Lernziel deinen Fortschritt mit 100% einschÃ¤tzt oder indem dir ein Mitlerner Feedback zu einer erledigten AktivitÃ¤t in einem Lernziel eines Kurses gibt.'; let text = 'Du hast noch keine '+(this.props.type == 'goals' ? 'Lernziele.' : 'erreichten Lernziele.') + '\\n'; if(this.props.type == 'competences') text += textCompetences+' '; text += 'Du kannst diese Ansicht aktualisieren, indem du sie nach unten ziehst.' if(this.props.type == 'goals') text += ' Lege mit dem + oben eins an' + '.'; this.setState({ dataSource:this.state.dataSource.cloneWithRowsAndSections({'empty:empty': {id:'empty', text:text}}, ['empty'], [['empty']]), loaded: true, refreshing: false }); } /** * Load the data from the API * @param caching {bool} If the data can be fetched from cache * @param receivingProps {bool} If action was triggered by receiving props */ loadData(caching = true, receivingProps = false){ console.log(this.props); var _this = this; var competence = new Competence(caching); //alert(this.props.type); //competence.getAllKeys().done((keys) =&gt; console.log(keys)); //competence.removeLocal('goals'); this.setState({refreshing:true}); var type = this.props.type; let getCompetences = type === 'goals' ? competence.getGoals.bind(competence) : competence.getCompetences.bind(competence); getCompetences().done((competences) =&gt; { console.log(competences); if(Object.keys(competences).length){ _this.setState({ dataSource: _this.getDatasource(competences), loaded: true, refreshing: false, competences: competences }); } else this.emptyList(); if(competence.newGoalsReached) { console.log('NEW GOAL Reached'); _this.props.updateBadge(competence.newGoalsReached, 'competences'); } if(_this.props.type == 'competences') _this.props.updateBadge(0, 'competences'); if(_this.props.type == 'competences' &amp;&amp; !caching &amp;&amp; !receivingProps) competence.setItem('reloadGoals', true); else if(_this.props.type == 'goals' &amp;&amp; !caching &amp;&amp; !receivingProps) competence.setItem('reloadCompetences', true); }); /* if(type === 'goals') { competence.getGoals().done((goals) =&gt; { console.log(goals); if(Object.keys(goals).length){ _this.setState({ dataSource: _this.getDatasource(goals), loaded: true, refreshing: false, competences: goals }); } else this.emptyList(); }); } else { competence.getCompetences().done((competences) =&gt; { console.log(competences); if(Object.keys(competences).length){ _this.setState({ dataSource: _this.getDatasource(competences), loaded: true, refreshing: false, competences: competences }); } else this.emptyList(); }); }*/ } /** * Executed when a competence/goal is pressed * @param rowData {object} Competence data */ rowPressed(rowData) { if(rowData.type == 'competence'){ rowData.updateChanges = this.updateChanges.bind(this); rowData.communityIcon = this.state.communityIcon; let route = { title: 'Lernziel', id: this.props.type == 'goals' ? 'goal' : 'competence', rightButtonIcon: this.state.communityIcon, onRightButtonPress: () =&gt; {Router.route({ id:'users', component: UserList, passProps: { communityIcon: this.state.communityIcon, previousRoute: {...route}, backTo:'competence', competenceData: rowData.competenceData } }, this.props.navigator)}, component: CompetenceView, passProps: {...rowData} }; if(!rowData.courseId) { //Nur Community Icon anzeigen, wenn Kompetenz in Kurs delete route.rightButtonIcon; delete route.onRightButtonPress; } Router.route(route, this.props.navigator); } else if(rowData.type == 'course'){ /*Router.route({ title: 'Gruppe', id: 'group', component: CourseView, passProps: rowData }, this.props.navigator);*/ } return true; } /** * Get the data for a certain section of the list view * @param dataBlob {object} * @param sectionID {string} section ID */ getSectionData(dataBlob, sectionID){ return dataBlob[sectionID]; } /** * Get the data for a certain row of the list view * @param dataBlob {object} * @param sectionID {string} section ID * @param rowID {string} row ID */ getRowData(dataBlob, sectionID, rowID){ return dataBlob[sectionID + ':' + rowID]; } /** * Render the header of a section * @param rowData {object} * @param id {string} row ID */ renderSectionHeader(rowData, id){ if(id == 'loader') return null; if(id == 'empty') return null; let cstyle = rowData.type == 'course' ? styles.list.liHead2 : styles.list.liHead; return &lt;TouchableHighlight underlayColor={styles.list.liHeadHover} onPress={() =&gt; {this.rowPressed(rowData)}} style={cstyle}&gt; &lt;View&gt; &lt;View style={styles.list.rowContainer}&gt; &lt;View style={styles.list.textContainer}&gt; &lt;Text style={styles.list.headText}&gt; {rowData.title + (rowData.type == 'course' ? ' (Kurs)' : '')} &lt;/Text&gt; &lt;Text style={styles.list.right}&gt; {/*rowData.percent+'%'*/} &lt;/Text&gt; &lt;/View&gt; &lt;/View&gt; &lt;View style={styles.list.separator} /&gt; &lt;/View&gt; &lt;/TouchableHighlight&gt; } /** * Render a competence in a list * @param rowData {object} * @return {ListEntryCompetence} */ renderRow(rowData){ console.log(rowData); return &lt;ListEntryCompetence type='competence' underlayColor={styles.list.liHover} onPress={() =&gt; {this.rowPressed(rowData)}} rowData={rowData} style={styles.list.li} /&gt; } /** * Executed on pull to refresh to reload competences */ _onRefresh() { this.loadData(false); } /** * Render the list of the competences/goals */ render(){ /*if(!this.state.loaded) { return &lt;ScrollView style={styles.wrapper}&gt; &lt;Loader /&gt; &lt;/ScrollView&gt; }*/ return &lt;View style={styles.wrapper}&gt; &lt;ListView refreshControl={ &lt;RefreshControl refreshing={this.state.refreshing} onRefresh={this._onRefresh.bind(this)} /&gt; } style={styles._.list} dataSource={this.state.dataSource} enableEmptySections={true} renderRow={this.renderRow} renderSectionHeader={this.renderSectionHeader}&gt; &lt;/ListView&gt; &lt;/View&gt; } /* testRoute(){ //alert(1); var navigator = this.props.navigator; setTimeout(() =&gt; { //navigator.push() Router.route({ title:'test', id:'goals', component:CompetenceCreate, }, navigator); }, 1000); } _renderTestButton(){ return &lt;TouchableHighlight underlayColor={styles.list.liHover} onPress={() =&gt; this.testRoute()} style={{position:'absolute', top:200}}&gt; &lt;View&gt; &lt;View style={styles.list.rowContainer}&gt; &lt;View style={styles.list.textContainer}&gt; &lt;Text&gt; TestButton &lt;/Text&gt; &lt;/View&gt; &lt;/View&gt; &lt;View style={styles.list.separator} /&gt; &lt;/View&gt; &lt;/TouchableHighlight&gt; }*/ } module.exports = CompetenceList; Ã— Search results Close "},"components_CompetenceView.js.html":{"id":"components_CompetenceView.js.html","title":"Source: components/CompetenceView.js","body":" Lernreflex Namespaces styles~_styles~compstyles~user Modules styles Classes ActivityActivityViewAdminBadgeBadgeListCompetenceCompetenceCreateCompetenceListCompetenceViewCourseInputScrollViewLearningTemplateLernreflexlibListEntryCompetenceLoaderMenuModelQuestionsRouterSelectListSuperComponentUserUserListUserLogin Source: components/CompetenceView.js import React, { Component, } from 'react'; import { TouchableHighlight, ListView, ScrollView, Text, View, NavigatorIOS, Platform, Slider } from 'react-native'; import { AnimatedCircularProgress } from 'react-native-circular-progress'; import { styles, Router, lib, Loader, Competence, CompetenceCreate, Icon, Activity, ActivityView, User, UserList, Questions, ListEntryCompetence } from 'Lernreflex/imports'; /** * Represents the view for a competence/goal. * @extends React.Component * @constructor */ class CompetenceView extends Component{ constructor(){ super(); this.Competence = new Competence(); var ds = new ListView.DataSource({rowHasChanged: (r1, r2) =&gt; r1 !== r2}); this.state = { currentAssessment:'progress', //currentTab: 'subcompetences', currentTab: 'activities', progress:{ questions: [], answers: {}, progress:0, time:0, }, subcompetences: ds.cloneWithRows([ ]), activities: ds.cloneWithRows([ ]), loaded: false, }; this.state.sliderValue = this.state.progress[this.state.currentAssessment]; this.render = this.render.bind(this); } componentWillUnmount(){ this.unmounting = true; if(this.state.assessTimer){ clearTimeout(this.state.assessTimer); this.updateProgress(); this.props.updateChanges(); } else this.props.updateChanges(); } setState(input){ if(!this.unmounting){ super.setState(input); } } /** * Executed when the component receives props * @param nextProps {object} */ componentWillReceiveProps(nextProps){ this.loadUser(nextProps); } /** * Load the competence for a certain user. Executed when receiving props. * @param nextProps {object} Props that are passed to this component */ loadUser(nextProps){ let user = new User(); let comp = new Competence(false); let _this = this; user.getCurrentUser().then((cu) =&gt; { //if(!user.different(this.state.currentUser, cu)) return; if(!user.different(this.state.currentUser, cu)) return; this.state.currentUser = nextProps.currentUser; _this.setState({ currentUser: cu, loading:true }); comp.getProgress(cu.username).then((progress) =&gt; { let props = { competenceData:{...this.props.competenceData, progress:progress[_this.props.competenceData.name]}, currentProgress: progress }; _this.updateState(props); }); }); } componentDidMount(){ let user = new User(); this.unmounting = false; let _this = this; user.setItem('currentUser', false); this.updateState(); this.loadData(); } /** * Update the state depending on the new props received * @param props {object} */ updateState(props){ props = props ? props : this.props; let fun = (questions) =&gt; { let sliderProgress = {time:0, progress:0, value:0}; let answers = {}; //questions = lib.constants.generalCompetenceQuestions; if(props.competenceData.progress &amp;&amp; Object.keys(props.competenceData.progress).length) { sliderProgress.progress = props.competenceData.progress.PROGRESS.assessmentIndex; sliderProgress.time = props.competenceData.progress.TIME.assessmentIndex; sliderProgress.value = sliderProgress.progress; answers = (new Competence()).answersToView(props.competenceData, questions); } //console.log(questions); this.setState({ loading:false, progress: { progress: sliderProgress.progress, time: sliderProgress.time, answers: answers, questions: questions, }, competenceData: props.competenceData, sliderValue: sliderProgress.value, }); } if(!this.state.questions || !this.state.questions.length) this.Competence.getQuestions(props.competence).then(fun); else fun(this.state.questions); } /** * Load competence data, activities, questions and sub competences */ loadData(){ var _this = this; let activity = new Activity(); let user = new User(); user.isLoggedIn().then((u) =&gt; { activity.getActivities(this.props.competence, this.props.courseId).then((d) =&gt; { d = activity.areDone(d, this.props.competenceData, u.username); _this.setState({ activities: d, loadedActivities: true }); }, (e) =&gt; {console.log('ACTIVITY-ERROR', e);}); }) this.Competence.getSubCompetences(this.props.competence) .then((d) =&gt; { d = _this.Competence.toView(d, _this.props.type); _this.setState({ subcompetences: d, loadedSubcompetences: true }); }); this.Competence.getQuestions(this.props.competence).then((questions) =&gt; { _this.setState({ loadedQuestions: true, questions: questions }); }); } /** * Render the self assessment section for progress and time */ _renderAssessment(){ let btns = [ {key:'progress', name: 'Fortschritt', value:this.state.progress.progress}, {key:'time', name: 'Zeit', value: this.state.progress.time}, //{key:'interest', name: 'Interesse', value: this.state.progress.interest}, ]; if(!this.state.currentUser) { return &lt;View style={[styles._.row, styles._.otherBG]}&gt; {btns.map(function(btn){ var style = [styles._.button, {backgroundColor:styles._.primary}]; var scale = this.Competence.scales[btn.key]; var color = styles._.primary; if(btn.key === this.state.currentAssessment) { style.push(styles._.buttonActive); } return &lt;View key={btn.key} style={styles._.col}&gt; {this._wrapRow(&lt;Text style={styles._.center}&gt;{scale.values[btn.value]+scale.unit}&lt;/Text&gt;)} {this._wrapRow(&lt;TouchableHighlight underlayColor={color} onPress={() =&gt; {this.setState({currentAssessment:btn.key, sliderValue: this.state.progress[btn.key]})}} style={style}&gt; &lt;Text style={styles._.buttonText}&gt;{btn.name}&lt;/Text&gt; &lt;/TouchableHighlight&gt;)} &lt;/View&gt; }.bind(this))} &lt;/View&gt; } else { return &lt;View style={[styles._.row, styles._.otherBG]}&gt; {btns.map(function(btn){ var style = [styles._.button]; var scale = this.Competence.scales[btn.key]; var color = this.state.currentUser ? styles._.secondary : styles._.primary; if(btn.key === this.state.currentAssessment &amp;&amp; !this.state.currentUser) { style.push(styles._.buttonActive); } let percent = (btn.value) / (scale.values.length - 1) * 100; console.log(percent); return &lt;View key={btn.key} style={[styles._.col, {}]}&gt; &lt;View style={{flex: 1, justifyContent: 'space-between', alignItems: 'center'}}&gt; &lt;AnimatedCircularProgress style={styles._.center} size={120} width={15} fill={percent} tintColor={styles._.primaryBrighter} backgroundColor={styles._.primary}&gt;{ () =&gt; &lt;Text style={styles.comp.circleText}&gt; { scale.values[btn.value]+scale.unit } &lt;/Text&gt;} &lt;/AnimatedCircularProgress&gt; &lt;/View&gt; {this._wrapRow(&lt;View&gt; &lt;Text style={{color:styles._.primary, alignSelf:'center', padding:3}}&gt;{btn.name}&lt;/Text&gt; &lt;/View&gt;)} &lt;/View&gt; }.bind(this))} &lt;/View&gt; } } /** * Get the name for sub goal or sub competence */ subCompName(singular){ if(singular) return this.props.isGoal ? 'Teilziel' : 'Teilkompetenz'; return this.props.isGoal ? 'Teilziele' : 'Teilkompetenzen'; } /** * Render the buttons for activities and sub subcompetences */ _renderTabs(){ var subCompName = this.subCompName(); let btns = [ //{key:'users', name: 'Mitlerner', value: ''}, ]; if(this.props.courseId) { btns.push({key:'activities', name: 'AktivitÃ¤ten', value: ''}); } //else btns.push({key:'subcompetences', name: subCompName, value:''}); let _this = this; return btns.map(function(btn){ var style = [styles._.tab]; var style2 = [styles._.buttonText]; if(btn.key === _this.state.currentTab){ style.push(styles._.tabActive); style2.push(styles._.tabActiveText); } return &lt;TouchableHighlight underlayColor={styles.list.liHover} key={btn.key} onPress={() =&gt; {_this.setState({currentTab: btn.key})}} style={style}&gt; &lt;Text style={style2}&gt;{btn.name}&lt;/Text&gt; &lt;/TouchableHighlight&gt; }); } /** * Wrap an element in row markup to have a clear layout. */ _wrapRow(content, colStyle, rowStyle){ let st = [styles._.col]; let str = [styles._.row]; if(colStyle) { st.push(colStyle); } if(rowStyle){ if(rowStyle[0]) { str = str.concat(rowStyle); } else str.push(rowStyle); } return &lt;View style={str}&gt; &lt;View style={st}&gt; {content} &lt;/View&gt; &lt;/View&gt; } /** * Render content of activity tab and subcompetences tab */ _renderTabContent(){ var content = this.state[this.state.currentTab]; var button = null; var route = { id: this.state.currentTab == 'subcompetences' ? (this.props.isGoal ? 'goal.add' : 'competence.add') : 'activity.add', component: this.state.currentTab == 'subcompetences' ? CompetenceCreate : ActivityView, passProps:{ afterCreation: (c) =&gt; this.loadData(), superCompetence: this.props.competence, type:this.props.type } } //console.log(route); if(this.state.currentTab == 'subcompetences'){ button = &lt;TouchableHighlight key='button' onPress={() =&gt; {Router.route(route, this.props.navigator)}} style={styles._.button}&gt; &lt;Text style={styles._.buttonText}&gt; &lt;Icon name={Router.icons.addRound} size={14} color='#FFF' /&gt; {' '+(this.state.currentTab == 'subcompetences' ? this.subCompName(true) : 'AktivitÃ¤t')+' hinzufÃ¼gen'} &lt;/Text&gt; &lt;/TouchableHighlight&gt; } var list = content ? Object.keys(content).map((key) =&gt; this.renderRow(content[key])) : null; let loaded = this.state.currentTab == 'activities' &amp;&amp; this.state.loadedActivities || this.state.currentTab == 'subcompetences' &amp;&amp; this.state.loadedSubcompetences; if(!loaded) { return this._wrapRow(&lt;Loader color=&quot;#000&quot; /&gt;); } return [list, button]; } /** * Render the slider for self assessment of progress and time */ _renderSlider(){ if(this.state.currentUser) return null; return this._wrapRow(&lt;Slider ref=&quot;slider&quot; maximumValue={this.Competence.scales[this.state.currentAssessment].values.length - 1} minimumValue={0} onValueChange={(value) =&gt; { this.state.progress[this.state.currentAssessment] = value; if(this.state.assessTimer) { clearTimeout(this.state.assessTimer); } let _this = this; this.state.assessTimer = setTimeout(() =&gt; { _this.updateProgress(); }, 1000); this.setState({sliderValue: value}); }} value={this.state.sliderValue} style={[styles.comp.slider]} step={1}&gt;&lt;/Slider&gt;, null, [styles._.otherBG, {paddingTop:0}]) } /** * Update the progress when changed with the slider */ updateProgress(){ let slider = this.refs.slider; let _this = this; let p = { minValue: 0, maxValue: this.Competence.scales[this.state.currentAssessment].values.length - 1, value: this.state.sliderValue, identify: this.state.currentAssessment, competence: this.props.competence } let type = _this.state.currentAssessment.toUpperCase(); if(!_this.props.competenceData.progress) { _this.props.competenceData.progress = {}; } _this.props.competenceData.progress[type].assessmentIndex = this.state.sliderValue; _this.Competence.setState(_this.props.competence, _this.props.competenceData); return this.Competence.saveProgress(p).then((progress) =&gt; { console.log('Progress saved', _this.props.competenceData); }); } /** * Navigate to the reflective questions */ showQuestions(){ //console.log(this.props.route); Router.route({ id: 'questions', passProps: { competenceData:this.state.competenceData, answers: this.state.progress.answers, currentUser: this.state.currentUser, questions: this.state.progress.questions, questionsAnswered: () =&gt; {this.Competence.setState(this.props.competence, this.state.competenceData)} }, component: Questions, previousRoute: this.props.route }, this.props.navigator); } /** * Executed when an activity or subsompetence is tapped */ rowPressed(rowData) { rowData.currentUser = this.state.currentUser; let route = {}; if(rowData.type == 'competence'){ route = { title: 'Lernziel', id: this.props.type == 'goals' ? 'goal' : 'competence', component: CompetenceView, passProps: rowData } } else if(rowData.type == 'activity'){ rowData.competenceData = this.state.competenceData; route = { title: 'AktivitÃ¤t', id: 'activity', component: ActivityView, passProps: {...rowData} } } route.rightButtonIcon = this.props.communityIcon; route.onRightButtonPress = () =&gt; {Router.route({ id:'users', component: UserList, passProps: { communityIcon: this.props.communityIcon, previousRoute: route, backTo: rowData.type, competenceData: this.props.competenceData } }, this.props.navigator)}; Router.route(route, this.props.navigator); } /** * Render an activity or subcompetence row */ renderRow(rowData){ return this._wrapRow( &lt;ListEntryCompetence type={rowData.type} underlayColor={styles.list.liHover} onPress={() =&gt; {this.rowPressed(rowData)}} rowData={rowData} style={[styles._.row, styles.list.withSeparator]} /&gt; ); } /** * Render the user at the top, if different from the current */ renderUser(){ if(this.state.currentUser){ return &lt;ListEntryCompetence type=&quot;currentUser&quot; underlayColor={styles._.primary} onPress={() =&gt; {this.showUsers()}} rowData={this.state.currentUser} /&gt; } return null; } /** * Render the competence view */ render(){ var competence = this.props; var subCompName = competence.isGoal ? 'Teilziele' : 'Teilkompetenzen'; if(this.state.loading) return &lt;ScrollView style={styles.wrapper}&gt;{this.renderUser()}&lt;Loader /&gt;&lt;/ScrollView&gt; return &lt;ScrollView style={styles.wrapper}&gt; {this.renderUser()} {this._wrapRow(&lt;Text style={styles.comp.title}&gt;{competence.text}&lt;/Text&gt;)} {this._wrapRow(&lt;Text style={[styles.comp.sectionHead]}&gt;SelbsteinschÃ¤tzung&lt;/Text&gt;, styles._.justify, styles._.otherBG)} {this._renderAssessment()} {this._renderSlider()} {this.state.loadedQuestions ? this._wrapRow( &lt;TouchableHighlight underlayColor={styles.list.liHover} onPress={() =&gt; {this.showQuestions()}} style={[styles._.row, styles.list.withSeparator]}&gt; &lt;View style={styles._.col}&gt; &lt;View style={styles.list.rowContainer}&gt; &lt;View style={styles.list.textContainer}&gt; &lt;Text style={styles.list.text}&gt; Reflexionsfragen &lt;/Text&gt; &lt;Text style={styles.list.right}&gt; {Object.keys(this.state.progress.answers).length}/{this.state.progress.questions.length} &lt;/Text&gt; &lt;/View&gt; &lt;/View&gt; &lt;/View&gt; &lt;/TouchableHighlight&gt;) : &lt;Loader&gt;&lt;/Loader&gt; } &lt;View style={styles._.row}&gt; {this._renderTabs()} &lt;/View&gt; {this._renderTabContent()} &lt;/ScrollView&gt; } } module.exports = CompetenceView; Ã— Search results Close "},"models_Course.js.html":{"id":"models_Course.js.html","title":"Source: models/Course.js","body":" Lernreflex Namespaces styles~_styles~compstyles~user Modules styles Classes ActivityActivityViewAdminBadgeBadgeListCompetenceCompetenceCreateCompetenceListCompetenceViewCourseInputScrollViewLearningTemplateLernreflexlibListEntryCompetenceLoaderMenuModelQuestionsRouterSelectListSuperComponentUserUserListUserLogin Source: models/Course.js 'use strict' import Model from 'Lernreflex/models/Model'; /** * Represents a course. This class is not used except for the admin. * The overview from API for the competences contains the courses for the user * @extends Model * @constructor * @param {bool} caching - If data can be fetched from cache. */ class Course extends Model{ constructor(caching = true){ super('Course', caching); this.definition = { courseId: '*', competences: ['*'], printableName: '*' }; this.setApi(1); } save(obj){ let key = 'courses'; let id = this.generateID(obj); obj = this.checkDefinition(obj); if(obj){ return this.put('courses/'+(id), obj); //return this.getItem(key, {}) //.then((comps) =&gt; {comps[id] = obj; return comps;}) //.then((comps) =&gt; super.save(key, comps)); } } generateID(obj){ return obj.courseId; } getCourses(params){ return this.isLoggedIn().then((d) =&gt; { let l = { password: d.password, }; return this.get('users/'+d.username+'/courses', l).then(this.log); }); } } module.exports = Course; Ã— Search results Close "},"components_InputScrollView.js.html":{"id":"components_InputScrollView.js.html","title":"Source: components/InputScrollView.js","body":" Lernreflex Namespaces styles~_styles~compstyles~user Modules styles Classes ActivityActivityViewAdminBadgeBadgeListCompetenceCompetenceCreateCompetenceListCompetenceViewCourseInputScrollViewLearningTemplateLernreflexlibListEntryCompetenceLoaderMenuModelQuestionsRouterSelectListSuperComponentUserUserListUserLogin Source: components/InputScrollView.js import React, { Component, } from 'react'; import { ScrollView, TextInput, Text, View, dismissKeyboard } from 'react-native'; /** * Used in iOS to allow scrolling and tapping only once to change the input field. * Can be used analogously to a ScrollView. * @extends React.Component * @constructor */ class InputScrollView extends React.Component { constructor(props, ctx) { super(props, ctx); this.handleCapture = this.handleCapture.bind(this); } render() { return ( &lt;ScrollView ref=&quot;inputScrollView&quot; style={this.props.style} keyboardShouldPersistTaps={true} keyboardDismissMode='on-drag'&gt; &lt;View onStartShouldSetResponderCapture={this.handleCapture}&gt; {this.props.children} &lt;/View&gt; &lt;/ScrollView&gt; ); } getScrollResponder(){ return this.refs.inputScrollView.getScrollResponder(); } handleCapture(e) { const focusField = TextInput.State.currentlyFocusedField(); const target = e.nativeEvent.target; if (focusField != null &amp;&amp; target != focusField){ const inputs = this.props.inputs; if (inputs &amp;&amp; inputs.indexOf(target) === -1) { dismissKeyboard(); } } } } InputScrollView.propTypes = { inputs : React.PropTypes.array, } module.exports = InputScrollView; Ã— Search results Close "},"models_LearningTemplate.js.html":{"id":"models_LearningTemplate.js.html","title":"Source: models/LearningTemplate.js","body":" Lernreflex Namespaces styles~_styles~compstyles~user Modules styles Classes ActivityActivityViewAdminBadgeBadgeListCompetenceCompetenceCreateCompetenceListCompetenceViewCourseInputScrollViewLearningTemplateLernreflexlibListEntryCompetenceLoaderMenuModelQuestionsRouterSelectListSuperComponentUserUserListUserLogin Source: models/LearningTemplate.js 'use strict' import Model from 'Lernreflex/models/Model'; /** * Represents a learningtempalte. (Model) * @extends Model * @constructor * @param {bool} caching - If data can be fetched from cache. */ class LearningTemplate extends Model{ constructor(caching = false){ super('LearningTemplate', caching); this.definition = { userName: '*', groupId: '*', selectedTemplate: '*' }; this.courseContext = 'randomString'; this.setApi(1); } /** * Save a learning template. * @param obj {object} Containing the properties from the definition. * @return {Promise} */ save(obj){ let key = 'learningTemplates'; let id = this.generateID(obj); obj.groupId = this.courseContext; obj = this.checkDefinition(obj); if(obj){ return this.put('learningtemplates/'+(id), obj); //return this.getItem(key, {}) //.then((comps) =&gt; {comps[id] = obj; return comps;}) //.then((comps) =&gt; super.save(key, comps)); } } /** * Return the ID of a learning template object. * @param {string} */ generateID(obj){ return obj.selectedTemplate; } /** * Load the learning templates of user. Is not used anymore. * Could be used to make suggestions for the learning template, when creating a competence. * @param params {object} */ getLearningTemplates(params){ return this.isLoggedIn().then((d) =&gt; { let l = { userId: d.username, groupId: this.courseContext, }; return this.get('learningtemplates/', l); }); //this.getItem('learningTemplates', params).then(this.mapToNumericalKeys); } } module.exports = LearningTemplate; Ã— Search results Close "},"index.android.js.html":{"id":"index.android.js.html","title":"Source: index.android.js","body":" Lernreflex Namespaces styles~_styles~compstyles~user Modules styles Classes ActivityActivityViewAdminBadgeBadgeListCompetenceCompetenceCreateCompetenceListCompetenceViewCourseInputScrollViewLearningTemplateLernreflexlibListEntryCompetenceLoaderMenuModelQuestionsRouterSelectListSuperComponentUserUserListUserLogin Source: index.android.js 'use strict'; import React, { Component, } from 'react'; import { AppRegistry, StyleSheet, Platform, ListView, TouchableHighlight, StatusBar, Text, UIManager, View, TouchableOpacity, Navigator, ScrollView, ToolbarAndroid, BackAndroid, Keyboard, Dimensions } from 'react-native'; import TabNavigator from 'react-native-tab-navigator'; import Menu from 'Lernreflex/components/Menu'; import CompetenceView from 'Lernreflex/components/CompetenceView'; import BadgeList from 'Lernreflex/components/BadgeList'; import {styles, Router, User, UserLogin, Icon, CompetenceCreate, UserList, CompetenceList} from 'Lernreflex/imports'; var _navigator; // we fill this up upon on first navigation. /** * Starting point for view for Lernreflex for Android * @extends React.Component * @constructor */ class Lernreflex extends Component { constructor(){ super(); this.position = 0; this.renderScene = this.renderScene.bind(this); this.routeMapper = { test: 4 } this.systemName = Router.systemName; UIManager.setLayoutAnimationEnabledExperimental(true); this.afterCompetenceCreate = this.afterCompetenceCreate.bind(this); this.updateBadge = this.updateBadge.bind(this); this.user = new User(); var _this = this; this.initialRoute = { title: 'Lernziele', component: CompetenceList, id: 'goals', passProps:{ type:'goals' } }; this.loginRoute = { title: this.systemName + ' Login', id:'user.login', component: UserLogin, passProps: { onLogin: () =&gt; this.onLogin() } }; this.state = { selectedTab: 'goals', keyboardIn: false }; this.checkedLoggedIn = false; this.user.isLoggedIn().done((isIn) =&gt; { this.checkedLoggedIn = true; this.loggedIn = isIn; this.setState({loggedIn: isIn}); }); this.NavigationBarRouteMapper = { LeftButton: function(route, navigator, index, navState) { if((route.id == 'goals' || route.id == 'competences' || route.id == 'badges' || route.id == 'menu') &amp;&amp; _this.state.loggedIn) { return &lt;Text style={{paddingLeft:10, color:'#FFF'}}&gt;{_this.state.loggedIn.username}&lt;/Text&gt; } //var previousRoute = navState.routeStack[index - 1]; return ( null ); }, RightButton: function(route, navigator, index, navState) { let iconSize = 25; if(route.id == 'goals') return ( &lt;TouchableHighlight underlayColor={styles._.primary} style={styles._.toolbarRight} onPress={() =&gt; {Router.route({ id:'goal.add', component:CompetenceCreate, passProps: { afterCompetenceCreate: _this.afterCompetenceCreate } }, navigator)}} &gt; &lt;Icon name=&quot;md-add&quot; size={iconSize} color='#FFF' /&gt; &lt;/TouchableHighlight&gt; ); if(route.id == 'competences') return ( &lt;TouchableHighlight underlayColor={styles._.primary} style={styles._.toolbarRight} onPress={() =&gt; {Router.route({id:'competence.add', component:CompetenceCreate}, navigator)}} &gt; &lt;Icon name=&quot;md-add&quot; size={iconSize} color='#FFF' /&gt; &lt;/TouchableHighlight&gt; ); if(route.id == 'goal' || route.id == 'competence' || route.id == 'activity') return ( &lt;TouchableHighlight underlayColor={styles._.primary} style={styles._.toolbarRight} onPress={route.onRightButtonPress}&gt; &lt;Icon name={Router.icons.community} size={iconSize} color='#FFF' /&gt; &lt;/TouchableHighlight&gt; ); }, Title: function(route, navigator, index, navState) { return ( &lt;Text style={styles._.toolbarText}&gt;{route.title}&lt;/Text&gt; ); }, }; } componentDidMount () { this.subscriptions = [ Keyboard.addListener('keyboardDidShow', this.keyboardWillShow.bind(this)), Keyboard.addListener('keyboardDidHide', this.keyboardWillHide.bind(this)) ]; } componentWillUnmount () { this.subscriptions.forEach((sub) =&gt; {sub.remove()}); } keyboardWillShow (e) { //console.log('KEYBOARD SHOW'); this.setState({ keyboardIn: true, }) } keyboardWillHide (e) { //console.log('KEYBOARD HIDE'); this.setState({ keyboardIn: false, }) } afterCompetenceCreate(){ if(this.refs.navGoal) { //console.log(this.refs.navGoal.refs); this.refs.navGoal.refs.goals.afterCompetenceCreate(); } if(this.refs.navComp) this.refs.navComp.refs.competences.afterCompetenceCreate(); } updateBadge(n, ref){ let o = {}; o[ref+'Badge'] = n; this.setState(o); } onLogin(){ this.loggedIn = true; this.setState({loggedIn: true}); Router.route(this.initialRoute, _navigator, {reset:true}); } onLogout(){ this.loggedIn = false; this.setState({loggedIn: false}); this.selectTab('goals'); Router.route(this.loginRoute, _navigator, {reset:true}); } _renderToolbar(route, actions, onSelect){ if(!this.loggedIn) return null; return &lt;Icon.ToolbarAndroid actions={actions} onActionSelected={onSelect} style={styles._.actionBar} /&gt; } renderScene(route, navigator){ _navigator = navigator; return &lt;View style={styles._.androidView}&gt; {Router.renderRoute(route, navigator)} &lt;/View&gt; } _renderNavigator(route, ref){ if(this.state.iconsLoaded &lt; 1) { //Erst wenn das Icon geladen ist anzeigen return false; } route.leftButtonIcon = this.state.hamburgerIcon; route.onLeftButtonPress = () =&gt; { }; let sceneStyle = this.state.keyboardIn ? {paddingBottom:0, marginBottom:0} : {}; return &lt;Navigator ref={ref} tintColor={styles._.navBtnColor} titleTextColor={styles._.navColor} barTintColor={styles._.navBg} sceneStyle={[styles._.navWrap, sceneStyle]} navigationBar={&lt;Navigator.NavigationBar navigationStyles={Navigator.NavigationBar.StylesIOS} style={styles._.toolbar} title=&quot;Router&quot; routeMapper={this.NavigationBarRouteMapper} /&gt;} renderScene={this.renderScene} initialRoute={route}&gt; &lt;/Navigator&gt; } selectTab(tab, navigatorRef){ if(this.state.selectedTab == tab) { this.refs[navigatorRef].popToTop(); } this.setState({ selectedTab: tab, }); } render() { if(!this.checkedLoggedIn) { return null } var initialRoute = this.initialRoute; if(!this.state.loggedIn) { return this._renderNavigator({ title: this.systemName + ' Login', component: UserLogin, passProps: { onLogin: () =&gt; { this.onLogin() } } }, 'userLogin'); } let iconSize = 27; let iconColor = styles._.tabIconColor; let tabBarStyle = {}; let sceneStyle = {}; if(this.state.keyboardIn) { tabBarStyle.height = 0; tabBarStyle.overflow = 'hidden'; sceneStyle.paddingBottom = 0; } return ( &lt;TabNavigator style={{backgroundColor:'#FFF'}} sceneStyle={sceneStyle} tabBarStyle={tabBarStyle} barTintColor=&quot;white&quot;&gt; &lt;TabNavigator.Item renderIcon={() =&gt; &lt;Icon name={Router.icons.goals} size={iconSize} color={iconColor} /&gt;} renderSelectedIcon={() =&gt; &lt;Icon name={Router.icons.goals} size={iconSize} color={styles._.secondary} /&gt;} selected={this.state.selectedTab === 'goals'} onPress={() =&gt; { this.selectTab('goals', 'navGoal'); }}&gt; {this._renderNavigator({ id:'goals', title: 'Lernziele', component: CompetenceList, passProps: { ref: 'goals', type:'goals', updateBadge: this.updateBadge } }, 'navGoal')} &lt;/TabNavigator.Item&gt; &lt;TabNavigator.Item id='badges' badgeText={this.state.badgesBadge &gt; 0 ? this.state.badgesBadge : undefined} renderIcon={() =&gt; &lt;Icon name={Router.icons.badges} size={iconSize} color={iconColor} /&gt;} renderSelectedIcon={() =&gt; &lt;Icon name={Router.icons.badges} size={iconSize} color={styles._.secondary} /&gt;} selected={this.state.selectedTab === 'badges'} onPress={() =&gt; { this.selectTab('badges', 'navBadge'); }}&gt; {this._renderNavigator({ id:'badges', title: 'Abzeichen', component: BadgeList, passProps: { updateBadge: this.updateBadge } }, 'navBadge')} &lt;/TabNavigator.Item&gt; &lt;TabNavigator.Item id='competences' badgeText={this.state.competencesBadge &gt; 0 ? this.state.competencesBadge : undefined} renderIcon={() =&gt; &lt;Icon name={Router.icons.competences} size={iconSize} color={iconColor} /&gt;} renderSelectedIcon={() =&gt; &lt;Icon name={Router.icons.competences} size={iconSize} color={styles._.secondary} /&gt;} selected={this.state.selectedTab === 'competences'} onPress={() =&gt; { this.selectTab('competences', 'navComp'); }}&gt; {this._renderNavigator({ id:'competences', title: 'Erreicht', component: CompetenceList, passProps: { ref: 'competences', type: 'competences', updateBadge: this.updateBadge } }, 'navComp')} &lt;/TabNavigator.Item&gt; &lt;TabNavigator.Item id='menu' renderIcon={() =&gt; &lt;Icon name={Router.icons.menu} size={iconSize} color={iconColor} /&gt;} renderSelectedIcon={() =&gt; &lt;Icon name={Router.icons.menu} size={iconSize} color={styles._.secondary} /&gt;} selected={this.state.selectedTab === 'menu'} onPress={() =&gt; { this.selectTab('menu', 'navMenu'); }}&gt; {this._renderNavigator({ id: 'menu', title: 'MenÃ¼', component: Menu, passProps: { onLogout: () =&gt; { this.onLogout() } } }, 'navMenu')} &lt;/TabNavigator.Item&gt; &lt;/TabNavigator&gt; ); } } /** * Eventlistener for Android back button. Will pop the current navigator, if possible. */ BackAndroid.addEventListener('hardwareBackPress', () =&gt; { if (_navigator.getCurrentRoutes().length === 1 ) { return false; } _navigator.pop(); return true; }); AppRegistry.registerComponent('Lernreflex', () =&gt; Lernreflex); Ã— Search results Close "},"index.ios.js.html":{"id":"index.ios.js.html","title":"Source: index.ios.js","body":" Lernreflex Namespaces styles~_styles~compstyles~user Modules styles Classes ActivityActivityViewAdminBadgeBadgeListCompetenceCompetenceCreateCompetenceListCompetenceViewCourseInputScrollViewLearningTemplateLernreflexlibListEntryCompetenceLoaderMenuModelQuestionsRouterSelectListSuperComponentUserUserListUserLogin Source: index.ios.js 'use strict'; import React, { Component } from 'react'; import { AppRegistry, StyleSheet, Platform, ListView, TouchableHighlight, StatusBar, Text, View, NavigatorIOS, TabBarIOS, Navigator, Image } from 'react-native'; import BadgeList from 'Lernreflex/components/BadgeList'; import Menu from 'Lernreflex/components/Menu'; import UserLogin from 'Lernreflex/components/UserLogin'; import {styles, Router, CompetenceList, CompetenceCreate, User, Test, Icon} from 'Lernreflex/imports'; import UITest from 'Lernreflex/tests/UITest' /** * Starting point for view for Lernreflex for iOS * @extends React.Component * @constructor */ class Lernreflex extends Component { constructor(){ super(); this.state = { selectedTab: 'goals', notifCount: 0, presses: 0, iconsLoaded: 0, loggedIn: false, checkedLoggedIn: false }; this.systemName = Router.systemName; this.user = new User(); var _this = this; this.user.isLoggedIn().done((isIn) =&gt; { _this.setState({loggedIn: isIn, checkedLoggedIn:true}); }); this.afterCompetenceCreate = this.afterCompetenceCreate.bind(this); this.updateBadge = this.updateBadge.bind(this); //this.test(); } test(){ this.render = () =&gt; { return &lt;Test /&gt;; }; /*this.render = () =&gt; { return &lt;UITest /&gt;; }; */} onLogin(){ this.user.isLoggedIn().done((isIn) =&gt; { this.setState({loggedIn: isIn}); }); } onLogout(){ this.selectTab('goals'); this.setState({loggedIn: false}); } renderScene(route, navigator){ return &lt;View&gt; {Router.renderRoute(route, navigator)} &lt;/View&gt; } route(route, navigator){ Router.route(route, navigator); } componentWillMount() { let icons = [ //['md-menu', 'hamburgerIcon'], ['md-add'] ]; //Icon.getImageSource('md-menu', 30) //.then((source) =&gt; this.setState({ hamburgerIcon: source, iconsLoaded: this.state.iconsLoaded+1 })); Icon.getImageSource('md-add', 30) .then((source) =&gt; this.setState({ addIcon: source, iconsLoaded: this.state.iconsLoaded+1 })); } updateBadge(n, ref){ let o = {}; o[ref+'Badge'] = n; this.setState(o); } _renderNavigator(route, ref){ if(this.state.iconsLoaded &lt; 1) { //Erst wenn das Icon geladen ist anzeigen return false; } return &lt;NavigatorIOS ref={ref} tintColor={styles._.navBtnColor} titleTextColor={styles._.navColor} barTintColor={styles._.navBg} itemWrapperStyle={styles._.navWrap} style={styles._.nav} navigationBarHidden={false} initialRoute={route}&gt; &lt;/NavigatorIOS&gt; } afterCompetenceCreate(){ if(this.refs.navGoal) this.refs.navGoal.refs.goals.afterCompetenceCreate(); if(this.refs.navComp) this.refs.navComp.refs.competences.afterCompetenceCreate(); } selectTab(tab, navigatorRef){ if(this.state.selectedTab == tab) { this.refs[navigatorRef].popToTop(); } this.setState({ selectedTab: tab, }); } render() { StatusBar.setBarStyle('light-content', true); var base64Icon = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEsAAABLCAQAAACSR7JhAAADtUlEQVR4Ac3YA2Bj6QLH0XPT1Fzbtm29tW3btm3bfLZtv7e2ObZnms7d8Uw098tuetPzrxv8wiISrtVudrG2JXQZ4VOv+qUfmqCGGl1mqLhoA52oZlb0mrjsnhKpgeUNEs91Z0pd1kvihA3ULGVHiQO2narKSHKkEMulm9VgUyE60s1aWoMQUbpZOWE+kaqs4eLEjdIlZTcFZB0ndc1+lhB1lZrIuk5P2aib1NBpZaL+JaOGIt0ls47SKzLC7CqrlGF6RZ09HGoNy1lYl2aRSWL5GuzqWU1KafRdoRp0iOQEiDzgZPnG6DbldcomadViflnl/cL93tOoVbsOLVM2jylvdWjXolWX1hmfZbGR/wjypDjFLSZIRov09BgYmtUqPQPlQrPapecLgTIy0jMgPKtTeob2zWtrGH3xvjUkPCtNg/tm1rjwrMa+mdUkPd3hWbH0jArPGiU9ufCsNNWFZ40wpwn+62/66R2RUtoso1OB34tnLOcy7YB1fUdc9e0q3yru8PGM773vXsuZ5YIZX+5xmHwHGVvlrGPN6ZSiP1smOsMMde40wKv2VmwPPVXNut4sVpUreZiLBHi0qln/VQeI/LTMYXpsJtFiclUN+5HVZazim+Ky+7sAvxWnvjXrJFneVtLWLyPJu9K3cXLWeOlbMTlrIelbMDlrLenrjEQOtIF+fuI9xRp9ZBFp6+b6WT8RrxEpdK64BuvHgDk+vUy+b5hYk6zfyfs051gRoNO1usU12WWRWL73/MMEy9pMi9qIrR4ZpV16Rrvduxazmy1FSvuFXRkqTnE7m2kdb5U8xGjLw/spRr1uTov4uOgQE+0N/DvFrG/Jt7i/FzwxbA9kDanhf2w+t4V97G8lrT7wc08aA2QNUkuTfW/KimT01wdlfK4yEw030VfT0RtZbzjeMprNq8m8tnSTASrTLti64oBNdpmMQm0eEwvfPwRbUBywG5TzjPCsdwk3IeAXjQblLCoXnDVeoAz6SfJNk5TTzytCNZk/POtTSV40NwOFWzw86wNJRpubpXsn60NJFlHeqlYRbslqZm2jnEZ3qcSKgm0kTli3zZVS7y/iivZTweYXJ26Y+RTbV1zh3hYkgyFGSTKPfRVbRqWWVReaxYeSLarYv1Qqsmh1s95S7G+eEWK0f3jYKTbV6bOwepjfhtafsvUsqrQvrGC8YhmnO9cSCk3yuY984F1vesdHYhWJ5FvASlacshUsajFt2mUM9pqzvKGcyNJW0arTKN1GGGzQlH0tXwLDgQTurS8eIQAAAABJRU5ErkJggg=='; if(!this.state.checkedLoggedIn) { return null } if(!this.state.loggedIn) { return this._renderNavigator({ title: this.systemName + ' Login', component: UserLogin, passProps: { onLogin: () =&gt; this.onLogin() } }, 'userLogin'); } var iconSize = 27; return ( &lt;TabBarIOS translucent={true} tintColor={styles._.secondary} unselectedTintColor={styles._.tabIconColor} barTintColor=&quot;white&quot;&gt; &lt;Icon.TabBarItemIOS iconSize={iconSize} iconName={Router.icons.goals} selected={this.state.selectedTab === 'goals'} onPress={() =&gt; { this.selectTab('goals', 'navGoal'); }}&gt; {this._renderNavigator({ id:'goals', title: 'Lernziele', component: CompetenceList, leftButtonTitle: this.state.loggedIn.username, rightButtonIcon: this.state.addIcon, onRightButtonPress: () =&gt; this.route({ id:'goal.add', component: CompetenceCreate, passProps: { afterCompetenceCreate: () =&gt; this.afterCompetenceCreate(), } }, this.refs.navGoal.navigator), passProps: { ref: 'goals', type:'goals', updateBadge: (n, ref) =&gt; this.updateBadge(n, ref) } }, 'navGoal')} &lt;/Icon.TabBarItemIOS&gt; &lt;Icon.TabBarItemIOS iconSize={iconSize} iconName={Router.icons.badges} badge={this.state.badgesBadge &gt; 0 ? this.state.badgesBadge : undefined} selected={this.state.selectedTab === 'badges'} onPress={() =&gt; { this.selectTab('badges', 'navBadge'); }}&gt; {this._renderNavigator({ title: 'Abzeichen', component: BadgeList, leftButtonTitle: this.state.loggedIn.username, passProps: { updateBadge: (n, ref) =&gt; this.updateBadge(n, ref) } }, 'navBadge')} &lt;/Icon.TabBarItemIOS&gt; {/*&lt;Icon.TabBarItemIOS iconSize={iconSize} iconName={Router.icons.notifications} badge={this.state.notifCount &gt; 0 ? this.state.notifCount : undefined} selected={this.state.selectedTab === 'redTab'} onPress={() =&gt; { this.setState({ selectedTab: 'redTab', notifCount: this.state.notifCount + 1, }); }}&gt; {this._renderContent('#783E33', 'Red Tab', this.state.notifCount)} &lt;/Icon.TabBarItemIOS&gt;*/} &lt;Icon.TabBarItemIOS iconSize={iconSize} iconName={Router.icons.competences} selected={this.state.selectedTab === 'competences'} badge={this.state.competencesBadge &gt; 0 ? this.state.competencesBadge : undefined} onPress={() =&gt; { this.selectTab('competences', 'navComp'); }}&gt; {this._renderNavigator({ title: 'Erreicht', component: CompetenceList, leftButtonTitle: this.state.loggedIn.username, /*rightButtonIcon: this.state.addIcon, onRightButtonPress: () =&gt; this.route({ id:'competence.add', component: CompetenceCreate, passProps: { afterCreation: this.afterCompetenceCreate } }, this.refs.navComp.navigator),*/ passProps: { ref: 'competences', type: 'competences', updateBadge: (n, ref) =&gt; this.updateBadge(n, ref) } }, 'navComp')} &lt;/Icon.TabBarItemIOS&gt; &lt;Icon.TabBarItemIOS iconName={Router.icons.menu} iconSize={iconSize} selected={this.state.selectedTab === 'menu'} onPress={() =&gt; { this.selectTab('menu', 'navMenu'); }}&gt; {this._renderNavigator({ id: 'menu', title: 'MenÃ¼', component: Menu, leftButtonTitle: this.state.loggedIn.username, passProps: { onLogout: () =&gt; this.onLogout() } }, 'navMenu')} &lt;/Icon.TabBarItemIOS&gt; &lt;/TabBarIOS&gt; ); } } AppRegistry.registerComponent('Lernreflex', () =&gt; Lernreflex); Ã— Search results Close "},"lib.js.html":{"id":"lib.js.html","title":"Source: lib.js","body":" Lernreflex Namespaces styles~_styles~compstyles~user Modules styles Classes ActivityActivityViewAdminBadgeBadgeListCompetenceCompetenceCreateCompetenceListCompetenceViewCourseInputScrollViewLearningTemplateLernreflexlibListEntryCompetenceLoaderMenuModelQuestionsRouterSelectListSuperComponentUserUserListUserLogin Source: lib.js /** @class lib */ var lib = { constants: { /** Blacklist of verbs, that contain prefixes, but are no prefixes */ prefix_blacklist:{ analysieren:1 //contains &quot;an&quot;, but &quot;an&quot; is not a prefix in this verb }, /** Prefixes contained in the used verbs, used for conjugation */ prefixes:[ //PrÃ¤fixe 'gegenÃ¼ber', 'zusammen', 'heraus', 'durch', 'her', 'auf', 'aus', 'ein', 'vor', 'dar', 'ab', 'an', 'zu', 'um' ], /** Verbs from Bloom's Taxonomy */ verbs:[ //Wissen 'nennen', 'aufsagen', 'aufzÃ¤hlen', 'aussagen', 'ausfÃ¼hren', 'auffÃ¼hren', 'ausdrÃ¼cken', 'benennen', 'bezeichnen', 'erzÃ¤hlen', 'berichten', 'beschreiben', 'aufschreiben', 'zeichnen', 'skizzieren', 'angeben', 'darstellen', 'schreiben', 'schildern', //VerstÃ¤ndnis 'interpretieren', 'erklÃ¤ren', 'erlÃ¤utern', 'formulieren', 'Ã¼bertragen', 'Ã¼bersetzen', 'deuten', 'identifizieren', 'definieren', 'darstellen', 'darlegen', 'SchlÃ¼sse und Folgerungen ziehen', 'ableiten', 'demonstrieren', 'zusammenfassen', 'herausstellen', 'prÃ¤sentieren', //Anwendung 'anwenden', 'programmieren', 'erstellen', 'herstellen', 'ermitteln', 'herausfinden', 'lÃ¶sen', 'nutzen', 'durchfÃ¼hren', 'errechnen', 'berechnen', 'ausfÃ¼llen', 'eintragen', 'drucken', 'planen', 'erarbeiten', 'verwenden', 'bearbeiten', 'speichern', 'sichern', 'formatieren', 'erstellen', 'gestalten', 'einrichten', 'konfigurieren', 'lÃ¶schen', 'anschlieÃŸen', 'zeichnen', //Analyse 'isolieren', 'auswÃ¤hlen', 'entnehmen', 'sortieren', 'einteilen', 'einordnen', 'herausstellen', 'analysieren', 'vergleichen', 'gegenÃ¼berstellen', 'unterscheiden', 'untersuchen', 'teste', //Synthese 'entwerfen', 'zuordnen', 'verbinden', 'tabellieren', 'konzipieren', 'zusammenstellen', 'in Beziehung setzen', 'entwerfen', 'entwickeln', 'ordnen', 'beziehen', 'koordinieren', //Bewertung 'entscheiden', 'beurteilen', 'urteilen', 'bewerten', 'sortieren', 'klassifizieren', 'bestimmen', 'vergleichen', 'begrÃ¼nden', 'auswÃ¤hlen', 'prÃ¼fen', 'entscheiden', 'Stellung nehmen', 'evaluieren', 'umwandeln' ], /** Default reflection questions for a competence */ generalCompetenceQuestions: [ {id:1, text: 'Wie motiviert bist du das Lernziel zu erreichen?', type: 'multiple'}, {id:2, text: 'Warum mÃ¶chtest du das Lernziel erreichen?', type: 'free'}, {id:3, text: 'Welches Vorwissen hast du, welches dir zum Erreichen des Ziels dient?', type: 'multiple'}, {id:4, text: 'Was wird ein Ergebnis deines Lernens sein?', placeholder: 'Aufsatz, Programm, Video, etc.', type: 'free'}, {id:5, text: 'Wie mÃ¶chtest du das Lernziel erreichen?', type: 'free'}, {id:6, text: 'Wen kannst du fragen, wenn du nicht weiterkommst?', type: 'free'}, {id:7, text: 'Kannst du einfach im Internet suchen um weiterzukommen?', type: 'multiple'}, {id:8, text: 'Findest du, dass das Lernziel zu einfach ist?', type: 'free'}, {id:9, text: 'Bis wann mÃ¶chtest du das Lernziel erreicht haben?', type: 'free'}, ]}, functions: { /** * Conjugate a German verb from infinitive to 1st. pers. singular. */ ich: (infinitive) =&gt; { //Konjugation let verb = infinitive; let rest = ''; if(verb.indexOf(' ') &gt; -1) { let v = verb.split(' '); verb = v.pop(); rest = ' ' + v.join(' '); } if(!lib.constants.prefix_blacklist[verb]) for(var i in lib.constants.prefixes){ let pre = lib.constants.prefixes[i]; if(verb.startsWith(pre)) { verb = verb.replace(new RegExp(pre), ''); rest = rest + ' ... ' + pre; break; } } if(verb.endsWith('en')) { verb = verb.substr(0, verb.length - 1); } else if(verb.endsWith('rn')) { verb = verb.substr(0, verb.length - 1) + 'e'; } else if(verb.endsWith('eln')) { verb = verb.substr(0, verb.length - 3) + 'le'; } return (verb + rest + '').trim(); }, /** Switch key and value in an object */ swapKeyVal: (data) =&gt; { return Object.keys(data).reduce(function(obj,key){ obj[ data[key] ] = key; return obj; },{}); }, /** Get a variable by path from an object */ index: (obj, is, value) =&gt; { if (typeof is == 'string') return this.index(obj,is.split('.'), value); else if (is.length==1 &amp;&amp; value!==undefined) return obj[is[0]] = value; else if (is.length==0) return obj; else return this.index(obj[is[0]],is.slice(1), value); }, /** Set the values of objects in a list, searched by a searchPath (E.g. {}.{}.name). For usage @see Class:Model.mayApplyLocalChanges */ setObjectValues(obj, searchPath, key, setPath, value){ if(!Array.isArray(searchPath)) searchPath = searchPath.split('.'); if(!Array.isArray(setPath)) setPath = setPath.split('.'); console.log(obj, searchPath, key, setPath, value); let current = searchPath.shift(); let last = current &amp;&amp; searchPath.length == 0; if(!current) { return obj; } let keys; if(current == '{}') { keys = Object.keys(obj); } else { keys = [current]; } let canSet = false; let currentSetPath; for(var i in keys){ if(last) { if(obj[keys[i]] == key) { console.log(keys[i], key); if(setPath[0] == '-') { console.log(value); obj = value; break; } else if(setPath[0] == '--') { obj.canSetObjectValues = true; } } } else { obj[keys[i]] = this.setObjectValues(obj[keys[i]], searchPath.slice(), key, setPath, value); if(obj[keys[i]] &amp;&amp; obj[keys[i]].canSetObjectValues) { setPath.shift(); delete obj[keys[i]].canSetObjectValues; if(setPath[0] == '--') { obj.canSetObjectValues = true; } else if(setPath[0]) { obj = this.index(obj, setPath.join('.'), value); } } } } return obj; }, /** Set attributes in a new list */ setKeys: (list, attribute) =&gt; { let newList = {}; list.map((l) =&gt; newList[l[attribute]] = l); return newList; } } }; /** Contains constants like verbs of bloom's taxonomy and functions to conjugate them */ module.exports = lib; Ã— Search results Close "},"components_ListEntryCompetence.js.html":{"id":"components_ListEntryCompetence.js.html","title":"Source: components/ListEntryCompetence.js","body":" Lernreflex Namespaces styles~_styles~compstyles~user Modules styles Classes ActivityActivityViewAdminBadgeBadgeListCompetenceCompetenceCreateCompetenceListCompetenceViewCourseInputScrollViewLearningTemplateLernreflexlibListEntryCompetenceLoaderMenuModelQuestionsRouterSelectListSuperComponentUserUserListUserLogin Source: components/ListEntryCompetence.js 'use strict' /* * Rendert eine Zeile in einem Listview als Kompetenz */ import React, { Component, } from 'react'; import { TouchableHighlight, ListView, Platform, Image, Text, View, } from 'react-native'; import {styles, Icon, Router, Loader} from 'Lernreflex/imports'; /** * Holds the markup for several list elements ocurring on different views in this app. * To render a row, you need to pass a property rowData containing type = {one of the possible function names} without a leading _ * In the future the markup for a row could be transfered back into the belonging class, * to make things more consistent * @extends React.Component * @constructor */ class ListEntryCompetence extends Component{ constructor(){ super(); } /** * Markup for user row * @return {ReactNative.View} */ _user(rowData){ return &lt;View&gt; &lt;View style={styles.list.rowContainer}&gt; &lt;View style={styles.list.textContainer}&gt; &lt;Icon name={Router.icons.person} size={30} color='#CCC' style={{flexDirection:'column', alignSelf:'flex-start', flex:1}} /&gt; &lt;Text style={[styles.list.text, {flexDirection:'column', marginTop:5, flex:8}]}&gt; {rowData.name} {rowData.id == 'mySelf' ? '(Ich)' : ''} &lt;/Text&gt; &lt;/View&gt; &lt;/View&gt; &lt;View style={styles.list.separator} /&gt; &lt;/View&gt; } /** * Markup for badge row * @return {ReactNative.View} */ _badge(rowData){ return &lt;View&gt; &lt;View style={styles.list.rowContainer}&gt; &lt;Image style={{height:50, width:50}} resizeMode='contain' source={{uri:rowData.png}} /&gt; &lt;View style={styles.list.textContainer}&gt; &lt;Text style={styles.list.text}&gt; {rowData.name} &lt;/Text&gt; &lt;Text style={styles.list.right}&gt; {rowData.done ? &lt;Image style={styles._.icon} resizeMode='cover' source={require('Lernreflex/img/checked.png')} /&gt; : ''} &lt;/Text&gt; &lt;/View&gt; &lt;/View&gt; &lt;View style={styles.list.separator} /&gt; &lt;/View&gt; } /** * Markup for comment row * @return {ReactNative.View} */ _comment(rowData){ let date = new Date(rowData.created); return &lt;View&gt; &lt;View style={styles._.row}&gt; &lt;Text style={[styles.list.text, styles._.col, {color:'#CCC', fontSize:12, paddingLeft:10, paddingRight:10, paddingTop:10}]}&gt; {rowData.user} - {date.getDate()}.{date.getMonth()}.{date.getFullYear()}, {date.getHours()}:{date.getMinutes()} &lt;/Text&gt; &lt;/View&gt; &lt;View style={styles._.row}&gt; &lt;Text style={[styles.list.text, styles._.col, {paddingLeft:10, paddingRight:10, paddingBottom:10}]}&gt; {rowData.text} &lt;/Text&gt; &lt;/View&gt; &lt;View style={styles.list.separator} /&gt; &lt;/View&gt; } /** * Markup for competence row * @return {ReactNative.View} */ _competence(){ return &lt;View&gt; &lt;View style={styles.list.rowContainer}&gt; &lt;View style={styles.list.textContainer}&gt; &lt;Text style={styles.list.text}&gt; {this.props.rowData.text} &lt;/Text&gt; &lt;Text style={styles.list.right}&gt; {this.props.rowData.percent}% &lt;/Text&gt; &lt;/View&gt; &lt;/View&gt; &lt;View style={styles.list.separator} /&gt; &lt;/View&gt; } /** * Markup for activity row * @return {ReactNative.View} */ _activity(rowData){ let isDone; if(rowData.done) isDone = &lt;View style={styles.list.right, {justifyContent:'center', padding:5}}&gt; &lt;Image style={{width: 20, height: 20, justifyContent:'center', alignSelf:'center', flex:1}} resizeMode='contain' source={require('Lernreflex/img/checked.png')}&gt;&lt;/Image&gt; &lt;/View&gt; return &lt;View style={styles._.col}&gt; &lt;View style={styles.list.rowContainer}&gt; &lt;View style={styles.list.textContainer}&gt; &lt;Text style={styles.list.text}&gt; {rowData.name} &lt;/Text&gt; {isDone} &lt;View style={styles.list.right, {justifyContent:'center', padding:5}}&gt; &lt;Icon name={Router.icons.comments} size={30} color='#222' style={{flexDirection:'column', justifyContent:'center', alignSelf:'center', flex:1}}&gt;&lt;/Icon&gt; &lt;/View&gt; &lt;/View&gt; &lt;/View&gt; &lt;/View&gt; } /** * Markup for select list row * @return {ReactNative.View} */ _select(rowData){ if(typeof(rowData) != 'object') { rowData = {'id':false, value:rowData}; } return &lt;View style={styles._.col}&gt; &lt;View style={styles.list.rowContainer}&gt; &lt;View style={styles.list.textContainer}&gt; &lt;Text style={styles.list.text}&gt; {rowData.value} &lt;/Text&gt; &lt;/View&gt; &lt;/View&gt; &lt;View style={styles.list.separator} /&gt; &lt;/View&gt; } /** * Markup for user, at the top of a view, if it's different than the current user. * @return {ReactNative.View} */ _currentUser(currentUser){ return &lt;View style={[styles._.row, {backgroundColor:styles._.secondary}]}&gt; &lt;Icon name={Router.icons.person} size={30} color='#FFF' style={{flexDirection:'column', marginLeft:20, alignSelf:'flex-start', flex:1}} /&gt; &lt;Text style={[styles.list.headText, {flexDirection:'column', marginTop:4, flex:10}]}&gt; {currentUser.name} &lt;/Text&gt; &lt;/View&gt; } /** * Render row by props.rowData.type * @return {React.Component} */ render(){ if(this.props.rowData == 'loader') { if(Platform.OS == 'ios') { return &lt;View style={styles._.col}&gt;&lt;Loader /&gt;&lt;/View&gt; } return null; } if(this.props.rowData.id == 'empty') { return &lt;View style={[styles._.row]}&gt; &lt;View style={[styles._.col, {alignItems: 'center'}]}&gt; &lt;Text style={{fontSize:18, padding:20, justifyContent: 'center', alignItems: 'center', alignSelf:'center'}}&gt; {this.props.rowData.text} &lt;/Text&gt; &lt;/View&gt; &lt;/View&gt; } this.type = this.props.rowData.type ? this.props.rowData.type : this.props.type; if(!this.props.rowData) throw this.constructor.name+' needs a &quot;rowData&quot; object as property for type '+this.type; return &lt;TouchableHighlight underlayColor={this.props.underlayColor} onPress={this.props.onPress} style={this.props.style}&gt; {this['_'+this.type](this.props.rowData)} &lt;/TouchableHighlight&gt; } } module.exports = ListEntryCompetence; Ã— Search results Close "},"components_Loader.js.html":{"id":"components_Loader.js.html","title":"Source: components/Loader.js","body":" Lernreflex Namespaces styles~_styles~compstyles~user Modules styles Classes ActivityActivityViewAdminBadgeBadgeListCompetenceCompetenceCreateCompetenceListCompetenceViewCourseInputScrollViewLearningTemplateLernreflexlibListEntryCompetenceLoaderMenuModelQuestionsRouterSelectListSuperComponentUserUserListUserLogin Source: components/Loader.js 'use strict'; import React, { Component } from 'react'; import { StyleSheet, Platform, ActivityIndicator } from 'react-native'; /** * A loading indicator. * @extends React.Component * @constructor */ class Loader extends Component{ constructor(){ super(); } /** * Render the loader. color and top can be passed as props. */ render(){ var color = this.props.color ? this.props.color : '#111'; var top = this.props.top ? this.props.top : 40; return &lt;ActivityIndicator size=&quot;large&quot; style={this.styler(top).s} color={color} /&gt;; } /** * Generate a style for the loader * @param top {int} top margin for the loader */ styler(top){ return StyleSheet.create({ s:{ marginTop:top } }); } } module.exports = Loader; Ã— Search results Close "},"components_Menu.js.html":{"id":"components_Menu.js.html","title":"Source: components/Menu.js","body":" Lernreflex Namespaces styles~_styles~compstyles~user Modules styles Classes ActivityActivityViewAdminBadgeBadgeListCompetenceCompetenceCreateCompetenceListCompetenceViewCourseInputScrollViewLearningTemplateLernreflexlibListEntryCompetenceLoaderMenuModelQuestionsRouterSelectListSuperComponentUserUserListUserLogin Source: components/Menu.js import React, { Component, } from 'react'; import { TouchableHighlight, ListView, ScrollView, Text, View, NavigatorIOS, Platform } from 'react-native'; import {styles, Router, User, Admin, CompetenceList, Loader} from 'Lernreflex/imports'; /** * Represents the view for the menu. * @extends React.Component * @constructor */ class Menu extends Component{ constructor(){ super(); this.user = new User(); var ds = new ListView.DataSource({rowHasChanged: (r1, r2) =&gt; r1 !== r2}); this.links = [ /* {title: 'Empfohlene Lernziele', route:{ id: 'goals', component: CompetenceList, title:'FFF', passProps:{ color: '#000' } }},*/ {title: 'Logout', route:{'id': 'user.logout'}}, ]; var _this = this; let user = new User(); this.state = { links: ds.cloneWithRows(_this.links), } this.renderRow = this.renderRow.bind(this); user.isLoggedIn().then((u) =&gt; { if(Router.adminNames.indexOf(u.username) &gt; -1) { _this.links.push({title: 'Admin', route:{'id': 'admin', component: Admin}}); } _this.setState({ links: ds.cloneWithRows(_this.links), }); }); } /** * Executed when menu entry is pressed */ rowPressed(rowData) { if(rowData.route.id === 'user.logout'){ this.user.logout().then(this.props.onLogout); } else { Router.route(rowData.route, this.props.navigator); } } /** * Renders menu entry * @return {ReactNative.TouchableHighlight} */ renderRow(rowData){ return &lt;TouchableHighlight underlayColor={styles.list.liHover} onPress={() =&gt; { this.rowPressed(rowData) }} style={styles.list.li}&gt; &lt;View&gt; &lt;View style={styles.list.rowContainer}&gt; &lt;View style={styles.list.textContainer}&gt; &lt;Text style={styles.list.text}&gt; {rowData.title} &lt;/Text&gt; &lt;/View&gt; &lt;/View&gt; &lt;View style={styles.list.separator} /&gt; &lt;/View&gt; &lt;/TouchableHighlight&gt; } /** * Render the whole menu * @return {ReactNative.View} */ render(){ return &lt;View style={styles.wrapper}&gt; &lt;ListView style={styles._.list} dataSource={this.state.links} contentContainerStyle={{flex:1}} renderRow={this.renderRow}&gt; &lt;/ListView&gt; &lt;/View&gt; } } module.exports = Menu; Ã— Search results Close "},"styles.js.html":{"id":"styles.js.html","title":"Source: styles.js","body":" Lernreflex Namespaces styles~_styles~compstyles~user Modules styles Classes ActivityActivityViewAdminBadgeBadgeListCompetenceCompetenceCreateCompetenceListCompetenceViewCourseInputScrollViewLearningTemplateLernreflexlibListEntryCompetenceLoaderMenuModelQuestionsRouterSelectListSuperComponentUserUserListUserLogin Source: styles.js 'use strict' /** @module styles */ import React, { StyleSheet, Platform } from 'react-native'; var OS = Platform.OS; var ios = OS == 'ios'; var primaryBG = '#3E6E7F'; //var brighterPrimary = '#6cb9d4'; var brighterPrimary = '#67D8D4'; var primaryDarker = '#0E3E4F'; var secondary = '#EC7426'; var secondaryDark = '#ac5720'; var secondaryBright = '#f59150'; var tabIconColor = '#AAA'; var white = '#FFF'; var gray = '#333'; var lightGray = '#EEE'; var topHeight = 50; var iosTop = 64; /** * Contains the general styles and often used colors for consistency. * @var _ * @namespace _ */ var _ = StyleSheet.create({ button: { backgroundColor: secondary, justifyContent:'center', borderRadius: 5, padding: 10, margin: 10, }, buttonActive:{ backgroundColor:secondary }, tab:{ flex:1, flexDirection:'column', backgroundColor: secondary, justifyContent:'center', paddingTop: 10, paddingBottom: 10, }, tabActive:{ backgroundColor:white }, tabActiveText:{ fontSize: 14, color: secondary, }, otherBG:{ paddingTop:10, backgroundColor:lightGray, }, buttonText: { color: '#fff', alignSelf:'center' }, big:{ fontSize: 20 }, navWrap: { flex: 1, flexDirection:'column' }, nav: { flex: 1, }, list: { flex:1, flexDirection:'column', }, wrapper: { flex:1, flexDirection:'column', backgroundColor:'#FFF' //paddingTop:topHeight //paddingTop: ios ? iosTop : topHeight }, viewWrapper: {//Does not work... flex:1, paddingTop: ios ? topHeight : topHeight }, toolbar: { flex : 0, backgroundColor: primaryBG, height: topHeight, marginLeft:0, paddingTop:0, marginTop:0 }, androidView: { flex:1, marginTop:topHeight, }, toolbarText:{ height: topHeight, color:white, marginTop: -5, fontSize: 20 }, toolbarRight:{ marginTop:0, marginRight:0, paddingLeft: 20, paddingRight: 20, paddingTop:0 }, icon: { width: 20, height: 20 }, ml10:{ marginLeft:10 }, mt10:{ marginTop:10 }, mt20:{ marginTop:20 }, pt10:{ paddingTop:10 }, row:{ flex:0, flexWrap: 'wrap', alignItems: 'center', flexDirection:'row', }, col:{ flex:1, flexDirection:'column' }, center:{ alignSelf:'center' }, justify: { justifyContent:'center', }, highlight:{ color:secondary } }); /** Contains the primary background color */ _.primary = primaryBG; /** Contains the primary background color brighter */ _.primaryBrighter = brighterPrimary; /** Contains the primary background color darker */ _.primaryDarker = primaryDarker; /** Contains the secondary color */ _.secondary = secondary; /** Contains the secondary color brighter */ _.secondaryBrighter = secondaryBright; /** Contains the background color for the navigation on top */ _.navBg = primaryBG; /** Contains the background color of the tab bar at the bottom */ _.navColor = '#FFF'; /** Contains the primary background color of the buttons in the tab bar */ _.navBtnColor = '#FFF'; /** Contains the color of a tapped button */ _.hoverBtn = secondaryBright; /** Contains the color of the icons in the tabbar */ _.tabIconColor = tabIconColor; /** Contains the background color of the content */ _.bg = '#FFF'; /** Contains the default text color */ _.text = '#000'; var list = StyleSheet.create({ separator:{ height: 1, backgroundColor:'#DDD', }, withSeparator:{ borderBottomColor:'#DDD', borderBottomWidth: 1, }, li:{ backgroundColor: '#FFF', }, liHead:{ backgroundColor: '#67B8D4', }, liHead2:{ backgroundColor: brighterPrimary, }, right:{ color: gray, alignItems:'flex-end', justifyContent: 'flex-end' }, headText: { flex:1, color: '#FFF', alignSelf:'flex-start', fontSize:16 }, text: { flex:1, alignSelf:'flex-start', fontSize: 18 }, textContainer: { flexDirection: 'row', flex: 1, }, rowContainer: { flexDirection: 'row', padding: 10, }, }); list.liHover = '#DDD'; list.liHeadHover = _.navBg; /** * Contains the competence styles * @namespace comp */ var comp = StyleSheet.create({ title: { fontSize: 20, padding: 10 }, superTitle:{ margin: 10, marginBottom:0, }, sectionHead:{ fontSize:18, //justifyContent:'center', color:primaryBG, //flexDirection:'row', alignSelf:'center', //flex:1 }, addBtn:{ flex:1, alignSelf:'flex-end' }, questionInput:{ flex:1, marginLeft: ios ? 0 : 0, marginRight: ios ? 0 : 0, marginTop: 0, marginBottom:0, fontSize: 15, height: 60, justifyContent:'flex-start', borderWidth:0, borderRadius: 0, borderColor:'#CCC', color:brighterPrimary, paddingTop:0, paddingLeft:5, paddingRight:5 //backgroundColor:'none' }, titleInput:{ margin: ios ? 10 : 0, fontSize: 18, height: 100, borderWidth:1, borderRadius: 5, borderColor:'#EEE', padding:10, flex:1, }, input:{ backgroundColor:'#FFF', height: 40, fontSize: 18, borderWidth: 1, borderColor: '#EEE', marginLeft: 10, marginRight: 10, marginBottom: 10, borderRadius: 5, marginTop: 10, padding:10, flex: 1 }, tagItems:{ flex:1, flexWrap: 'wrap', alignItems: 'flex-start', flexDirection:'row', }, tagItemsWrapper:{ flex:1, flexDirection:'column' }, tagItem:{ padding:10, backgroundColor: secondary, marginLeft:10, marginTop:10 }, tagItemText:{ color:'#FFF', }, slider:{ marginLeft: ios ? 10 : 0, marginRight: ios ? 10 : 0, }, commentInput: { fontSize: 16, padding:5, flex:1, flexDirection:'row', alignSelf: 'stretch', }, addComment:{ paddingTop:20, paddingBottom: 20, justifyContent: 'center', alignItems: 'center', flex:1 }, circleText:{ backgroundColor: 'transparent', position: 'absolute', top: 45, left: 18, width: 90, textAlign: 'center', color: primaryBG, fontSize: 20, fontWeight: '100' } }); /** * Contains the user styles * @namespace user */ var user = StyleSheet.create({ login:{ backgroundColor:primaryBG }, textInput: { backgroundColor:'#FFF', height: 40, fontSize: 18, borderWidth: 1, borderColor: '#EEE', marginLeft: 30, marginRight: 30, marginBottom: 10, borderRadius: 5, marginTop: 50, padding:10, flex: 1 }, passwordInput: { marginTop:5 } }); var styles = { _: _, list: list, comp: comp, user: user, max: { competenceTitle: 140, competenceCatchwords: 100, competenceGroup: 50, comment: 500, answer: 500 }, wrapper: _.wrapper, }; module.exports = styles; Ã— Search results Close "},"components_Questions.js.html":{"id":"components_Questions.js.html","title":"Source: components/Questions.js","body":" Lernreflex Namespaces styles~_styles~compstyles~user Modules styles Classes ActivityActivityViewAdminBadgeBadgeListCompetenceCompetenceCreateCompetenceListCompetenceViewCourseInputScrollViewLearningTemplateLernreflexlibListEntryCompetenceLoaderMenuModelQuestionsRouterSelectListSuperComponentUserUserListUserLogin Source: components/Questions.js import React, { Component, } from 'react'; import { findNodeHandle, TouchableHighlight, ListView, ScrollView, Text, TextInput, View, NavigatorIOS, Animated, Alert, Platform } from 'react-native'; import { styles, Icon, Router, User, lib, SuperComponent, Competence, CompetenceView, Loader, ListEntryCompetence } from 'Lernreflex/imports'; /** * Represents the view for the reflective questions for a competence. * @extends SuperComponent * @constructor */ class Questions extends SuperComponent{ constructor(){ super(); this.user = new User(); var ds = new ListView.DataSource({rowHasChanged: (r1, r2) =&gt; r1 !== r2}); var _this = this; let user = new User(); this.state = { dataSource: ds, answers: {}, questions: [], currentRow: -1 } //this.colors = ['#09F', '#F66', '#090', '#666', '#F9F', '#990', '#099']; //this.colors = ['#666', '#777', '#888', '#999', '#AAA', '#BBB', '#CCC', '#DDD']; this.colors = ['#3E6E7F', '#4E7E8F', /*'#5E8E9F', '#6E9EAF', '#7EAEBF', '#8EBECF', '#9ECEDF'*/]; this.render = this.render.bind(this); this.renderRow = this.renderRow.bind(this); this.renderCurrentRow = this.renderCurrentRow.bind(this); this.changeMode = this.changeMode.bind(this); this.changeQuestion = this.changeQuestion.bind(this); } componentDidMount(){ this.setQuestions(); } /** * Get the numbers of questions the user has answered for a competence + 1. * @return {int} */ getMaxAnswers(){ let oneNot = false; let answers = this.state.answers; return this.state.questions.filter((q) =&gt; { let res = !oneNot &amp;&amp; answers[q.text]; if(!answers[q.text]) oneNot = true; return res; }).length; } /** * Set the questions for the view by the props */ setQuestions(){ let questions = this.state.questions = this.props.questions; let answers = this.state.answers = this.props.answers; let maxAnswers = this.getMaxAnswers(); let questionList = [ {text: 'competence'}, {text: 'currentUser'}, ...questions, //{text: 'saveButton'}, ]; console.log(questionList); //console.log(answers); this.setState({ dataSource: this.state.dataSource.cloneWithRows(questionList), questions: questions, answers: answers, maxAnswers: maxAnswers, currentUser: this.props.currentUser, currentRow: -1 }) } /** * Save the answers to a question * @param q {string} question ID */ saveAnswers(q){ let c = new Competence(); let answers = []; if(q) { answers = {}; answers[q] = this.state.answers[q]; } else answers = this.state.answers; answers = Object.keys(answers).map((q) =&gt; { return { text: this.state.answers[q], questionId: q }; }).filter((a) =&gt; (a.text+'').trim() ? true : false); this.setState({saving:true}); return c.saveAnswers(this.props.competenceData, answers).then((d) =&gt; { this.setState({saving:false}); this.props.questionsAnswered(); }) } rowPressed(rowData) { } /** * Scroll a component into view. * @param refName {string} the component ref string. */ inputFocused (refName) { //console.log(refName, this.refs[refName], this.refs); //setTimeout(() =&gt; { if(Platform.OS != 'nonsense') { return; } let scrollResponder = this.refs.scrollView.getScrollResponder(); scrollResponder.scrollResponderScrollNativeHandleToKeyboard( findNodeHandle(this.refs[refName]), 100, //additionalOffset false ); //}, 1); } /** * Render current user at the top, if different from the current one */ renderUser(){ if(this.state.currentUser){ return &lt;ListEntryCompetence type=&quot;currentUser&quot; underlayColor={styles._.primary} onPress={() =&gt; {this.showUsers()}} rowData={this.state.currentUser} /&gt; } return null; } /** * Render the competence title * @return {ReactNative.View} */ renderCompetence(){ //console.log(this.props.competenceData); return &lt;View style={{backgroundColor:'#FFF'}}&gt; &lt;Text style={styles.comp.title}&gt;{this.props.competenceData.text}&lt;/Text&gt; &lt;/View&gt; } /** * Set the focus to the current answer input field */ setCurrentFocus(){ let fun = () =&gt; { if(this.refs.currentAnswer) { this.refs.currentAnswer.focus(); } else setTimeout(fun, 100); } fun(); } /** * Change the view from a list of questions to the single question/answer view, and vice versa * @param mode {int} 0 or 1, 1 is the mode for answering questions one by one, 0 shows a list * @param currentRow {int} The current question index */ changeMode(mode, currentRow){ if(mode == 1) { //In den Beantwortenmodus gehen //console.log(currentRow, this.state.questions); let answerCopies = Object.assign({}, this.state.answers); let currentQuestion = this.state.questions[currentRow]; if(currentQuestion) currentQuestion = currentQuestion.text; this.setState({currentRow, currentQuestion, answerCopies}); this.setCurrentFocus(); } else if(mode == 0){ //In den Ãœbersichtsmodus if(this.state.answerCopies[this.state.currentQuestion]) this.state.answers[this.state.currentQuestion] = this.state.answerCopies[this.state.currentQuestion]; if(this.state.changedAnswer) this.saveAnswers(this.state.currentQuestion); this.setState({ maxAnswers: this.getMaxAnswers(), currentRow: -1 }); } } /** * Check if a question was answered * @param top {int} top margin for the loader */ wasAnswered(q){ return this.state.answers[q] &amp;&amp; this.state.answers[q].trim(); } /** * Navigate to next or previous question * @param dir {string} previous or next */ changeQuestion(dir){ let newRow = this.state.currentRow; let changedAnswer = this.state.changedAnswer; console.log(changedAnswer, this.wasAnswered(this.state.currentQuestion)); if(dir == 'next'){ if(changedAnswer) this.saveAnswers(this.state.currentQuestion); if(!this.wasAnswered(this.state.currentQuestion)) return; if(this.state.currentRow &gt;= this.state.questions.length - 1) return this.changeMode(0); newRow = this.state.currentRow + 1; } else if(dir == 'previous'){ if(this.state.answerCopies[this.state.currentQuestion]) this.state.answers[this.state.currentQuestion] = this.state.answerCopies[this.state.currentQuestion]; if(this.currentRow == 0) return this.changeMode(0); newRow = this.state.currentRow - 1; } delete this.refs.currentAnswer; let currentQuestion = this.state.questions[newRow]; if(currentQuestion) currentQuestion = currentQuestion.text; this.setState({currentRow:newRow, currentQuestion:currentQuestion, changedAnswer:false}); this.setCurrentFocus(); } /** * Render the current question in answering mode * @param rowData {object} question data */ renderCurrentRow(rowData){ if(rowData.index != this.state.currentRow) return null; let ref = 'currentAnswer'; let index = rowData.index; let answer = &lt;TextInput ref={(com) =&gt; this.refs[ref] = com} onFocus={this.inputFocused.bind(this, ref)} onChangeText={(text) =&gt; { if(this.enterButtonPressed(text)){ this.changeQuestion('next'); } else { this.state.answers[rowData.text] = text; this.setState({answers:this.state.answers, currentQuestion:rowData.text, changedAnswer: true}); } }} value={this.state.answers[rowData.text]} multiline={true} numberOfLines={3} returnKeyType=&quot;next&quot; style={styles.comp.questionInput} maxLength={styles.max.answer} autoFocus={true} editable={!this.state.loading} placeholder={rowData.placeholder ? rowData.placeholder : 'Antwort eingeben ...'}&gt; &lt;/TextInput&gt; return &lt;View style={[styles.list.liHead, {backgroundColor:this.colors[rowData.index % this.colors.length]}]}&gt; &lt;Text style={[styles.list.headText, {margin:5}]}&gt;Frage {index + 1}/{this.state.questions.length}&lt;/Text&gt; &lt;View style={[styles._.row, {paddingBottom:0}]}&gt; &lt;View style={styles._.col}&gt; &lt;Text style={[styles.list.headText, {margin:5}]}&gt; {rowData.text} &lt;/Text&gt; &lt;/View&gt; &lt;/View&gt; &lt;View style={styles._.row}&gt; {answer} &lt;/View&gt; &lt;View style={styles._.row}&gt; &lt;View style={[styles._.col, {flex:0.2}]}&gt; &lt;TouchableHighlight underlayColor='#FFF' style={styles._.button} onPress={ () =&gt; {this.changeQuestion('previous')} }&gt; &lt;Text style={styles._.buttonText}&gt;{'&lt;'}&lt;/Text&gt; &lt;/TouchableHighlight&gt; &lt;/View&gt; &lt;View style={[styles._.col, {flex:0.3}]}&gt; &lt;TouchableHighlight underlayColor='#FFF' style={[styles._.button, {backgroundColor:styles._.primaryDarker}]} onPress={ () =&gt; {this.changeMode(0)} }&gt; &lt;Text style={styles._.buttonText}&gt;Ãœbersicht&lt;/Text&gt; &lt;/TouchableHighlight&gt; &lt;/View&gt; &lt;View style={[styles._.col, {flex:0.5}]}&gt; &lt;TouchableHighlight underlayColor='#FFF' style={styles._.button} onPress={ () =&gt; {this.changeQuestion('next')} }&gt; &lt;Text style={styles._.buttonText}&gt;Speichern{' &gt;'}&lt;/Text&gt; &lt;/TouchableHighlight&gt; &lt;/View&gt; &lt;/View&gt; &lt;/View&gt; } /** * Render question in list view * @param rowData {object} question data */ renderRow(rowData){ if(rowData.text == 'saveButton') { return this.renderSaveButton(); } if(rowData.text == 'currentUser') { return this.renderUser(); } if(rowData.text == 'competence') { return this.renderCompetence(); } if(this.state.currentRow &gt; -1) return this.renderCurrentRow(rowData); if(rowData.index &gt; this.state.maxAnswers) return null; var ref = ''; ref = rowData.index !== undefined ? 'text_'+rowData.index : ''; let index = rowData.index !== undefined ? (rowData.index + 1) + '. ' : ''; let bg = rowData.index === undefined ? '#FFF' : this.colors[rowData.index % this.colors.length]; var nextRef = 'text_'+(rowData.index + 1); let color = styles._.primaryDarker; let text = this.state.currentUser ? 'Frage wurde noch nicht beantwortet.' : 'Frage beantworten ...' if(this.state.answers[rowData.text]) { color = styles._.primaryBrighter; text = this.state.answers[rowData.text]; } let answer = &lt;Text style={{color:color, fontSize:16, marginLeft:20, marginRight:20, marginBottom:10}}&gt; {text} &lt;/Text&gt; let ComponentType = View; let style = [styles.list.liHead, {backgroundColor:bg}]; let props = {}; if(!this.state.currentUser) { ComponentType = TouchableHighlight; props.underlayColor = '#FFF'; props.onPress = () =&gt; { this.changeMode(1, rowData.index); } } return &lt;ComponentType {...props} style={style}&gt; &lt;View&gt; &lt;View style={[styles._.row, {paddingBottom:0}]}&gt; &lt;View style={styles._.col}&gt; &lt;Text style={[styles.list.headText, {margin:5}]}&gt; {index}{rowData.text} &lt;/Text&gt; &lt;/View&gt; &lt;/View&gt; &lt;View style={[styles._.row]}&gt; {answer} &lt;/View&gt; &lt;/View&gt; &lt;/ComponentType&gt; } /** * Render the view of the reflection questions of a competence */ render(){ //let style = this.state.currentRow &gt; -1 ? {backgroundColor:styles._.primary} : {}; let style = {backgroundColor:styles._.primary}; return &lt;View style={[styles.wrapper, style]}&gt; &lt;ListView ref=&quot;scrollView&quot; keyboardDismissMode='interactive' keyboardShouldPersistTaps={true} style={[styles._.list]} dataSource={this.state.dataSource} renderRow={this.renderRow}&gt; &lt;/ListView&gt; &lt;/View&gt; } } module.exports = Questions; Ã— Search results Close "},"components_SuperComponent.js.html":{"id":"components_SuperComponent.js.html","title":"Source: components/SuperComponent.js","body":" Lernreflex Namespaces styles~_styles~compstyles~user Modules styles Classes ActivityActivityViewAdminBadgeBadgeListCompetenceCompetenceCreateCompetenceListCompetenceViewCourseInputScrollViewLearningTemplateLernreflexlibListEntryCompetenceLoaderMenuModelQuestionsRouterSelectListSuperComponentUserUserListUserLogin Source: components/SuperComponent.js 'use strict'; import React, { Component, } from 'react'; import { AppRegistry, StyleSheet, Platform, ListView, TouchableHighlight, StatusBar, Text, View, TouchableOpacity, Navigator, ScrollView, ToolbarAndroid, BackAndroid } from 'react-native'; import {styles} from 'Lernreflex/imports'; /** * Represents a generic Component class that holds functions needed in several other classes. * @extends React.Component * @constructor * @param props {object} The properties of the component */ class SuperComponent extends Component{ constructor(props){ super(props); this.unmounting = false; } componentWillUnmount(){ this.unmounting = true; } setState(obj){ if(!this.unmounting) { super.setState(obj); } } /** * Check if a new line button was pressed on the keyboard in a text input. * @param text {string} The current text in the input to check for new lines. * @param ref {string} ref name of the current input * @param nextRef {string} ref name of the next input in order. * @return {bool} */ enterButtonPressed(text, ref, nextRef){ let match = /\\r|\\n/.exec(text); if (match) { //if(this.refs[ref]) this.refs[ref].blur(); //console.log(nextRef); if(this.refs[nextRef]) this.refs[nextRef].focus(); } return match; } } module.exports = SuperComponent; Ã— Search results Close "},"Router.js.html":{"id":"Router.js.html","title":"Source: Router.js","body":" Lernreflex Namespaces styles~_styles~compstyles~user Modules styles Classes ActivityActivityViewAdminBadgeBadgeListCompetenceCompetenceCreateCompetenceListCompetenceViewCourseInputScrollViewLearningTemplateLernreflexlibListEntryCompetenceLoaderMenuModelQuestionsRouterSelectListSuperComponentUserUserListUserLogin Source: Router.js 'use strict' import React from 'react'; /** * Provides functions for routing in a navigator and contains some of the app's global variables * @class Router */ var Router = { systemName: 'Lernreflex', adminNames: ['mkapp', 'admin', 'teacher'], icons: { goals:'ios-pie-outline', badges:'md-ribbon', notifications:'md-notifications', competences:'md-school', menu:'md-menu', community:'ios-contacts', person:'ios-person', addRound:'ios-add-circle', comments:'ios-chatboxes', }, /** * Route to a new view * @param route {object} Contains component class and props for target view. * @param navigator {ReactNative.Navigator|ReactNative.NavigatorIOS} * @param params {object} Object with params to change the routing function (see bottom of this function for use) */ route(route, navigator, params){ if(!route.passProps){ route.passProps = {}; } switch (route.id) { case 'goals': route.passProps = {...route.passProps, type:'goals'}; route.title = 'Lernziele'; break; case 'competences': route.passProps = {...route.passProps, type:'competences'}; route.title = 'Kompetenzen'; break; case 'questions': route.passProps = {...route.passProps}; route.title = 'Reflexionsfragen'; break; case 'goal': route.passProps = {...route.passProps, type:'goals'}; route.title = 'Lernziel'; break; case 'competence': route.passProps = {...route.passProps, type:'competences'}; route.title = 'Kompetenz'; break; case 'goal.add': route.title = 'Lernziel erstellen'; route.passProps = {...route.passProps, type: 'goals', inputTitle:'Lernziel eingeben'}; break; case 'competence.add': route.title = 'Kompetenz hinzufÃ¼gen'; route.passProps = {...route.passProps, type: 'competences', inputTitle:'Kompetenz eingeben'}; break; case 'user.login': if(!route.title) route.title = 'Einloggen'; break; case 'users': route.title = 'Mitlerner'; break; case 'menu': route.title = 'MenÃ¼'; break; case 'notifications': route.title = 'Benachrichtigungen'; break; case 'badges': route.title = 'Abzeichen'; //'Badges'; break; case 'admin': route.title = 'Admin'; break; case 'select': route.leftButtonTitle = 'Abbrechen'; route.onLeftButtonPress = () =&gt; {navigator.pop()}; break; } console.log(route); if(!navigator){ return route; } if(!params){ navigator.push(route); } else { if(params.replace) navigator.replace(route); if(params.reset) navigator.resetTo(route); if(params.replacePrevious) { navigator.replacePreviousAndPop(route); } } }, /** * Render the route.component * @param route {object} Contains component class and props for target view. * @param navigator {ReactNative.Navigator|ReactNative.NavigatorIOS} */ renderRoute(route, navigator){ route = this.route(route); return (&lt;route.component navigator={navigator} route={route} title={route.title} {...route.passProps} /&gt;); }, } module.exports = Router; Ã— Search results Close "},"components_SelectList.js.html":{"id":"components_SelectList.js.html","title":"Source: components/SelectList.js","body":" Lernreflex Namespaces styles~_styles~compstyles~user Modules styles Classes ActivityActivityViewAdminBadgeBadgeListCompetenceCompetenceCreateCompetenceListCompetenceViewCourseInputScrollViewLearningTemplateLernreflexlibListEntryCompetenceLoaderMenuModelQuestionsRouterSelectListSuperComponentUserUserListUserLogin Source: components/SelectList.js import React, {Component} from 'react'; import ReactNative, { TouchableHighlight, TouchableOpacity, ListView, ScrollView, Text, TextInput, Platform, View, Alert, NavigatorIOS, Picker } from 'react-native'; import dismissKeyboard from 'dismissKeyboard' import { styles, lib, Competence, LearningTemplate, User, Loader, InputScrollView, ListEntryCompetence } from 'Lernreflex/imports'; /** * Represents the view for a filterable select list. * @extends React.Component * @constructor */ class SelectList extends Component{ constructor(){ super(); var ds = new ListView.DataSource({ rowHasChanged: (r1, r2) =&gt; r1 !== r2 }); this.state = { elements: [], filter: '', dataSource: ds, renderTheList: 0, }; this.render = this.render.bind(this); this.renderRow = this.renderRow.bind(this); this.renderList = this.renderList.bind(this); this.forceUpdate = this.forceUpdate.bind(this); } createCompetence(){ } componentDidMount(){ this.setState({dataSource:this.state.dataSource.cloneWithRows(this.props.elements)}); setTimeout(this.forceUpdate, 1000); } /** * Filter the elements of the list by an input search query * @param filter {string} search string */ filterElements(filter){ let { elements } = this.props; const regex = new RegExp(filter.trim(), 'i'); let filteredElements = elements.filter(el =&gt; { if(typeof(el) == 'string') { el = {id:el, value:el}; } if(!el.id) el.id = ''; if(!el.value) el.value = ''; return el.id.search(regex) &gt;= 0 || el.value.search(regex) &gt;= 0; }); this.setState({filter:filter, dataSource:this.state.dataSource.cloneWithRows(filteredElements)}); } /** * Render the entries of the select list * @param rowData {object} Row data * @return {ListEntryCompetence} */ renderRow(rowData){ return &lt;ListEntryCompetence type='select' underlayColor={styles.list.liHover} onPress={() =&gt; this.rowPressed(rowData)} rowData={rowData} style={styles.list.li} /&gt; } /** * Executed when an item in the list is selected. Returns the navigator to the previous view. * @param rowData {object} Row data */ rowPressed(rowData){ this.props.selected(rowData); dismissKeyboard(); this.props.navigator.pop(); } /** * Scroll to a component * @param refName {string} ref name of the component */ _scrollToBottom(refName) { var _this = this; if(Platform.OS != 'ios') return; setTimeout(() =&gt; { let scrollResponder = _this.refs.scroller.getScrollResponder(); scrollResponder.scrollResponderScrollNativeHandleToKeyboard( ReactNative.findNodeHandle(_this.refs[refName]), 10, //additionalOffset true ); }, 1); } /** * Render the list of entries */ renderList(){ if(this.state.renderTheList &lt;= 1) { this.state.renderTheList = this.state.renderTheList + 1; return null; } return &lt;View style={[styles._.row, {flex:1, alignItems:'flex-start'}]}&gt; &lt;ListView keyboardShouldPersistTaps={true} enableEmptySections={true} style={[styles._.list, {flex:1}]} dataSource={this.state.dataSource} renderRow={this.renderRow}&gt; &lt;/ListView&gt; &lt;/View&gt; } /** * Render the input filter and the list */ render(){ return &lt;View style={styles.wrapper}&gt; &lt;View style={[styles._.row,{flex:0, marginTop:Platform.OS == 'ios' ? 80 : 0, height:50}]}&gt; {/*onSubmitEditing={(event) =&gt; this.selected()}*/} &lt;TextInput ref=&quot;filter&quot; onChangeText={(filter) =&gt; this.filterElements(filter)} value={this.state.filter} autoCapitalize='none' autoCorrect={false} multiline={false} autoFocus={true} editable={!this.state.loading} style={[styles.comp.input]} placeholder={this.props.placeholder ? this.props.placeholder : 'Filter'}&gt; &lt;/TextInput&gt; &lt;/View&gt; {this.renderList()} &lt;/View&gt; } } module.exports = SelectList; Ã— Search results Close "},"models_User.js.html":{"id":"models_User.js.html","title":"Source: models/User.js","body":" Lernreflex Namespaces styles~_styles~compstyles~user Modules styles Classes ActivityActivityViewAdminBadgeBadgeListCompetenceCompetenceCreateCompetenceListCompetenceViewCourseInputScrollViewLearningTemplateLernreflexlibListEntryCompetenceLoaderMenuModelQuestionsRouterSelectListSuperComponentUserUserListUserLogin Source: models/User.js 'use strict' import Model from 'Lernreflex/models/Model'; import {lib} from 'Lernreflex/imports'; /** * Represents a user. * @extends Model * @constructor * @param {bool} caching - If data can be fetched from cache. */ class User extends Model{ constructor(caching = true){ super('User', caching); //Dont use this.constructor.name because it will be something else when building this.urls = { competences: '' } this.definition = { role:'*', userId:'*', lmsSystems:'*', printableName:'*', courseContext:'*', } this.setApi(1); } /** * Save a user object to the API * @param obj {object} A user object that has everything defined in the definition */ save(obj){ obj = this.checkDefinition(obj); if(obj){ return this.put('users/'+obj.userId, obj); } } generateID(obj){ } /** * Try to log in * @param user {string} username * @param password {string} password * @return {Promise} */ tryLogin(user, password){ //return new Promise((resolve, reject) =&gt; resolve(&quot;true&quot;)); return this.clearStorage() .then(() =&gt; this.get('users/'+user+'/systems', {password:password, nocache:true}).then((d) =&gt; { console.log(d); if(d &amp;&amp; d.data &amp;&amp; d.data.length) { d = lib.functions.swapKeyVal(d.data); if(!d.moodle) return false; /*if(!d.db) return this.save({ userId: user, courseContext: 'university', role: 'student', printableName: user, lmsSystems: 'db' }).then(() =&gt; d);*/ return true; } return false; })); } /** * Log the user in and trigger the sync with the API * @param username {string} username * @param password {string} password * @return {Promise} */ login(username, password){ if(username &amp;&amp; password) { let user = { username: username, password: password }; let sync = { userName: username, password: password, syncUsers: true, syncCourses: true, syncBadges: false, syncActivities: false, }; return this.post('users/sync/moodle', sync) .then(() =&gt; this.setItem('auth', user)); } return Promise.resolve(); } /** Check if current user is logged in * @return {Promise} */ isLoggedIn(){ return this.getItem('auth', false); } /** * Log the current user out * @return {Promise} */ logout() { return this.setItem('auth', false); } /** Get the users of a course * @param courseId {string} course Id * @return {Promise} */ getUsers(courseId){ let _this = this; return this.isLoggedIn().then((u) =&gt; _this.get('users', {userName:u.username, password:u.password})).then((d) =&gt; { let users = d.map((user) =&gt; { let u = {}; u.username = user.printableName ? user.printableName : user.userId; //From moodle: userId is a number, printableName is the username u.name = u.username; u.role = user.role; u.courseContext = user.courseContext; u.fromSystem = user.lmsSystems; return u; }); return users.filter((u) =&gt; { return u.courseContext+'' == courseId+'' &amp;&amp; users.filter((us) =&gt; { return us.fromSystem == 'db' &amp;&amp; us.username == u.username; }).length &gt; 0; }); }); } /** Get the current user object * @return {Promise} */ getCurrentUser(){ return this.getItem('currentUser'); } /** * Set the current user in local storage * @param currentUser {object} containing username and password * @return {Promise} */ setCurrentUser(currentUser){ return this.setItem('currentUser', currentUser); } /** Check if two users are different * @param u1 {object|string} user 1 * @param u2 {object|string} user 2 * @return {bool} */ different(u1, u2){ return !u1 != !u2 || (u1 &amp;&amp; u2 &amp;&amp; u1.username != u2.username); } } module.exports = User; Ã— Search results Close "},"components_UserList.js.html":{"id":"components_UserList.js.html","title":"Source: components/UserList.js","body":" Lernreflex Namespaces styles~_styles~compstyles~user Modules styles Classes ActivityActivityViewAdminBadgeBadgeListCompetenceCompetenceCreateCompetenceListCompetenceViewCourseInputScrollViewLearningTemplateLernreflexlibListEntryCompetenceLoaderMenuModelQuestionsRouterSelectListSuperComponentUserUserListUserLogin Source: components/UserList.js import React, { Component, } from 'react'; import { TouchableHighlight, ListView, ScrollView, RefreshControl, Text, View, NavigatorIOS, Platform } from 'react-native'; import {styles, Router, User, CompetenceList, CompetenceView, ActivityView, ListEntryCompetence, Loader, Icon} from 'Lernreflex/imports'; /** * Represents the view for the list of users sharing a competence * @extends React.Component * @constructor */ class UserList extends Component{ constructor(){ super(); this.user = new User(); var ds = new ListView.DataSource({rowHasChanged: (r1, r2) =&gt; r1 !== r2}); var _this = this; this.state = { dataSource: ds, refreshing: false, mySelf:{} } this.renderRow = this.renderRow.bind(this); } componentWillUnmount(){ this.unmounting = true; } setState(input){ if(!this.unmounting){ super.setState(input); } } componentDidMount(){ this.unmounting = false; let user = new User(); //this.setState({ dataSource: this.state.dataSource.cloneWithRows(['loader']) }); user.getCurrentUser().then((cu) =&gt; { user.isLoggedIn().then((u) =&gt; { console.log(u, cu); if(user.different(u, cu)) { this.setState({currentUser: cu, mySelf: u}); } else this.setState({mySelf: u}); this.loadData(); }); }) } /** * Load users for course passed by props.competenceData.courseId * @param caching {bool} If users can be loaded from cache */ loadData(caching = true){ let user = new User(caching); let _this = this; this.setState({refreshing:true}) user.getUsers(this.props.competenceData.courseId).then((d) =&gt; { user.isLoggedIn().then((u) =&gt; { if(_this.state.currentUser) { u.id = 'mySelf'; d.unshift(u); d.unshift({name:'currentUser'}); } _this.setState({ dataSource: _this.state.dataSource.cloneWithRows(d), refreshing: false }); }) console.log('USERS:', d); }); } /** * Executed if a user is selected * @param rowData {object} user data */ rowPressed(rowData) { let route = {...this.props.previousRoute}; //console.log(this.props.previousRoute); if(!route.passProps){ route.passProps = {}; } if(rowData.id == 'mySelf') rowData = false; route.passProps.currentUser = rowData; route.component = this.props.backTo == 'competence' ? CompetenceView : ActivityView; console.log('user slected', route.passProps); console.log(rowData); let user = new User(); user.setCurrentUser(rowData).then(() =&gt; { this.props.navigator.pop(); //Router.route(route, this.props.navigator, {replacePrevious:true}); }) } /** * Render user at the top, if different from the current */ renderUser(){ return &lt;ListEntryCompetence type=&quot;currentUser&quot; underlayColor={styles._.primary} onPress={() =&gt; this.showUsers()} rowData={this.state.currentUser} /&gt; } /** * Render a user in the list. * @param rowData {object} user data */ renderRow(rowData){ //if(rowData == 'loader') return null; if(rowData.name == 'currentUser') return this.renderUser(); if(rowData.name == this.state.mySelf.username) return null; return &lt;ListEntryCompetence type=&quot;user&quot; underlayColor={styles._.primary} onPress={() =&gt; this.rowPressed(rowData)} rowData={rowData} /&gt; } /** * Executed on pull to refresh */ _onRefresh(){ this.loadData(false); } /** * Render the list view */ render(){ return &lt;View style={styles.wrapper}&gt; &lt;ListView refreshControl={&lt;RefreshControl refreshing={this.state.refreshing} onRefresh={this._onRefresh.bind(this)} /&gt;} style={styles._.list} enableEmptySections={true} dataSource={this.state.dataSource} renderRow={this.renderRow}&gt; &lt;/ListView&gt; &lt;/View&gt; } } module.exports = UserList; Ã— Search results Close "},"components_UserLogin.js.html":{"id":"components_UserLogin.js.html","title":"Source: components/UserLogin.js","body":" Lernreflex Namespaces styles~_styles~compstyles~user Modules styles Classes ActivityActivityViewAdminBadgeBadgeListCompetenceCompetenceCreateCompetenceListCompetenceViewCourseInputScrollViewLearningTemplateLernreflexlibListEntryCompetenceLoaderMenuModelQuestionsRouterSelectListSuperComponentUserUserListUserLogin Source: components/UserLogin.js import React, {Component} from 'react'; import { TouchableHighlight, ListView, ScrollView, Text, TextInput, View, Platform, Alert, NavigatorIOS, ActivityIndicatorIOS, ProgressBarAndroid } from 'react-native'; import { styles, Router, Loader, User, CompetenceList, InputScrollView } from 'Lernreflex/imports'; /** * Represents the view for the initial login. * The props need to contain a onLogin function which will be called after the login was successfull * @extends React.Component * @constructor */ class UserLogin extends Component{ constructor(){ super(); this.state = {username:'', password:''}; this.render = this.render.bind(this); this.tryLogin = this.tryLogin.bind(this); } /** * Try to login the user with the given credentials from the input. */ tryLogin(){ var user = new User(false); var _this = this; let username = this.state.username, password = this.state.password; console.log('TRY'); this.setState({loggingIn:true}); user.tryLogin(username, password) .done((d) =&gt; { if(!d){ _this.setState({loggingIn:false, loggedIn:d}); Alert.alert( 'Login fehlgeschlagen', 'Nutzer oder Passwort sind fehlerhaft.', [ {text: 'Ok', onPress: () =&gt; {this.refs.username.focus()}}, ]); return false; } user.login(username, password).done(() =&gt; { _this.setState({loggingIn:false, loggedIn:d}); this.props.onLogin(); }); }); } componentDidMount(){ this.unmounting = false; } componentWillUnmount(){ this.unmounting = true; } setState(obj){ if(this.unmounting) return; super.setState(obj); } /** * Render the login button */ _renderLoginButton(){ if (!this.state.loggingIn) { if(!this.state.loggedIn) { return ( &lt;TouchableHighlight ref=&quot;loginButton&quot; underlayColor={styles._.hoverBtn} style={styles._.button} onPress={() =&gt; this.tryLogin()}&gt; &lt;Text style={[styles._.buttonText, styles._.big]}&gt;Einloggen&lt;/Text&gt; &lt;/TouchableHighlight&gt; ); } else return false; } else { return &lt;Loader color=&quot;#FFF&quot; /&gt; } } /** * Render the login view */ render(){ var type = this.props.type; return &lt;View style={styles.wrapper}&gt; &lt;InputScrollView style={styles.user.login}&gt; &lt;TextInput ref=&quot;username&quot; onChangeText={(username) =&gt; this.setState({username})} value={this.state.username} style={styles.user.textInput} keyboardType=&quot;email-address&quot; onSubmitEditing={(event) =&gt; { this.refs.password.focus(); }} autoCorrect={false} editable={!this.state.loggingIn} autoCapitalize=&quot;none&quot; autoFocus={true} placeholder='Nutzername'&gt; &lt;/TextInput&gt; &lt;TextInput ref=&quot;password&quot; onChangeText={(password) =&gt; this.setState({password})} value={this.state.password} secureTextEntry={true} editable={!this.state.loggingIn} style={[styles.user.textInput, styles.user.passwordInput]} onSubmitEditing={(event) =&gt; { this.tryLogin(); }} placeholder='Passwort'&gt; &lt;/TextInput&gt; {this._renderLoginButton()} &lt;/InputScrollView&gt; &lt;/View&gt; } } module.exports = UserLogin; Ã— Search results Close "},"modules.list.html":{"id":"modules.list.html","title":"Modules","body":" Lernreflex Namespaces styles~_styles~compstyles~user Modules styles Classes ActivityActivityViewAdminBadgeBadgeListCompetenceCompetenceCreateCompetenceListCompetenceViewCourseInputScrollViewLearningTemplateLernreflexlibListEntryCompetenceLoaderMenuModelQuestionsRouterSelectListSuperComponentUserUserListUserLogin Modules Classes Activity ActivityView Admin Badge BadgeList Competence CompetenceCreate CompetenceList CompetenceView Course InputScrollView LearningTemplate Lernreflex Lernreflex lib ListEntryCompetence Loader Menu Model Questions Router SelectList SuperComponent User UserList UserLogin Namespaces _ comp user Ã— Search results Close "},"classes.list.html":{"id":"classes.list.html","title":"Classes","body":" Lernreflex Namespaces styles~_styles~compstyles~user Modules styles Classes ActivityActivityViewAdminBadgeBadgeListCompetenceCompetenceCreateCompetenceListCompetenceViewCourseInputScrollViewLearningTemplateLernreflexlibListEntryCompetenceLoaderMenuModelQuestionsRouterSelectListSuperComponentUserUserListUserLogin Classes Classes Activity ActivityView Admin Badge BadgeList Competence CompetenceCreate CompetenceList CompetenceView Course InputScrollView LearningTemplate Lernreflex Lernreflex lib ListEntryCompetence Loader Menu Model Questions Router SelectList SuperComponent User UserList UserLogin Namespaces _ comp user Ã— Search results Close "},"namespaces.list.html":{"id":"namespaces.list.html","title":"Namespaces","body":" Lernreflex Namespaces styles~_styles~compstyles~user Modules styles Classes ActivityActivityViewAdminBadgeBadgeListCompetenceCompetenceCreateCompetenceListCompetenceViewCourseInputScrollViewLearningTemplateLernreflexlibListEntryCompetenceLoaderMenuModelQuestionsRouterSelectListSuperComponentUserUserListUserLogin Namespaces Classes Activity ActivityView Admin Badge BadgeList Competence CompetenceCreate CompetenceList CompetenceView Course InputScrollView LearningTemplate Lernreflex Lernreflex lib ListEntryCompetence Loader Menu Model Questions Router SelectList SuperComponent User UserList UserLogin Namespaces _ comp user Ã— Search results Close "},"index.html":{"id":"index.html","title":"Index","body":" Lernreflex Namespaces styles~_styles~compstyles~user Modules styles Classes ActivityActivityViewAdminBadgeBadgeListCompetenceCompetenceCreateCompetenceListCompetenceViewCourseInputScrollViewLearningTemplateLernreflexlibListEntryCompetenceLoaderMenuModelQuestionsRouterSelectListSuperComponentUserUserListUserLogin Ã— Search results Close "},"Activity.html":{"id":"Activity.html","title":"Class: Activity","body":" Lernreflex Namespaces styles~_styles~compstyles~user Modules styles Classes ActivityActivityViewAdminBadgeBadgeListCompetenceCompetenceCreateCompetenceListCompetenceViewCourseInputScrollViewLearningTemplateLernreflexlibListEntryCompetenceLoaderMenuModelQuestionsRouterSelectListSuperComponentUserUserListUserLogin Class: Activity Activity Represents an activity (Model). new Activity(caching) Parameters: Name Type Description caching bool If data can be fetched from cache. Source: models/Activity.js, line 12 Extends Model Methods addUsernameToUrl(url, username) Add the username to an evidence url to make it unique to the user. This is necessary because the activity urls in Moodle are not unique to a user. Parameters: Name Type Description url string Evidence url username string Username Source: models/Activity.js, line 137 Returns: Type string areDone(activities, competenceData, username) Store to every activity in a list of activities if they were done by a user Parameters: Name Type Description activities array A list of activities competenceData object A competence object containing progress.evidence username strting Username Source: models/Activity.js, line 119 Returns: Type array checkDefinition(obj) CHeck if a data object fits to its definition Parameters: Name Type Description obj object Data object Inherited From: Model#checkDefinition Source: models/Model.js, line 210 Returns: Type object clearStorage() Remove all keys and values from AsynStorage. Inherited From: Model#clearStorage Source: models/Model.js, line 289 Returns: Type Promise comment(obj) Save a comment for an activity to the API Parameters: Name Type Description obj object A comment object Source: models/Activity.js, line 69 Returns: Type Promise commentsToView(competenceProgress, activity) Get the comments of an activity from the progress object of a competence Parameters: Name Type Description competenceProgress object A progress object of a competence activity object An activity object Source: models/Activity.js, line 49 Returns: Comments for the given activity Type array fetch(url, req, nocache) Send a request to the API Parameters: Name Type Description url string Url req object Contains the request method, headers and body nocache bool If nothing should be fetched from cache Inherited From: Model#fetch Source: models/Model.js, line 138 Returns: Type Promise generateID(obj) Return the ID of an activity object Parameters: Name Type Description obj object An activity object Source: models/Activity.js, line 201 Returns: ID Type string get(url, params) Send a HTTP GET request to the API Parameters: Name Type Description url string Url params object Query parameters Inherited From: Model#get Source: models/Model.js, line 94 Returns: Type Promise getActivities(competence) Get the activities for a competence from the API Parameters: Name Type Description competence string The competence ID Source: models/Activity.js, line 147 Returns: Type Promise getAllKeys() Get all the keys in the AsynStorage starting with the prefix of this app defined in the constructor. Inherited From: Model#getAllKeys Source: models/Model.js, line 281 Returns: Type Promise getCourseActivities(courseId) Get all the activities from a course. This is only used for the admin. Parameters: Name Type Description courseId string course ID Source: models/Activity.js, line 164 Returns: Type Promise getItem(key, defaultValue, name, time) Get an item from the AsyncStorage Parameters: Name Type Description key string Key defaultValue mixed The default value to return, if nothing is stored under the given key. (Optional) name string A class name (Optional) time bool If the string &quot;_time&quot; is added to the end of the key (Optional) Inherited From: Model#getItem Source: models/Model.js, line 272 Returns: Type Promise getName(key, name) Get the key in the local storage for given key and classname Parameters: Name Type Description key string Key name string A class name (Optional) Inherited From: Model#getName Source: models/Model.js, line 243 Returns: Type Promise isDone(evidence, username) Check if an activity was done by a user Parameters: Name Type Description evidence object An evidence object of a progress object of a competence object username string Username Source: models/Activity.js, line 107 Returns: Type bool isLoggedIn() Check if the current user is logged in. Inherited From: Model#isLoggedIn Source: models/Model.js, line 325 Returns: Type Promise log(d) Log data to the console Parameters: Name Type Description d mixed data to log Inherited From: Model#log Source: models/Model.js, line 316 Returns: Type mixed mapToNumericalKeys(obj) Map an object with non numerical keys to an array Parameters: Name Type Description obj object Object representing a list Inherited From: Model#mapToNumericalKeys Source: models/Model.js, line 298 Returns: Type array mayApplyLocalChanges(list, searchPath, setPath, valueCallback) Check if the value of some variables in the local storage have changed Parameters: Name Type Description list object | array Of objects searchPath string Path inside the object E.g.: '{}.{}.name' to get the name of an object inside an object in the list. setPath string The path inside the object from searchPath, that should be changed. E.g. '-' In the current Object, '--' in the parent object. valueCallback function To be executed for every element found in setPath Inherited From: Model#mayApplyLocalChanges Source: models/Model.js, line 356 Returns: Type Promise post(url, body) Send a HTTP POST request to the API Parameters: Name Type Description url string Url body object Request body Inherited From: Model#post Source: models/Model.js, line 122 Returns: Type Promise put(url, body) Send a HTTP PUT request to the API Parameters: Name Type Description url string Url body object Message body Inherited From: Model#put Source: models/Model.js, line 79 Returns: Type Promise removeLocal(key) Remove key and value from local AsyncStorage Parameters: Name Type Description key string Key to remove Inherited From: Model#removeLocal Source: models/Model.js, line 307 Returns: Type Promise save(obj) Save an activity object to the API Parameters: Name Type Description obj object An activity object that has everything defined in the definition Overrides: Model#save Source: models/Activity.js, line 34 Returns: Type Promise setApi(num) Set the API version for this model. Parameters: Name Type Description num int 0 or 1 Inherited From: Model#setApi Source: models/Model.js, line 64 Returns: Type Promise setItem(key, value, time) Set an item in the AsyncStorage Parameters: Name Type Description key string Key value mixed Value to store for the key time bool If the string &quot;_time&quot; should be added at the end of the key name. This is for storing storing times for certain values. Inherited From: Model#setItem Source: models/Model.js, line 255 Returns: Type Promise setState(key, value) Set the &quot;state&quot; of the model, and store that something has changed. Parameters: Name Type Description key string Key value mixed Value for the key Inherited From: Model#setState Source: models/Model.js, line 335 Returns: Type Promise Ã— Search results Close "},"ActivityView.html":{"id":"ActivityView.html","title":"Class: ActivityView","body":" Lernreflex Namespaces styles~_styles~compstyles~user Modules styles Classes ActivityActivityViewAdminBadgeBadgeListCompetenceCompetenceCreateCompetenceListCompetenceViewCourseInputScrollViewLearningTemplateLernreflexlibListEntryCompetenceLoaderMenuModelQuestionsRouterSelectListSuperComponentUserUserListUserLogin Class: ActivityView ActivityView Represents the view for an activity. new ActivityView() Source: components/ActivityView.js, line 37 Extends React.Component Methods _renderHeadline() Render headline for comments Source: components/ActivityView.js, line 149 Returns: Type ReactNative.Text _renderTabContent() Render comments and feedback input or loading indicator Source: components/ActivityView.js, line 158 Returns: Type array_of_React.Components | Loader _scrollToBottom(refName) Scroll to a component Parameters: Name Type Description refName string ref name of the component Source: components/ActivityView.js, line 241 addComment() Add a comment from the input field to the comments Source: components/ActivityView.js, line 209 componentDidMount() Initialization Source: components/ActivityView.js, line 78 componentWillReceiveProps(nextProps) Executed when this component receives new props. E.g. when the user to view the activity for, changes. Parameters: Name Type Description nextProps object The properties which will change Source: components/ActivityView.js, line 87 componentWillUnmount() Store that the component will unmount, so that the component can't set its state anymore. Source: components/ActivityView.js, line 71 render() Render the activity view Source: components/ActivityView.js, line 273 Returns: Type ReactNative.View renderRow(rowData) Render comment row from ListEntryCompetence component Parameters: Name Type Description rowData object An activity object Source: components/ActivityView.js, line 141 Returns: Type ListEntryCompetence renderUser() Render the username at the top, if it's different than the current user. Source: components/ActivityView.js, line 258 Returns: Type ListEntryCompetence | null setState(input) Override setState from parent to avoid setting the state when the component is not mounted. Parameters: Name Type Description input object A state object Source: components/ActivityView.js, line 62 updateState(nextProps) Update the state of this component from new props Parameters: Name Type Description nextProps object New props Source: components/ActivityView.js, line 120 Ã— Search results Close "},"Admin.html":{"id":"Admin.html","title":"Class: Admin","body":" Lernreflex Namespaces styles~_styles~compstyles~user Modules styles Classes ActivityActivityViewAdminBadgeBadgeListCompetenceCompetenceCreateCompetenceListCompetenceViewCourseInputScrollViewLearningTemplateLernreflexlibListEntryCompetenceLoaderMenuModelQuestionsRouterSelectListSuperComponentUserUserListUserLogin Class: Admin Admin Represents the view for an admin. This is a fallback view to create competences and to link moodle activities and questions to them. Please use moodle to create and link competences and activities. new Admin() Source: components/Admin.js, line 24 Extends React.Component Ã— Search results Close "},"Badge.html":{"id":"Badge.html","title":"Class: Badge","body":" Lernreflex Namespaces styles~_styles~compstyles~user Modules styles Classes ActivityActivityViewAdminBadgeBadgeListCompetenceCompetenceCreateCompetenceListCompetenceViewCourseInputScrollViewLearningTemplateLernreflexlibListEntryCompetenceLoaderMenuModelQuestionsRouterSelectListSuperComponentUserUserListUserLogin Class: Badge Badge Represents an activity. new Badge(caching) Parameters: Name Type Description caching bool If data can be fetched from cache. Source: models/Badge.js, line 12 Extends Model Methods checkDefinition(obj) CHeck if a data object fits to its definition Parameters: Name Type Description obj object Data object Inherited From: Model#checkDefinition Source: models/Model.js, line 210 Returns: Type object clearStorage() Remove all keys and values from AsynStorage. Inherited From: Model#clearStorage Source: models/Model.js, line 289 Returns: Type Promise dummyData() Get dummy data to show as badges Source: models/Badge.js, line 57 fetch(url, req, nocache) Send a request to the API Parameters: Name Type Description url string Url req object Contains the request method, headers and body nocache bool If nothing should be fetched from cache Inherited From: Model#fetch Source: models/Model.js, line 138 Returns: Type Promise generateID(obj) Get the ID of a badge object Parameters: Name Type Description obj object a badge object Source: models/Badge.js, line 22 Returns: Type string get(url, params) Send a HTTP GET request to the API Parameters: Name Type Description url string Url params object Query parameters Inherited From: Model#get Source: models/Model.js, line 94 Returns: Type Promise getAllKeys() Get all the keys in the AsynStorage starting with the prefix of this app defined in the constructor. Inherited From: Model#getAllKeys Source: models/Model.js, line 281 Returns: Type Promise getBadges() Get dummy badges Source: models/Badge.js, line 30 Returns: Type Promise getItem(key, defaultValue, name, time) Get an item from the AsyncStorage Parameters: Name Type Description key string Key defaultValue mixed The default value to return, if nothing is stored under the given key. (Optional) name string A class name (Optional) time bool If the string &quot;_time&quot; is added to the end of the key (Optional) Inherited From: Model#getItem Source: models/Model.js, line 272 Returns: Type Promise getName(key, name) Get the key in the local storage for given key and classname Parameters: Name Type Description key string Key name string A class name (Optional) Inherited From: Model#getName Source: models/Model.js, line 243 Returns: Type Promise getUserBadges() Get user badges from the API Source: models/Badge.js, line 38 Returns: Type Promise hackToFilterBadgesWhichCouldntBeenDeleted(badges) Hack to filter out badges that couldn't been deleted in Moodle, but shouldn't show in the app. Parameters: Name Type Description badges array Badges from the API Source: models/Badge.js, line 47 isLoggedIn() Check if the current user is logged in. Inherited From: Model#isLoggedIn Source: models/Model.js, line 325 Returns: Type Promise log(d) Log data to the console Parameters: Name Type Description d mixed data to log Inherited From: Model#log Source: models/Model.js, line 316 Returns: Type mixed mapToNumericalKeys(obj) Map an object with non numerical keys to an array Parameters: Name Type Description obj object Object representing a list Inherited From: Model#mapToNumericalKeys Source: models/Model.js, line 298 Returns: Type array mayApplyLocalChanges(list, searchPath, setPath, valueCallback) Check if the value of some variables in the local storage have changed Parameters: Name Type Description list object | array Of objects searchPath string Path inside the object E.g.: '{}.{}.name' to get the name of an object inside an object in the list. setPath string The path inside the object from searchPath, that should be changed. E.g. '-' In the current Object, '--' in the parent object. valueCallback function To be executed for every element found in setPath Inherited From: Model#mayApplyLocalChanges Source: models/Model.js, line 356 Returns: Type Promise post(url, body) Send a HTTP POST request to the API Parameters: Name Type Description url string Url body object Request body Inherited From: Model#post Source: models/Model.js, line 122 Returns: Type Promise put(url, body) Send a HTTP PUT request to the API Parameters: Name Type Description url string Url body object Message body Inherited From: Model#put Source: models/Model.js, line 79 Returns: Type Promise removeLocal(key) Remove key and value from local AsyncStorage Parameters: Name Type Description key string Key to remove Inherited From: Model#removeLocal Source: models/Model.js, line 307 Returns: Type Promise save(key, value) Store a value locally Parameters: Name Type Description key string Key value mixed Value to store for the key Inherited From: Model#save Source: models/Model.js, line 233 setApi(num) Set the API version for this model. Parameters: Name Type Description num int 0 or 1 Inherited From: Model#setApi Source: models/Model.js, line 64 Returns: Type Promise setItem(key, value, time) Set an item in the AsyncStorage Parameters: Name Type Description key string Key value mixed Value to store for the key time bool If the string &quot;_time&quot; should be added at the end of the key name. This is for storing storing times for certain values. Inherited From: Model#setItem Source: models/Model.js, line 255 Returns: Type Promise setState(key, value) Set the &quot;state&quot; of the model, and store that something has changed. Parameters: Name Type Description key string Key value mixed Value for the key Inherited From: Model#setState Source: models/Model.js, line 335 Returns: Type Promise Ã— Search results Close "},"BadgeList.html":{"id":"BadgeList.html","title":"Class: BadgeList","body":" Lernreflex Namespaces styles~_styles~compstyles~user Modules styles Classes ActivityActivityViewAdminBadgeBadgeListCompetenceCompetenceCreateCompetenceListCompetenceViewCourseInputScrollViewLearningTemplateLernreflexlibListEntryCompetenceLoaderMenuModelQuestionsRouterSelectListSuperComponentUserUserListUserLogin Class: BadgeList BadgeList Represents the view for the badges. new BadgeList() Source: components/BadgeList.js, line 24 Extends React.Component Methods _onRefresh() Executed on pull to refresh to load badges Source: components/BadgeList.js, line 91 emptyList() Rendered if there are no badges Source: components/BadgeList.js, line 78 loadData(caching) Load Badges from API Parameters: Name Type Default Description caching bool false If badges can be fetched from cache Source: components/BadgeList.js, line 56 render() Render the list with the badges Source: components/BadgeList.js, line 138 renderRow(rowData) Render a badge in a row Parameters: Name Type Description rowData object a badge object Source: components/BadgeList.js, line 124 Returns: Type ListEntryCompetence renderSectionHeader(sectionData, sectionID) Render list section header. Still not implemented. (see React Native ListView docs) Parameters: Name Type Description sectionData object sectionID string Source: components/BadgeList.js, line 114 Ã— Search results Close "},"Competence.html":{"id":"Competence.html","title":"Class: Competence","body":" Lernreflex Namespaces styles~_styles~compstyles~user Modules styles Classes ActivityActivityViewAdminBadgeBadgeListCompetenceCompetenceCreateCompetenceListCompetenceViewCourseInputScrollViewLearningTemplateLernreflexlibListEntryCompetenceLoaderMenuModelQuestionsRouterSelectListSuperComponentUserUserListUserLogin Class: Competence Competence Represents a competence/goal. (Model) The difference between a competence and a goal is, that a goal is a competence, that was not reached yet. new Competence(caching) Parameters: Name Type Description caching bool If data can be fetched from cache. Source: models/Competence.js, line 13 Extends Model Members definition Stub for a competence Source: models/Competence.js, line 28 scales Scales for the self assessment Source: models/Competence.js, line 21 Methods answersToView(competenceData, questions) Changes the format of the answers from the API for use in the app Parameters: Name Type Description competenceData object Competence object with progress with answers questions object List of questions from the server Source: models/Competence.js, line 327 Returns: Type object checkDefinition(obj) CHeck if a data object fits to its definition Parameters: Name Type Description obj object Data object Inherited From: Model#checkDefinition Source: models/Model.js, line 210 Returns: Type object checkHasNewGoalReached(allCompetences, user, type) Check if the number of goals has changed after loading from the server, to see if the user reached a new goal. Parameters: Name Type Description allCompetences object Object containing lists of competences retrieved from the API user object Object containing username type string goals or competences (not used yet) Source: models/Competence.js, line 144 Returns: Type Promise clearStorage() Remove all keys and values from AsynStorage. Inherited From: Model#clearStorage Source: models/Model.js, line 289 Returns: Type Promise countCompetences(competences) Count competences Parameters: Name Type Description competences object Object containing lists of competences Source: models/Competence.js, line 128 Returns: summed number of competences from all lists Type int fetch(url, req, nocache) Send a request to the API Parameters: Name Type Description url string Url req object Contains the request method, headers and body nocache bool If nothing should be fetched from cache Inherited From: Model#fetch Source: models/Model.js, line 138 Returns: Type Promise filterType(competences, type, user) Filters goals OR competences from a list of both Parameters: Name Type Default Description competences object list of competences from the API type string competences goals OR competences user object Object containing the username Source: models/Competence.js, line 195 generateID(obj) Return the ID of a competence object Parameters: Name Type Description obj object competence Source: models/Competence.js, line 61 Returns: Type string get(url, params) Send a HTTP GET request to the API Parameters: Name Type Description url string Url params object Query parameters Inherited From: Model#get Source: models/Model.js, line 94 Returns: Type Promise getAllKeys() Get all the keys in the AsynStorage starting with the prefix of this app defined in the constructor. Inherited From: Model#getAllKeys Source: models/Model.js, line 281 Returns: Type Promise getCompetences() Get the competences for a user from the API Source: models/Competence.js, line 89 Returns: Type Promise getGoals() Get the goals for a user from the API Source: models/Competence.js, line 80 Returns: Type Promise getItem(key, defaultValue, name, time) Get an item from the AsyncStorage Parameters: Name Type Description key string Key defaultValue mixed The default value to return, if nothing is stored under the given key. (Optional) name string A class name (Optional) time bool If the string &quot;_time&quot; is added to the end of the key (Optional) Inherited From: Model#getItem Source: models/Model.js, line 272 Returns: Type Promise getName(key, name) Get the key in the local storage for given key and classname Parameters: Name Type Description key string Key name string A class name (Optional) Inherited From: Model#getName Source: models/Model.js, line 243 Returns: Type Promise getOverview() Get the overview of competences and goals for a user from the API Source: models/Competence.js, line 69 Returns: Type Promise getProgress(username) Get the progress for all the competences of a user. Parameters: Name Type Description username string Source: models/Competence.js, line 234 Returns: Type Promise getQuestions(competenceId) Get the questions for a competence Parameters: Name Type Description competenceId string Id of the competence Source: models/Competence.js, line 282 Returns: Type Promise getSubCompetences(rootCompetence, courseId) Get the sub competences of a competence from the API Parameters: Name Type Default Description rootCompetence object The competenceId courseId string university [university] Source: models/Competence.js, line 482 Returns: Type Promise hasCommentFromOtherUser(competence, username) Check if a user has a comment to an activity of a competence from another user, to see if the competence is done. Parameters: Name Type Description competence object competence with progress username string Source: models/Competence.js, line 217 Returns: Type bool isLoggedIn() Check if the current user is logged in. Inherited From: Model#isLoggedIn Source: models/Model.js, line 325 Returns: Type Promise joinProgressAndCompetences(together, progress) Joins the goals and competences from the API with the progress of the user from the API Parameters: Name Type Description together object Competences from the API progress object Progress from the API Source: models/Competence.js, line 172 Returns: Competences with progress attached Type object log(d) Log data to the console Parameters: Name Type Description d mixed data to log Inherited From: Model#log Source: models/Model.js, line 316 Returns: Type mixed mapToNumericalKeys(obj) Map an object with non numerical keys to an array Parameters: Name Type Description obj object Object representing a list Inherited From: Model#mapToNumericalKeys Source: models/Model.js, line 298 Returns: Type array mayApplyLocalChanges(list, searchPath, setPath, valueCallback) Check if the value of some variables in the local storage have changed Parameters: Name Type Description list object | array Of objects searchPath string Path inside the object E.g.: '{}.{}.name' to get the name of an object inside an object in the list. setPath string The path inside the object from searchPath, that should be changed. E.g. '-' In the current Object, '--' in the parent object. valueCallback function To be executed for every element found in setPath Inherited From: Model#mayApplyLocalChanges Source: models/Model.js, line 356 Returns: Type Promise parseFromTree(d) Parses competences from the server and checks if competences are subcompetences of other competences Parameters: Name Type Description d object Data that should be parsed Source: models/Competence.js, line 386 Returns: Type object post(url, body) Send a HTTP POST request to the API Parameters: Name Type Description url string Url body object Request body Inherited From: Model#post Source: models/Model.js, line 122 Returns: Type Promise progressToView(p) Converts a progress object from the API for the use in the app Parameters: Name Type Description p object progress from the API Source: models/Competence.js, line 258 Returns: Type object put(url, body) Send a HTTP PUT request to the API Parameters: Name Type Description url string Url body object Message body Inherited From: Model#put Source: models/Model.js, line 79 Returns: Type Promise removeLocal(key) Remove key and value from local AsyncStorage Parameters: Name Type Description key string Key to remove Inherited From: Model#removeLocal Source: models/Model.js, line 307 Returns: Type Promise save(obj) Save a competence object to the API Parameters: Name Type Description obj object A competence object that has everything defined in the definition Overrides: Model#save Source: models/Competence.js, line 43 saveAnswers(competenceData, answers) Saves answers to the API Parameters: Name Type Description competenceData object Competence data answers array List of answers Source: models/Competence.js, line 357 Returns: Type Promise saveProgress(p) Saves changes made to the progress (Time or progress changed) of a competence Parameters: Name Type Description p object Progress to save to the API Source: models/Competence.js, line 298 Returns: Type Promise setApi(num) Set the API version for this model. Parameters: Name Type Description num int 0 or 1 Inherited From: Model#setApi Source: models/Model.js, line 64 Returns: Type Promise setItem(key, value, time) Set an item in the AsyncStorage Parameters: Name Type Description key string Key value mixed Value to store for the key time bool If the string &quot;_time&quot; should be added at the end of the key name. This is for storing storing times for certain values. Inherited From: Model#setItem Source: models/Model.js, line 255 Returns: Type Promise setState(key, value) Set the &quot;state&quot; of the model, and store that something has changed. Parameters: Name Type Description key string Key value mixed Value for the key Inherited From: Model#setState Source: models/Model.js, line 335 Returns: Type Promise toIch(name) Change competence string from moodle-plugin-plural-format to Ich-Format Parameters: Name Type Description name string Competence string Source: models/Competence.js, line 456 Returns: Type string toView(comp, type) Returns a mapping or a list of mappings from a data competence object for use in the app Parameters: Name Type Description comp object competence object or list of competence objects from the API type string goals OR competences Source: models/Competence.js, line 429 Returns: Type object treeSubCompetences(d, subs) Get an array of all subCompetences as keys Parameters: Name Type Description d array subs object Source: models/Competence.js, line 412 Returns: Type object Ã— Search results Close "},"CompetenceCreate.html":{"id":"CompetenceCreate.html","title":"Class: CompetenceCreate","body":" Lernreflex Namespaces styles~_styles~compstyles~user Modules styles Classes ActivityActivityViewAdminBadgeBadgeListCompetenceCompetenceCreateCompetenceListCompetenceViewCourseInputScrollViewLearningTemplateLernreflexlibListEntryCompetenceLoaderMenuModelQuestionsRouterSelectListSuperComponentUserUserListUserLogin Class: CompetenceCreate CompetenceCreate Represents the view to create a competence. new CompetenceCreate() Source: components/CompetenceCreate.js, line 36 Extends React.Component Methods _renderButton() Render the Create button Source: components/CompetenceCreate.js, line 196 Returns: Type ReactNative.View | ReactNative.TouchableHighlight _renderSuperCompetence() Render at the the title of the super competence, if the competence is created as a sub competence Source: components/CompetenceCreate.js, line 210 Returns: Type ReactNative.Text | null _renderTags(tags) Render the tags Parameters: Name Type Description tags array list of the tags Source: components/CompetenceCreate.js, line 171 Returns: Type array_of_ReactNative.TouchableHighlight _scrollToBottom(refName) Scroll to a component Parameters: Name Type Description refName string ref name of the component Source: components/CompetenceCreate.js, line 230 addTag() Add a tag to the list from the input Source: components/CompetenceCreate.js, line 152 createCompetence() Create the competence with the input data and store it to the API. Source: components/CompetenceCreate.js, line 51 getVerbs() Get the list of verbs Source: components/CompetenceCreate.js, line 220 Returns: Type array removeTag() Remove a tag Source: components/CompetenceCreate.js, line 144 render() Render the competence create view Source: components/CompetenceCreate.js, line 271 Returns: Type ReactNative.View saveQuestions(competenceId) Save the default reflection questions to the competence Parameters: Name Type Description competenceId string Source: components/CompetenceCreate.js, line 112 selectPressed() Executed when the select an action button is pressed Source: components/CompetenceCreate.js, line 247 Ã— Search results Close "},"CompetenceList.html":{"id":"CompetenceList.html","title":"Class: CompetenceList","body":" Lernreflex Namespaces styles~_styles~compstyles~user Modules styles Classes ActivityActivityViewAdminBadgeBadgeListCompetenceCompetenceCreateCompetenceListCompetenceViewCourseInputScrollViewLearningTemplateLernreflexlibListEntryCompetenceLoaderMenuModelQuestionsRouterSelectListSuperComponentUserUserListUserLogin Class: CompetenceList CompetenceList Represents the view for a list of competences. If the type = &quot;competences&quot; is passed as a prop, the list contains users competences. If type = &quot;goals&quot; is passed as a prop, the list contains users goals. new CompetenceList() Source: components/CompetenceList.js, line 29 Extends React.Component Methods _onRefresh() Executed on pull to refresh to reload competences Source: components/CompetenceList.js, line 342 afterCompetenceCreate() Reaload competence after a new competence was created Source: components/CompetenceList.js, line 71 competencesToView() Converts the returned data into displayable data Source: components/CompetenceList.js, line 123 componentWillReceiveProps() Executed when the component receives new props Source: components/CompetenceList.js, line 79 emptyList() Display message if there are no competences/goals Source: components/CompetenceList.js, line 161 getDatasource() Get the data formatted for the list view datasource Source: components/CompetenceList.js, line 153 getRowData(dataBlob, sectionID, rowID) Get the data for a certain row of the list view Parameters: Name Type Description dataBlob object sectionID string section ID rowID string row ID Source: components/CompetenceList.js, line 294 getSectionData(dataBlob, sectionID) Get the data for a certain section of the list view Parameters: Name Type Description dataBlob object sectionID string section ID Source: components/CompetenceList.js, line 284 loadData(caching, receivingProps) Load the data from the API Parameters: Name Type Default Description caching bool true If the data can be fetched from cache receivingProps bool false If action was triggered by receiving props Source: components/CompetenceList.js, line 179 render() Render the list of the competences/goals Source: components/CompetenceList.js, line 349 renderRow(rowData) Render a competence in a list Parameters: Name Type Description rowData object Source: components/CompetenceList.js, line 329 Returns: Type ListEntryCompetence renderSectionHeader(rowData, id) Render the header of a section Parameters: Name Type Description rowData object id string row ID Source: components/CompetenceList.js, line 303 rowPressed(rowData) Executed when a competence/goal is pressed Parameters: Name Type Description rowData object Competence data Source: components/CompetenceList.js, line 242 updateChanges() Updates the list if the progress of competence was changed Source: components/CompetenceList.js, line 96 Ã— Search results Close "},"CompetenceView.html":{"id":"CompetenceView.html","title":"Class: CompetenceView","body":" Lernreflex Namespaces styles~_styles~compstyles~user Modules styles Classes ActivityActivityViewAdminBadgeBadgeListCompetenceCompetenceCreateCompetenceListCompetenceViewCourseInputScrollViewLearningTemplateLernreflexlibListEntryCompetenceLoaderMenuModelQuestionsRouterSelectListSuperComponentUserUserListUserLogin Class: CompetenceView CompetenceView Represents the view for a competence/goal. new CompetenceView() Source: components/CompetenceView.js, line 37 Extends React.Component Methods _renderAssessment() Render the self assessment section for progress and time Source: components/CompetenceView.js, line 192 _renderSlider() Render the slider for self assessment of progress and time Source: components/CompetenceView.js, line 351 _renderTabContent() Render content of activity tab and subcompetences tab Source: components/CompetenceView.js, line 315 _renderTabs() Render the buttons for activities and sub subcompetences Source: components/CompetenceView.js, line 264 _wrapRow() Wrap an element in row markup to have a clear layout. Source: components/CompetenceView.js, line 293 componentWillReceiveProps(nextProps) Executed when the component receives props Parameters: Name Type Description nextProps object Source: components/CompetenceView.js, line 83 loadData() Load competence data, activities, questions and sub competences Source: components/CompetenceView.js, line 160 loadUser(nextProps) Load the competence for a certain user. Executed when receiving props. Parameters: Name Type Description nextProps object Props that are passed to this component Source: components/CompetenceView.js, line 91 render() Render the competence view Source: components/CompetenceView.js, line 483 renderRow() Render an activity or subcompetence row Source: components/CompetenceView.js, line 455 renderUser() Render the user at the top, if different from the current Source: components/CompetenceView.js, line 468 rowPressed() Executed when an activity or subsompetence is tapped Source: components/CompetenceView.js, line 419 showQuestions() Navigate to the reflective questions Source: components/CompetenceView.js, line 400 subCompName() Get the name for sub goal or sub competence Source: components/CompetenceView.js, line 255 updateProgress() Update the progress when changed with the slider Source: components/CompetenceView.js, line 376 updateState(props) Update the state depending on the new props received Parameters: Name Type Description props object Source: components/CompetenceView.js, line 126 Ã— Search results Close "},"Course.html":{"id":"Course.html","title":"Class: Course","body":" Lernreflex Namespaces styles~_styles~compstyles~user Modules styles Classes ActivityActivityViewAdminBadgeBadgeListCompetenceCompetenceCreateCompetenceListCompetenceViewCourseInputScrollViewLearningTemplateLernreflexlibListEntryCompetenceLoaderMenuModelQuestionsRouterSelectListSuperComponentUserUserListUserLogin Class: Course Course Represents a course. This class is not used except for the admin. The overview from API for the competences contains the courses for the user new Course(caching) Parameters: Name Type Description caching bool If data can be fetched from cache. Source: models/Course.js, line 12 Extends Model Methods checkDefinition(obj) CHeck if a data object fits to its definition Parameters: Name Type Description obj object Data object Inherited From: Model#checkDefinition Source: models/Model.js, line 210 Returns: Type object clearStorage() Remove all keys and values from AsynStorage. Inherited From: Model#clearStorage Source: models/Model.js, line 289 Returns: Type Promise fetch(url, req, nocache) Send a request to the API Parameters: Name Type Description url string Url req object Contains the request method, headers and body nocache bool If nothing should be fetched from cache Inherited From: Model#fetch Source: models/Model.js, line 138 Returns: Type Promise get(url, params) Send a HTTP GET request to the API Parameters: Name Type Description url string Url params object Query parameters Inherited From: Model#get Source: models/Model.js, line 94 Returns: Type Promise getAllKeys() Get all the keys in the AsynStorage starting with the prefix of this app defined in the constructor. Inherited From: Model#getAllKeys Source: models/Model.js, line 281 Returns: Type Promise getItem(key, defaultValue, name, time) Get an item from the AsyncStorage Parameters: Name Type Description key string Key defaultValue mixed The default value to return, if nothing is stored under the given key. (Optional) name string A class name (Optional) time bool If the string &quot;_time&quot; is added to the end of the key (Optional) Inherited From: Model#getItem Source: models/Model.js, line 272 Returns: Type Promise getName(key, name) Get the key in the local storage for given key and classname Parameters: Name Type Description key string Key name string A class name (Optional) Inherited From: Model#getName Source: models/Model.js, line 243 Returns: Type Promise isLoggedIn() Check if the current user is logged in. Inherited From: Model#isLoggedIn Source: models/Model.js, line 325 Returns: Type Promise log(d) Log data to the console Parameters: Name Type Description d mixed data to log Inherited From: Model#log Source: models/Model.js, line 316 Returns: Type mixed mapToNumericalKeys(obj) Map an object with non numerical keys to an array Parameters: Name Type Description obj object Object representing a list Inherited From: Model#mapToNumericalKeys Source: models/Model.js, line 298 Returns: Type array mayApplyLocalChanges(list, searchPath, setPath, valueCallback) Check if the value of some variables in the local storage have changed Parameters: Name Type Description list object | array Of objects searchPath string Path inside the object E.g.: '{}.{}.name' to get the name of an object inside an object in the list. setPath string The path inside the object from searchPath, that should be changed. E.g. '-' In the current Object, '--' in the parent object. valueCallback function To be executed for every element found in setPath Inherited From: Model#mayApplyLocalChanges Source: models/Model.js, line 356 Returns: Type Promise post(url, body) Send a HTTP POST request to the API Parameters: Name Type Description url string Url body object Request body Inherited From: Model#post Source: models/Model.js, line 122 Returns: Type Promise put(url, body) Send a HTTP PUT request to the API Parameters: Name Type Description url string Url body object Message body Inherited From: Model#put Source: models/Model.js, line 79 Returns: Type Promise removeLocal(key) Remove key and value from local AsyncStorage Parameters: Name Type Description key string Key to remove Inherited From: Model#removeLocal Source: models/Model.js, line 307 Returns: Type Promise save(key, value) Store a value locally Parameters: Name Type Description key string Key value mixed Value to store for the key Inherited From: Model#save Overrides: Model#save Source: models/Model.js, line 233 setApi(num) Set the API version for this model. Parameters: Name Type Description num int 0 or 1 Inherited From: Model#setApi Source: models/Model.js, line 64 Returns: Type Promise setItem(key, value, time) Set an item in the AsyncStorage Parameters: Name Type Description key string Key value mixed Value to store for the key time bool If the string &quot;_time&quot; should be added at the end of the key name. This is for storing storing times for certain values. Inherited From: Model#setItem Source: models/Model.js, line 255 Returns: Type Promise setState(key, value) Set the &quot;state&quot; of the model, and store that something has changed. Parameters: Name Type Description key string Key value mixed Value for the key Inherited From: Model#setState Source: models/Model.js, line 335 Returns: Type Promise Ã— Search results Close "},"InputScrollView.html":{"id":"InputScrollView.html","title":"Class: InputScrollView","body":" Lernreflex Namespaces styles~_styles~compstyles~user Modules styles Classes ActivityActivityViewAdminBadgeBadgeListCompetenceCompetenceCreateCompetenceListCompetenceViewCourseInputScrollViewLearningTemplateLernreflexlibListEntryCompetenceLoaderMenuModelQuestionsRouterSelectListSuperComponentUserUserListUserLogin Class: InputScrollView InputScrollView Used in iOS to allow scrolling and tapping only once to change the input field. Can be used analogously to a ScrollView. new InputScrollView() Source: components/InputScrollView.js, line 19 Extends React.Component Ã— Search results Close "},"LearningTemplate.html":{"id":"LearningTemplate.html","title":"Class: LearningTemplate","body":" Lernreflex Namespaces styles~_styles~compstyles~user Modules styles Classes ActivityActivityViewAdminBadgeBadgeListCompetenceCompetenceCreateCompetenceListCompetenceViewCourseInputScrollViewLearningTemplateLernreflexlibListEntryCompetenceLoaderMenuModelQuestionsRouterSelectListSuperComponentUserUserListUserLogin Class: LearningTemplate LearningTemplate Represents a learningtempalte. (Model) new LearningTemplate(caching) Parameters: Name Type Description caching bool If data can be fetched from cache. Source: models/LearningTemplate.js, line 11 Extends Model Methods checkDefinition(obj) CHeck if a data object fits to its definition Parameters: Name Type Description obj object Data object Inherited From: Model#checkDefinition Source: models/Model.js, line 210 Returns: Type object clearStorage() Remove all keys and values from AsynStorage. Inherited From: Model#clearStorage Source: models/Model.js, line 289 Returns: Type Promise fetch(url, req, nocache) Send a request to the API Parameters: Name Type Description url string Url req object Contains the request method, headers and body nocache bool If nothing should be fetched from cache Inherited From: Model#fetch Source: models/Model.js, line 138 Returns: Type Promise generateID(obj) Return the ID of a learning template object. Parameters: Name Type Description obj string Source: models/LearningTemplate.js, line 45 get(url, params) Send a HTTP GET request to the API Parameters: Name Type Description url string Url params object Query parameters Inherited From: Model#get Source: models/Model.js, line 94 Returns: Type Promise getAllKeys() Get all the keys in the AsynStorage starting with the prefix of this app defined in the constructor. Inherited From: Model#getAllKeys Source: models/Model.js, line 281 Returns: Type Promise getItem(key, defaultValue, name, time) Get an item from the AsyncStorage Parameters: Name Type Description key string Key defaultValue mixed The default value to return, if nothing is stored under the given key. (Optional) name string A class name (Optional) time bool If the string &quot;_time&quot; is added to the end of the key (Optional) Inherited From: Model#getItem Source: models/Model.js, line 272 Returns: Type Promise getLearningTemplates(params) Load the learning templates of user. Is not used anymore. Could be used to make suggestions for the learning template, when creating a competence. Parameters: Name Type Description params object Source: models/LearningTemplate.js, line 54 getName(key, name) Get the key in the local storage for given key and classname Parameters: Name Type Description key string Key name string A class name (Optional) Inherited From: Model#getName Source: models/Model.js, line 243 Returns: Type Promise isLoggedIn() Check if the current user is logged in. Inherited From: Model#isLoggedIn Source: models/Model.js, line 325 Returns: Type Promise log(d) Log data to the console Parameters: Name Type Description d mixed data to log Inherited From: Model#log Source: models/Model.js, line 316 Returns: Type mixed mapToNumericalKeys(obj) Map an object with non numerical keys to an array Parameters: Name Type Description obj object Object representing a list Inherited From: Model#mapToNumericalKeys Source: models/Model.js, line 298 Returns: Type array mayApplyLocalChanges(list, searchPath, setPath, valueCallback) Check if the value of some variables in the local storage have changed Parameters: Name Type Description list object | array Of objects searchPath string Path inside the object E.g.: '{}.{}.name' to get the name of an object inside an object in the list. setPath string The path inside the object from searchPath, that should be changed. E.g. '-' In the current Object, '--' in the parent object. valueCallback function To be executed for every element found in setPath Inherited From: Model#mayApplyLocalChanges Source: models/Model.js, line 356 Returns: Type Promise post(url, body) Send a HTTP POST request to the API Parameters: Name Type Description url string Url body object Request body Inherited From: Model#post Source: models/Model.js, line 122 Returns: Type Promise put(url, body) Send a HTTP PUT request to the API Parameters: Name Type Description url string Url body object Message body Inherited From: Model#put Source: models/Model.js, line 79 Returns: Type Promise removeLocal(key) Remove key and value from local AsyncStorage Parameters: Name Type Description key string Key to remove Inherited From: Model#removeLocal Source: models/Model.js, line 307 Returns: Type Promise save(obj) Save a learning template. Parameters: Name Type Description obj object Containing the properties from the definition. Overrides: Model#save Source: models/LearningTemplate.js, line 28 Returns: Type Promise setApi(num) Set the API version for this model. Parameters: Name Type Description num int 0 or 1 Inherited From: Model#setApi Source: models/Model.js, line 64 Returns: Type Promise setItem(key, value, time) Set an item in the AsyncStorage Parameters: Name Type Description key string Key value mixed Value to store for the key time bool If the string &quot;_time&quot; should be added at the end of the key name. This is for storing storing times for certain values. Inherited From: Model#setItem Source: models/Model.js, line 255 Returns: Type Promise setState(key, value) Set the &quot;state&quot; of the model, and store that something has changed. Parameters: Name Type Description key string Key value mixed Value for the key Inherited From: Model#setState Source: models/Model.js, line 335 Returns: Type Promise Ã— Search results Close "},"Lernreflex.html":{"id":"Lernreflex.html","title":"Class: Lernreflex","body":" Lernreflex Namespaces styles~_styles~compstyles~user Modules styles Classes ActivityActivityViewAdminBadgeBadgeListCompetenceCompetenceCreateCompetenceListCompetenceViewCourseInputScrollViewLearningTemplateLernreflexlibListEntryCompetenceLoaderMenuModelQuestionsRouterSelectListSuperComponentUserUserListUserLogin Class: Lernreflex Lernreflex Starting point for view for Lernreflex for Android new Lernreflex() Source: index.android.js, line 39 Extends React.Component Class: Lernreflex Lernreflex Starting point for view for Lernreflex for iOS new Lernreflex() Source: index.ios.js, line 33 Extends React.Component Ã— Search results Close "},"lib.html":{"id":"lib.html","title":"Class: lib","body":" Lernreflex Namespaces styles~_styles~compstyles~user Modules styles Classes ActivityActivityViewAdminBadgeBadgeListCompetenceCompetenceCreateCompetenceListCompetenceViewCourseInputScrollViewLearningTemplateLernreflexlibListEntryCompetenceLoaderMenuModelQuestionsRouterSelectListSuperComponentUserUserListUserLogin Class: lib lib new lib() Source: lib.js, line 1 Ã— Search results Close "},"ListEntryCompetence.html":{"id":"ListEntryCompetence.html","title":"Class: ListEntryCompetence","body":" Lernreflex Namespaces styles~_styles~compstyles~user Modules styles Classes ActivityActivityViewAdminBadgeBadgeListCompetenceCompetenceCreateCompetenceListCompetenceViewCourseInputScrollViewLearningTemplateLernreflexlibListEntryCompetenceLoaderMenuModelQuestionsRouterSelectListSuperComponentUserUserListUserLogin Class: ListEntryCompetence ListEntryCompetence Holds the markup for several list elements ocurring on different views in this app. To render a row, you need to pass a property rowData containing type = {one of the possible function names} without a leading _ In the future the markup for a row could be transfered back into the belonging class, to make things more consistent new ListEntryCompetence() Source: components/ListEntryCompetence.js, line 27 Extends React.Component Methods _activity() Markup for activity row Source: components/ListEntryCompetence.js, line 124 Returns: Type ReactNative.View _badge() Markup for badge row Source: components/ListEntryCompetence.js, line 54 Returns: Type ReactNative.View _comment() Markup for comment row Source: components/ListEntryCompetence.js, line 83 Returns: Type ReactNative.View _competence() Markup for competence row Source: components/ListEntryCompetence.js, line 104 Returns: Type ReactNative.View _currentUser() Markup for user, at the top of a view, if it's different than the current user. Source: components/ListEntryCompetence.js, line 169 Returns: Type ReactNative.View _select() Markup for select list row Source: components/ListEntryCompetence.js, line 149 Returns: Type ReactNative.View _user() Markup for user row Source: components/ListEntryCompetence.js, line 36 Returns: Type ReactNative.View render() Render row by props.rowData.type Source: components/ListEntryCompetence.js, line 182 Returns: Type React.Component Ã— Search results Close "},"Loader.html":{"id":"Loader.html","title":"Class: Loader","body":" Lernreflex Namespaces styles~_styles~compstyles~user Modules styles Classes ActivityActivityViewAdminBadgeBadgeListCompetenceCompetenceCreateCompetenceListCompetenceViewCourseInputScrollViewLearningTemplateLernreflexlibListEntryCompetenceLoaderMenuModelQuestionsRouterSelectListSuperComponentUserUserListUserLogin Class: Loader Loader A loading indicator. new Loader() Source: components/Loader.js, line 18 Extends React.Component Methods render() Render the loader. color and top can be passed as props. Source: components/Loader.js, line 26 styler(top) Generate a style for the loader Parameters: Name Type Description top int top margin for the loader Source: components/Loader.js, line 36 Ã— Search results Close "},"Menu.html":{"id":"Menu.html","title":"Class: Menu","body":" Lernreflex Namespaces styles~_styles~compstyles~user Modules styles Classes ActivityActivityViewAdminBadgeBadgeListCompetenceCompetenceCreateCompetenceListCompetenceViewCourseInputScrollViewLearningTemplateLernreflexlibListEntryCompetenceLoaderMenuModelQuestionsRouterSelectListSuperComponentUserUserListUserLogin Class: Menu Menu Represents the view for the menu. new Menu() Source: components/Menu.js, line 21 Extends React.Component Methods render() Render the whole menu Source: components/Menu.js, line 89 Returns: Type ReactNative.View renderRow() Renders menu entry Source: components/Menu.js, line 70 Returns: Type ReactNative.TouchableHighlight rowPressed() Executed when menu entry is pressed Source: components/Menu.js, line 58 Ã— Search results Close "},"Model.html":{"id":"Model.html","title":"Class: Model","body":" Lernreflex Namespaces styles~_styles~compstyles~user Modules styles Classes ActivityActivityViewAdminBadgeBadgeListCompetenceCompetenceCreateCompetenceListCompetenceViewCourseInputScrollViewLearningTemplateLernreflexlibListEntryCompetenceLoaderMenuModelQuestionsRouterSelectListSuperComponentUserUserListUserLogin Class: Model Model Represents a model. All models inherit from this class. It handles the communication to the server and the caching and storing of the data locally. The handling of local storage and global state should be implemented in the future with the REDUX Framework. Local storage and AsyncStorage are used here as a synonym. new Model(className, caching) Parameters: Name Type Description className string The name of the object class. caching bool If data can be fetched from cache. Source: models/Model.js, line 20 Methods checkDefinition(obj) CHeck if a data object fits to its definition Parameters: Name Type Description obj object Data object Source: models/Model.js, line 210 Returns: Type object clearStorage() Remove all keys and values from AsynStorage. Source: models/Model.js, line 289 Returns: Type Promise fetch(url, req, nocache) Send a request to the API Parameters: Name Type Description url string Url req object Contains the request method, headers and body nocache bool If nothing should be fetched from cache Source: models/Model.js, line 138 Returns: Type Promise get(url, params) Send a HTTP GET request to the API Parameters: Name Type Description url string Url params object Query parameters Source: models/Model.js, line 94 Returns: Type Promise getAllKeys() Get all the keys in the AsynStorage starting with the prefix of this app defined in the constructor. Source: models/Model.js, line 281 Returns: Type Promise getItem(key, defaultValue, name, time) Get an item from the AsyncStorage Parameters: Name Type Description key string Key defaultValue mixed The default value to return, if nothing is stored under the given key. (Optional) name string A class name (Optional) time bool If the string &quot;_time&quot; is added to the end of the key (Optional) Source: models/Model.js, line 272 Returns: Type Promise getName(key, name) Get the key in the local storage for given key and classname Parameters: Name Type Description key string Key name string A class name (Optional) Source: models/Model.js, line 243 Returns: Type Promise isLoggedIn() Check if the current user is logged in. Source: models/Model.js, line 325 Returns: Type Promise log(d) Log data to the console Parameters: Name Type Description d mixed data to log Source: models/Model.js, line 316 Returns: Type mixed mapToNumericalKeys(obj) Map an object with non numerical keys to an array Parameters: Name Type Description obj object Object representing a list Source: models/Model.js, line 298 Returns: Type array mayApplyLocalChanges(list, searchPath, setPath, valueCallback) Check if the value of some variables in the local storage have changed Parameters: Name Type Description list object | array Of objects searchPath string Path inside the object E.g.: '{}.{}.name' to get the name of an object inside an object in the list. setPath string The path inside the object from searchPath, that should be changed. E.g. '-' In the current Object, '--' in the parent object. valueCallback function To be executed for every element found in setPath Source: models/Model.js, line 356 Returns: Type Promise post(url, body) Send a HTTP POST request to the API Parameters: Name Type Description url string Url body object Request body Source: models/Model.js, line 122 Returns: Type Promise put(url, body) Send a HTTP PUT request to the API Parameters: Name Type Description url string Url body object Message body Source: models/Model.js, line 79 Returns: Type Promise removeLocal(key) Remove key and value from local AsyncStorage Parameters: Name Type Description key string Key to remove Source: models/Model.js, line 307 Returns: Type Promise save(key, value) Store a value locally Parameters: Name Type Description key string Key value mixed Value to store for the key Source: models/Model.js, line 233 setApi(num) Set the API version for this model. Parameters: Name Type Description num int 0 or 1 Source: models/Model.js, line 64 Returns: Type Promise setItem(key, value, time) Set an item in the AsyncStorage Parameters: Name Type Description key string Key value mixed Value to store for the key time bool If the string &quot;_time&quot; should be added at the end of the key name. This is for storing storing times for certain values. Source: models/Model.js, line 255 Returns: Type Promise setState(key, value) Set the &quot;state&quot; of the model, and store that something has changed. Parameters: Name Type Description key string Key value mixed Value for the key Source: models/Model.js, line 335 Returns: Type Promise Ã— Search results Close "},"module-styles.html":{"id":"module-styles.html","title":"Module: styles","body":" Lernreflex Namespaces styles~_styles~compstyles~user Modules styles Classes ActivityActivityViewAdminBadgeBadgeListCompetenceCompetenceCreateCompetenceListCompetenceViewCourseInputScrollViewLearningTemplateLernreflexlibListEntryCompetenceLoaderMenuModelQuestionsRouterSelectListSuperComponentUserUserListUserLogin Module: styles Source: styles.js, line 2 Namespaces _ comp user Ã— Search results Close "},"module-styles-_.html":{"id":"module-styles-_.html","title":"Namespace: _","body":" Lernreflex Namespaces styles~_styles~compstyles~user Modules styles Classes ActivityActivityViewAdminBadgeBadgeListCompetenceCompetenceCreateCompetenceListCompetenceViewCourseInputScrollViewLearningTemplateLernreflexlibListEntryCompetenceLoaderMenuModelQuestionsRouterSelectListSuperComponentUserUserListUserLogin Namespace: _ styles~ _ Contains the general styles and often used colors for consistency. Source: styles.js, line 25 Members &lt;static&gt; bg Contains the background color of the content Source: styles.js, line 173 &lt;static&gt; hoverBtn Contains the color of a tapped button Source: styles.js, line 169 &lt;static&gt; navBg Contains the background color for the navigation on top Source: styles.js, line 163 &lt;static&gt; navBtnColor Contains the primary background color of the buttons in the tab bar Source: styles.js, line 167 &lt;static&gt; navColor Contains the background color of the tab bar at the bottom Source: styles.js, line 165 &lt;static&gt; primary Contains the primary background color Source: styles.js, line 153 &lt;static&gt; primaryBrighter Contains the primary background color brighter Source: styles.js, line 155 &lt;static&gt; primaryDarker Contains the primary background color darker Source: styles.js, line 157 &lt;static&gt; secondary Contains the secondary color Source: styles.js, line 159 &lt;static&gt; secondaryBrighter Contains the secondary color brighter Source: styles.js, line 161 &lt;static&gt; tabIconColor Contains the color of the icons in the tabbar Source: styles.js, line 171 &lt;static&gt; text Contains the default text color Source: styles.js, line 175 Ã— Search results Close "},"module-styles-comp.html":{"id":"module-styles-comp.html","title":"Namespace: comp","body":" Lernreflex Namespaces styles~_styles~compstyles~user Modules styles Classes ActivityActivityViewAdminBadgeBadgeListCompetenceCompetenceCreateCompetenceListCompetenceViewCourseInputScrollViewLearningTemplateLernreflexlibListEntryCompetenceLoaderMenuModelQuestionsRouterSelectListSuperComponentUserUserListUserLogin Namespace: comp styles~ comp Contains the competence styles Source: styles.js, line 224 Ã— Search results Close "},"module-styles-user.html":{"id":"module-styles-user.html","title":"Namespace: user","body":" Lernreflex Namespaces styles~_styles~compstyles~user Modules styles Classes ActivityActivityViewAdminBadgeBadgeListCompetenceCompetenceCreateCompetenceListCompetenceViewCourseInputScrollViewLearningTemplateLernreflexlibListEntryCompetenceLoaderMenuModelQuestionsRouterSelectListSuperComponentUserUserListUserLogin Namespace: user styles~ user Contains the user styles Source: styles.js, line 341 Ã— Search results Close "},"Questions.html":{"id":"Questions.html","title":"Class: Questions","body":" Lernreflex Namespaces styles~_styles~compstyles~user Modules styles Classes ActivityActivityViewAdminBadgeBadgeListCompetenceCompetenceCreateCompetenceListCompetenceViewCourseInputScrollViewLearningTemplateLernreflexlibListEntryCompetenceLoaderMenuModelQuestionsRouterSelectListSuperComponentUserUserListUserLogin Class: Questions Questions Represents the view for the reflective questions for a competence. new Questions() Source: components/Questions.js, line 36 Extends SuperComponent Methods changeMode(mode, currentRow) Change the view from a list of questions to the single question/answer view, and vice versa Parameters: Name Type Description mode int 0 or 1, 1 is the mode for answering questions one by one, 0 shows a list currentRow int The current question index Source: components/Questions.js, line 196 changeQuestion(dir) Navigate to next or previous question Parameters: Name Type Description dir string previous or next Source: components/Questions.js, line 227 enterButtonPressed(text, ref, nextRef) Check if a new line button was pressed on the keyboard in a text input. Parameters: Name Type Description text string The current text in the input to check for new lines. ref string ref name of the current input nextRef string ref name of the next input in order. Inherited From: SuperComponent#enterButtonPressed Source: components/SuperComponent.js, line 54 Returns: Type bool getMaxAnswers() Get the numbers of questions the user has answered for a competence + 1. Source: components/Questions.js, line 69 Returns: Type int inputFocused(refName) Scroll a component into view. Parameters: Name Type Description refName string the component ref string. Source: components/Questions.js, line 137 render() Render the view of the reflection questions of a competence Source: components/Questions.js, line 372 renderCompetence() Render the competence title Source: components/Questions.js, line 171 Returns: Type ReactNative.View renderCurrentRow(rowData) Render the current question in answering mode Parameters: Name Type Description rowData object question data Source: components/Questions.js, line 253 renderRow(rowData) Render question in list view Parameters: Name Type Description rowData object question data Source: components/Questions.js, line 314 renderUser() Render current user at the top, if different from the current one Source: components/Questions.js, line 155 saveAnswers(q) Save the answers to a question Parameters: Name Type Description q string question ID Source: components/Questions.js, line 108 setCurrentFocus() Set the focus to the current answer input field Source: components/Questions.js, line 181 setQuestions() Set the questions for the view by the props Source: components/Questions.js, line 82 wasAnswered(top) Check if a question was answered Parameters: Name Type Description top int top margin for the loader Source: components/Questions.js, line 219 Ã— Search results Close "},"Router.html":{"id":"Router.html","title":"Class: Router","body":" Lernreflex Namespaces styles~_styles~compstyles~user Modules styles Classes ActivityActivityViewAdminBadgeBadgeListCompetenceCompetenceCreateCompetenceListCompetenceViewCourseInputScrollViewLearningTemplateLernreflexlibListEntryCompetenceLoaderMenuModelQuestionsRouterSelectListSuperComponentUserUserListUserLogin Class: Router Router new Router() Provides functions for routing in a navigator and contains some of the app's global variables Source: Router.js, line 4 Methods &lt;static&gt; renderRoute(route, navigator) Render the route.component Parameters: Name Type Description route object Contains component class and props for target view. navigator ReactNative.Navigator | ReactNative.NavigatorIOS Source: Router.js, line 106 &lt;static&gt; route(route, navigator, params) Route to a new view Parameters: Name Type Description route object Contains component class and props for target view. navigator ReactNative.Navigator | ReactNative.NavigatorIOS params object Object with params to change the routing function (see bottom of this function for use) Source: Router.js, line 29 Ã— Search results Close "},"SelectList.html":{"id":"SelectList.html","title":"Class: SelectList","body":" Lernreflex Namespaces styles~_styles~compstyles~user Modules styles Classes ActivityActivityViewAdminBadgeBadgeListCompetenceCompetenceCreateCompetenceListCompetenceViewCourseInputScrollViewLearningTemplateLernreflexlibListEntryCompetenceLoaderMenuModelQuestionsRouterSelectListSuperComponentUserUserListUserLogin Class: SelectList SelectList Represents the view for a filterable select list. new SelectList() Source: components/SelectList.js, line 34 Extends React.Component Methods _scrollToBottom(refName) Scroll to a component Parameters: Name Type Description refName string ref name of the component Source: components/SelectList.js, line 107 filterElements(filter) Filter the elements of the list by an input search query Parameters: Name Type Description filter string search string Source: components/SelectList.js, line 65 render() Render the input filter and the list Source: components/SelectList.js, line 143 renderList() Render the list of entries Source: components/SelectList.js, line 124 renderRow(rowData) Render the entries of the select list Parameters: Name Type Description rowData object Row data Source: components/SelectList.js, line 84 Returns: Type ListEntryCompetence rowPressed(rowData) Executed when an item in the list is selected. Returns the navigator to the previous view. Parameters: Name Type Description rowData object Row data Source: components/SelectList.js, line 97 Ã— Search results Close "},"SuperComponent.html":{"id":"SuperComponent.html","title":"Class: SuperComponent","body":" Lernreflex Namespaces styles~_styles~compstyles~user Modules styles Classes ActivityActivityViewAdminBadgeBadgeListCompetenceCompetenceCreateCompetenceListCompetenceViewCourseInputScrollViewLearningTemplateLernreflexlibListEntryCompetenceLoaderMenuModelQuestionsRouterSelectListSuperComponentUserUserListUserLogin Class: SuperComponent SuperComponent Represents a generic Component class that holds functions needed in several other classes. new SuperComponent(props) Parameters: Name Type Description props object The properties of the component Source: components/SuperComponent.js, line 31 Extends React.Component Methods enterButtonPressed(text, ref, nextRef) Check if a new line button was pressed on the keyboard in a text input. Parameters: Name Type Description text string The current text in the input to check for new lines. ref string ref name of the current input nextRef string ref name of the next input in order. Source: components/SuperComponent.js, line 54 Returns: Type bool Ã— Search results Close "},"User.html":{"id":"User.html","title":"Class: User","body":" Lernreflex Namespaces styles~_styles~compstyles~user Modules styles Classes ActivityActivityViewAdminBadgeBadgeListCompetenceCompetenceCreateCompetenceListCompetenceViewCourseInputScrollViewLearningTemplateLernreflexlibListEntryCompetenceLoaderMenuModelQuestionsRouterSelectListSuperComponentUserUserListUserLogin Class: User User Represents a user. new User(caching) Parameters: Name Type Description caching bool If data can be fetched from cache. Source: models/User.js, line 12 Extends Model Methods checkDefinition(obj) CHeck if a data object fits to its definition Parameters: Name Type Description obj object Data object Inherited From: Model#checkDefinition Source: models/Model.js, line 210 Returns: Type object clearStorage() Remove all keys and values from AsynStorage. Inherited From: Model#clearStorage Source: models/Model.js, line 289 Returns: Type Promise different(u1, u2) Check if two users are different Parameters: Name Type Description u1 object | string user 1 u2 object | string user 2 Source: models/User.js, line 157 Returns: Type bool fetch(url, req, nocache) Send a request to the API Parameters: Name Type Description url string Url req object Contains the request method, headers and body nocache bool If nothing should be fetched from cache Inherited From: Model#fetch Source: models/Model.js, line 138 Returns: Type Promise get(url, params) Send a HTTP GET request to the API Parameters: Name Type Description url string Url params object Query parameters Inherited From: Model#get Source: models/Model.js, line 94 Returns: Type Promise getAllKeys() Get all the keys in the AsynStorage starting with the prefix of this app defined in the constructor. Inherited From: Model#getAllKeys Source: models/Model.js, line 281 Returns: Type Promise getCurrentUser() Get the current user object Source: models/User.js, line 139 Returns: Type Promise getItem(key, defaultValue, name, time) Get an item from the AsyncStorage Parameters: Name Type Description key string Key defaultValue mixed The default value to return, if nothing is stored under the given key. (Optional) name string A class name (Optional) time bool If the string &quot;_time&quot; is added to the end of the key (Optional) Inherited From: Model#getItem Source: models/Model.js, line 272 Returns: Type Promise getName(key, name) Get the key in the local storage for given key and classname Parameters: Name Type Description key string Key name string A class name (Optional) Inherited From: Model#getName Source: models/Model.js, line 243 Returns: Type Promise getUsers(courseId) Get the users of a course Parameters: Name Type Description courseId string course Id Source: models/User.js, line 117 Returns: Type Promise isLoggedIn() Check if current user is logged in Overrides: Model#isLoggedIn Source: models/User.js, line 101 Returns: Type Promise log(d) Log data to the console Parameters: Name Type Description d mixed data to log Inherited From: Model#log Source: models/Model.js, line 316 Returns: Type mixed login(username, password) Log the user in and trigger the sync with the API Parameters: Name Type Description username string username password string password Source: models/User.js, line 78 Returns: Type Promise logout() Log the current user out Source: models/User.js, line 109 Returns: Type Promise mapToNumericalKeys(obj) Map an object with non numerical keys to an array Parameters: Name Type Description obj object Object representing a list Inherited From: Model#mapToNumericalKeys Source: models/Model.js, line 298 Returns: Type array mayApplyLocalChanges(list, searchPath, setPath, valueCallback) Check if the value of some variables in the local storage have changed Parameters: Name Type Description list object | array Of objects searchPath string Path inside the object E.g.: '{}.{}.name' to get the name of an object inside an object in the list. setPath string The path inside the object from searchPath, that should be changed. E.g. '-' In the current Object, '--' in the parent object. valueCallback function To be executed for every element found in setPath Inherited From: Model#mayApplyLocalChanges Source: models/Model.js, line 356 Returns: Type Promise post(url, body) Send a HTTP POST request to the API Parameters: Name Type Description url string Url body object Request body Inherited From: Model#post Source: models/Model.js, line 122 Returns: Type Promise put(url, body) Send a HTTP PUT request to the API Parameters: Name Type Description url string Url body object Message body Inherited From: Model#put Source: models/Model.js, line 79 Returns: Type Promise removeLocal(key) Remove key and value from local AsyncStorage Parameters: Name Type Description key string Key to remove Inherited From: Model#removeLocal Source: models/Model.js, line 307 Returns: Type Promise save(obj) Save a user object to the API Parameters: Name Type Description obj object A user object that has everything defined in the definition Overrides: Model#save Source: models/User.js, line 33 setApi(num) Set the API version for this model. Parameters: Name Type Description num int 0 or 1 Inherited From: Model#setApi Source: models/Model.js, line 64 Returns: Type Promise setCurrentUser(currentUser) Set the current user in local storage Parameters: Name Type Description currentUser object containing username and password Source: models/User.js, line 148 Returns: Type Promise setItem(key, value, time) Set an item in the AsyncStorage Parameters: Name Type Description key string Key value mixed Value to store for the key time bool If the string &quot;_time&quot; should be added at the end of the key name. This is for storing storing times for certain values. Inherited From: Model#setItem Source: models/Model.js, line 255 Returns: Type Promise setState(key, value) Set the &quot;state&quot; of the model, and store that something has changed. Parameters: Name Type Description key string Key value mixed Value for the key Inherited From: Model#setState Source: models/Model.js, line 335 Returns: Type Promise tryLogin(user, password) Try to log in Parameters: Name Type Description user string username password string password Source: models/User.js, line 50 Returns: Type Promise Ã— Search results Close "},"UserList.html":{"id":"UserList.html","title":"Class: UserList","body":" Lernreflex Namespaces styles~_styles~compstyles~user Modules styles Classes ActivityActivityViewAdminBadgeBadgeListCompetenceCompetenceCreateCompetenceListCompetenceViewCourseInputScrollViewLearningTemplateLernreflexlibListEntryCompetenceLoaderMenuModelQuestionsRouterSelectListSuperComponentUserUserListUserLogin Class: UserList UserList Represents the view for the list of users sharing a competence new UserList() Source: components/UserList.js, line 22 Extends React.Component Methods _onRefresh() Executed on pull to refresh Source: components/UserList.js, line 139 loadData(caching) Load users for course passed by props.competenceData.courseId Parameters: Name Type Default Description caching bool true If users can be loaded from cache Source: components/UserList.js, line 67 render() Render the list view Source: components/UserList.js, line 146 renderRow(rowData) Render a user in the list. Parameters: Name Type Description rowData object user data Source: components/UserList.js, line 125 renderUser() Render user at the top, if different from the current Source: components/UserList.js, line 112 rowPressed(rowData) Executed if a user is selected Parameters: Name Type Description rowData object user data Source: components/UserList.js, line 91 Ã— Search results Close "},"UserLogin.html":{"id":"UserLogin.html","title":"Class: UserLogin","body":" Lernreflex Namespaces styles~_styles~compstyles~user Modules styles Classes ActivityActivityViewAdminBadgeBadgeListCompetenceCompetenceCreateCompetenceListCompetenceViewCourseInputScrollViewLearningTemplateLernreflexlibListEntryCompetenceLoaderMenuModelQuestionsRouterSelectListSuperComponentUserUserListUserLogin Class: UserLogin UserLogin Represents the view for the initial login. The props need to contain a onLogin function which will be called after the login was successfull new UserLogin() Source: components/UserLogin.js, line 32 Extends React.Component Methods _renderLoginButton() Render the login button Source: components/UserLogin.js, line 81 render() Render the login view Source: components/UserLogin.js, line 98 tryLogin() Try to login the user with the given credentials from the input. Source: components/UserLogin.js, line 43 Ã— Search results Close "}}
    </script>

    <script type="text/javascript">
        $(document).ready(function() {
            Searcher.init();
        });

        $(window).on("message", function(msg) {
            var msgData = msg.originalEvent.data;

            if (msgData.msgid != "docstrap.quicksearch.start") {
                return;
            }

            var results = Searcher.search(msgData.searchTerms);

            window.parent.postMessage({"results": results, "msgid": "docstrap.quicksearch.done"}, "*");
        });
    </script>
</body>
</html>
